2025-11-06 18:25:42,008 p=9149 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] ***********************************************
2025-11-06 18:25:42,013 p=9149 u=zubeq n=ansible | TASK [Gathering Facts] **************************************************************************************************
2025-11-06 18:25:45,684 p=9149 u=zubeq n=ansible | [WARNING]: Platform linux on host 18.197.53.137 is using the discovered Python interpreter at /usr/bin/python3.9, but
future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-06 18:25:45,684 p=9149 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:25:45,696 p=9149 u=zubeq n=ansible | TASK [docker : Install Docker engine] ***********************************************************************************
2025-11-06 18:25:48,682 p=9149 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:25:48,689 p=9149 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *************************************************************************
2025-11-06 18:25:50,817 p=9149 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:25:50,823 p=9149 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **************************************************************
2025-11-06 18:25:52,843 p=9149 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:25:52,851 p=9149 u=zubeq n=ansible | TASK [app : Create application directory] *******************************************************************************
2025-11-06 18:25:54,316 p=9149 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:25:54,324 p=9149 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***************************************************************************************
2025-11-06 18:26:01,034 p=9149 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:26:01,041 p=9149 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ********************************************************************************************
2025-11-06 18:26:04,218 p=9149 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:26:04,226 p=9149 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ************************************************************************************
2025-11-06 18:26:06,890 p=9149 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:26:06,898 p=9149 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ********************************************************************************
2025-11-06 18:26:09,391 p=9149 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:26:09,398 p=9149 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *********************************************************************************
2025-11-06 18:26:12,437 p=9149 u=zubeq n=ansible | fatal: [18.197.53.137]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:01.557819'
  end: '2025-11-06 16:26:12.220701'
  msg: non-zero return code
  rc: 1
  start: '2025-11-06 16:26:10.662882'
  stderr: |2-
     Container postgres_db  Running
     Container prometheus  Running
     Container node_exporter  Running
     Container cadvisor_exporter  Running
     Container alertmanager  Starting
     Container web_app  Starting
     Container grafana  Starting
     Container grafana  Started
     Container web_app  Started
    Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting "/home/ec2-user/app/alertmanager.yml" to rootfs at "/etc/alertmanager/alertmanager.yml": create mountpoint for /etc/alertmanager/alertmanager.yml mount: cannot create subdirectories in "/var/lib/docker/overlay2/679495e9cf3780ae36fb85e649e5e82d7b8c3f0d2ec1941f088b4810833f438a/merged/etc/alertmanager/alertmanager.yml": not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-06 18:26:12,438 p=9149 u=zubeq n=ansible | PLAY RECAP **************************************************************************************************************
2025-11-06 18:26:12,444 p=9149 u=zubeq n=ansible | 18.197.53.137              : ok=9    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-06 18:31:02,602 p=9313 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] ***********************************************
2025-11-06 18:31:02,607 p=9313 u=zubeq n=ansible | TASK [Gathering Facts] **************************************************************************************************
2025-11-06 18:31:07,233 p=9313 u=zubeq n=ansible | [WARNING]: Platform linux on host 18.197.53.137 is using the discovered Python interpreter at /usr/bin/python3.9, but
future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-06 18:31:07,233 p=9313 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:31:07,246 p=9313 u=zubeq n=ansible | TASK [docker : Install Docker engine] ***********************************************************************************
2025-11-06 18:31:10,430 p=9313 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:31:10,438 p=9313 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *************************************************************************
2025-11-06 18:31:12,584 p=9313 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:31:12,592 p=9313 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **************************************************************
2025-11-06 18:31:14,604 p=9313 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:31:14,616 p=9313 u=zubeq n=ansible | TASK [app : Create application directory] *******************************************************************************
2025-11-06 18:31:16,125 p=9313 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:31:16,132 p=9313 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***************************************************************************************
2025-11-06 18:31:22,954 p=9313 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:31:22,961 p=9313 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ********************************************************************************************
2025-11-06 18:31:25,365 p=9313 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:31:25,374 p=9313 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ************************************************************************************
2025-11-06 18:31:27,784 p=9313 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:31:27,792 p=9313 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ********************************************************************************
2025-11-06 18:31:31,078 p=9313 u=zubeq n=ansible | changed: [18.197.53.137]
2025-11-06 18:31:31,085 p=9313 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *********************************************************************************
2025-11-06 18:31:34,310 p=9313 u=zubeq n=ansible | changed: [18.197.53.137]
2025-11-06 18:31:34,320 p=9313 u=zubeq n=ansible | TASK [app : Show docker-compose output] *********************************************************************************
2025-11-06 18:31:34,333 p=9313 u=zubeq n=ansible | ok: [18.197.53.137] => 
  compose_result.stdout_lines: []
2025-11-06 18:31:34,338 p=9313 u=zubeq n=ansible | TASK [app : Check running containers (formatted)] ***********************************************************************
2025-11-06 18:31:36,116 p=9313 u=zubeq n=ansible | ok: [18.197.53.137]
2025-11-06 18:31:36,123 p=9313 u=zubeq n=ansible | TASK [app : Show container status] **************************************************************************************
2025-11-06 18:31:36,137 p=9313 u=zubeq n=ansible | ok: [18.197.53.137] => 
  docker_ps.stdout_lines:
  - NAMES               STATUS                           PORTS
  - 'alertmanager        Up 1 second (health: starting)   0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - grafana             Up 5 minutes (healthy)           0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - web_app             Up 5 minutes (unhealthy)         0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_db         Up 15 minutes (healthy)          0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - prometheus          Up 15 minutes (healthy)          0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - node_exporter       Up 15 minutes (healthy)          0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - cadvisor_exporter   Up 15 minutes (healthy)          0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-06 18:31:36,155 p=9313 u=zubeq n=ansible | RUNNING HANDLER [app : Restart compose stack] ***************************************************************************
2025-11-06 18:31:50,937 p=9313 u=zubeq n=ansible | changed: [18.197.53.137]
2025-11-06 18:31:50,949 p=9313 u=zubeq n=ansible | PLAY RECAP **************************************************************************************************************
2025-11-06 18:31:50,949 p=9313 u=zubeq n=ansible | 18.197.53.137              : ok=14   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-11-06 20:23:32,235 p=10947 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] ***********************************************
2025-11-06 20:23:32,240 p=10947 u=zubeq n=ansible | TASK [Gathering Facts] **************************************************************************************************
2025-11-06 20:23:35,668 p=10947 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.176.53.235 is using the discovered Python interpreter at /usr/bin/python3.9, but
future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-06 20:23:35,669 p=10947 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:23:35,680 p=10947 u=zubeq n=ansible | TASK [docker : Install Docker engine] ***********************************************************************************
2025-11-06 20:24:23,632 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:24:23,637 p=10947 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *************************************************************************
2025-11-06 20:24:27,691 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:24:27,697 p=10947 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **************************************************************
2025-11-06 20:24:31,238 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:24:31,246 p=10947 u=zubeq n=ansible | TASK [app : Create application directory] *******************************************************************************
2025-11-06 20:24:32,863 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:24:32,871 p=10947 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***************************************************************************************
2025-11-06 20:24:41,636 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:24:41,639 p=10947 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ********************************************************************************************
2025-11-06 20:24:44,004 p=10947 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:24:44,013 p=10947 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ************************************************************************************
2025-11-06 20:24:46,915 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:24:46,920 p=10947 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ********************************************************************************
2025-11-06 20:24:49,853 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:24:49,857 p=10947 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ******************************************************************************
2025-11-06 20:24:51,224 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:24:51,231 p=10947 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] **********************************************************************************
2025-11-06 20:24:54,113 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:24:54,120 p=10947 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *********************************************************************************
2025-11-06 20:25:29,635 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:25:29,639 p=10947 u=zubeq n=ansible | TASK [app : Show docker-compose output] *********************************************************************************
2025-11-06 20:25:29,656 p=10947 u=zubeq n=ansible | ok: [63.176.53.235] => 
  compose_result.stdout_lines:
  - '#0 building with "default" instance using docker driver'
  - ''
  - '#1 [web internal] load build definition from Dockerfile'
  - '#1 transferring dockerfile: 514B done'
  - '#1 DONE 0.1s'
  - ''
  - '#2 [web internal] load metadata for docker.io/library/python:3.11-slim'
  - '#2 DONE 1.4s'
  - ''
  - '#3 [web internal] load .dockerignore'
  - '#3 transferring context: 2B done'
  - '#3 DONE 0.0s'
  - ''
  - '#4 [web internal] load build context'
  - '#4 transferring context: 6.88kB done'
  - '#4 DONE 0.0s'
  - ''
  - '#5 [web 1/5] FROM docker.io/library/python:3.11-slim@sha256:fa9b525a0be0c5ae5e6f2209f4be6fdc5a15a36fed0222144d98ac0d08f876d4'
  - '#5 resolve docker.io/library/python:3.11-slim@sha256:fa9b525a0be0c5ae5e6f2209f4be6fdc5a15a36fed0222144d98ac0d08f876d4 0.0s done'
  - '#5 sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0B / 1.29MB 0.1s'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 0B / 14.36MB 0.1s'
  - '#5 sha256:fa9b525a0be0c5ae5e6f2209f4be6fdc5a15a36fed0222144d98ac0d08f876d4 10.37kB / 10.37kB done'
  - '#5 sha256:b596083aa14d47c78a652138aa9b98607585499d7c7ec343ae378f6c5770822d 1.75kB / 1.75kB done'
  - '#5 sha256:870925f757415a696459255b0a20b082e914cac42efaff4424b59e21bff80d5b 5.48kB / 5.48kB done'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 0B / 29.78MB 0.1s'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 4.19MB / 14.36MB 0.3s'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 12.58MB / 14.36MB 0.4s'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 4.19MB / 29.78MB 0.4s'
  - '#5 sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 1.29MB / 1.29MB 0.5s done'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 14.36MB / 14.36MB 0.5s done'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 20.97MB / 29.78MB 0.6s'
  - '#5 sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc 0B / 248B 0.6s'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 28.31MB / 29.78MB 0.7s'
  - '#5 extracting sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 29.78MB / 29.78MB 0.7s done'
  - '#5 sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc 248B / 248B 0.8s done'
  - '#5 extracting sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 1.7s done'
  - '#5 extracting sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0.1s'
  - '#5 extracting sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0.1s done'
  - '#5 extracting sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 0.1s'
  - '#5 extracting sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 1.1s done'
  - '#5 extracting sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc'
  - '#5 extracting sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc done'
  - '#5 DONE 3.9s'
  - ''
  - '#6 [web 2/5] WORKDIR /app'
  - '#6 DONE 0.1s'
  - ''
  - '#7 [web 3/5] COPY requirements.txt .'
  - '#7 DONE 0.0s'
  - ''
  - '#8 [web 4/5] RUN pip install --no-cache-dir -r requirements.txt'
  - '#8 2.313 Collecting Flask (from -r requirements.txt (line 1))'
  - '#8 2.340   Downloading flask-3.1.2-py3-none-any.whl.metadata (3.2 kB)'
  - '#8 2.440 Collecting psycopg2-binary (from -r requirements.txt (line 2))'
  - '#8 2.445   Downloading psycopg2_binary-2.9.11-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (4.9 kB)'
  - '#8 2.568 Collecting prometheus_flask_exporter (from -r requirements.txt (line 3))'
  - '#8 2.573   Downloading prometheus_flask_exporter-0.23.2-py3-none-any.whl.metadata (20 kB)'
  - '#8 2.602 Collecting blinker>=1.9.0 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.606   Downloading blinker-1.9.0-py3-none-any.whl.metadata (1.6 kB)'
  - '#8 2.634 Collecting click>=8.1.3 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.637   Downloading click-8.3.0-py3-none-any.whl.metadata (2.6 kB)'
  - '#8 2.666 Collecting itsdangerous>=2.2.0 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.669   Downloading itsdangerous-2.2.0-py3-none-any.whl.metadata (1.9 kB)'
  - '#8 2.693 Collecting jinja2>=3.1.2 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.701   Downloading jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)'
  - '#8 2.777 Collecting markupsafe>=2.1.1 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.781   Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (2.7 kB)'
  - '#8 2.814 Collecting werkzeug>=3.1.0 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.819   Downloading werkzeug-3.1.3-py3-none-any.whl.metadata (3.7 kB)'
  - '#8 2.844 Collecting prometheus_client (from prometheus_flask_exporter->-r requirements.txt (line 3))'
  - '#8 2.848   Downloading prometheus_client-0.23.1-py3-none-any.whl.metadata (1.9 kB)'
  - '#8 2.867 Downloading flask-3.1.2-py3-none-any.whl (103 kB)'
  - '#8 2.871    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 103.3/103.3 kB 107.5 MB/s eta 0:00:00'
  - '#8 2.875 Downloading psycopg2_binary-2.9.11-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (4.2 MB)'
  - '#8 2.910    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.2/4.2 MB 130.1 MB/s eta 0:00:00'
  - '#8 2.915 Downloading prometheus_flask_exporter-0.23.2-py3-none-any.whl (19 kB)'
  - '#8 2.919 Downloading blinker-1.9.0-py3-none-any.whl (8.5 kB)'
  - '#8 2.922 Downloading click-8.3.0-py3-none-any.whl (107 kB)'
  - '#8 2.925    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 107.3/107.3 kB 309.7 MB/s eta 0:00:00'
  - '#8 2.930 Downloading itsdangerous-2.2.0-py3-none-any.whl (16 kB)'
  - '#8 2.933 Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)'
  - '#8 2.936    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 134.9/134.9 kB 344.0 MB/s eta 0:00:00'
  - '#8 2.940 Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (22 kB)'
  - '#8 2.945 Downloading werkzeug-3.1.3-py3-none-any.whl (224 kB)'
  - '#8 2.948    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 224.5/224.5 kB 348.9 MB/s eta 0:00:00'
  - '#8 2.952 Downloading prometheus_client-0.23.1-py3-none-any.whl (61 kB)'
  - '#8 2.955    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.1/61.1 kB 294.5 MB/s eta 0:00:00'
  - '#8 3.037 Installing collected packages: psycopg2-binary, prometheus_client, markupsafe, itsdangerous, click, blinker, werkzeug, jinja2, Flask, prometheus_flask_exporter'
  - '#8 3.697 Successfully installed Flask-3.1.2 blinker-1.9.0 click-8.3.0 itsdangerous-2.2.0 jinja2-3.1.6 markupsafe-3.0.3 prometheus_client-0.23.1 prometheus_flask_exporter-0.23.2 psycopg2-binary-2.9.11 werkzeug-3.1.3'
  - '#8 3.698 WARNING: Running pip as the ''root'' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv'
  - '#8 3.774 '
  - '#8 3.774 [notice] A new release of pip is available: 24.0 -> 25.3'
  - '#8 3.774 [notice] To update, run: pip install --upgrade pip'
  - '#8 DONE 4.0s'
  - ''
  - '#9 [web 5/5] COPY . /app'
  - '#9 DONE 0.1s'
  - ''
  - '#10 [web] exporting to image'
  - '#10 exporting layers'
  - '#10 exporting layers 0.3s done'
  - '#10 writing image sha256:09e9d5e95f316ffbf0d1943c8e7978952e176fad65869830e70026e3b35cede3 done'
  - '#10 naming to docker.io/library/myflaskapp:1.0.0 done'
  - '#10 DONE 0.4s'
2025-11-06 20:25:29,659 p=10947 u=zubeq n=ansible | TASK [app : Check running containers (formatted)] ***********************************************************************
2025-11-06 20:25:32,104 p=10947 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:25:32,109 p=10947 u=zubeq n=ansible | TASK [app : Show container status] **************************************************************************************
2025-11-06 20:25:32,123 p=10947 u=zubeq n=ansible | ok: [63.176.53.235] => 
  docker_ps.stdout_lines:
  - NAMES               STATUS                                  PORTS
  - 'grafana             Up 2 seconds (health: starting)         0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'web_app             Up 2 seconds (health: starting)         0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'cadvisor_exporter   Up 3 seconds (health: starting)         0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
  - 'prometheus          Restarting (2) Less than a second ago   '
  - 'node_exporter       Up 3 seconds (health: starting)         0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
  - 'postgres_db         Up 3 seconds (health: starting)         0.0.0.0:5432->5432/tcp, :::5432->5432/tcp'
  - 'alertmanager        Up 3 seconds (health: starting)         0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
2025-11-06 20:25:32,127 p=10947 u=zubeq n=ansible | TASK [app : Create alerts directory] ************************************************************************************
2025-11-06 20:25:33,913 p=10947 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:25:33,919 p=10947 u=zubeq n=ansible | TASK [app : Copy alert rules] *******************************************************************************************
2025-11-06 20:25:34,353 p=10947 u=zubeq n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was:           description: "95th percentile response time is above 2 seconds.". unexpected char '$' at 290
2025-11-06 20:25:34,354 p=10947 u=zubeq n=ansible | fatal: [63.176.53.235]: FAILED! => changed=false 
  msg: |-
    AnsibleError: template error while templating string: unexpected char '$' at 290. String: # roles/app/templates/alert_rules.yml.j2
    groups:
      - name: basic_alerts
        interval: 30s
        rules:
          # Контейнер упал
          - alert: ContainerDown
            expr: up == 0
            for: 1m
            labels:
              severity: critical
            annotations:
              summary: "Container {{ $labels.job }} is down"
              description: "Container {{ $labels.job }} has been down for more than 1 minute."
  
          # Высокая загрузка CPU
          - alert: HighCPUUsage
            expr: 100 - (avg by (instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "High CPU usage on {{ $labels.instance }}"
              description: "CPU usage is above 80% for more than 5 minutes."
  
          # Мало памяти
          - alert: HighMemoryUsage
            expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100 > 85
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "High memory usage on {{ $labels.instance }}"
              description: "Memory usage is above 85%."
  
          # PostgreSQL недоступен
          - alert: PostgresDown
            expr: up{job="postgres"} == 0
            for: 1m
            labels:
              severity: critical
            annotations:
              summary: "PostgreSQL is down"
              description: "PostgreSQL database has been down for more than 1 minute."
  
          # Flask app медленно отвечает
          - alert: SlowFlaskResponse
            expr: histogram_quantile(0.95, rate(flask_http_request_duration_seconds_bucket[5m])) > 2
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Flask app is slow"
              description: "95th percentile response time is above 2 seconds.". unexpected char '$' at 290
2025-11-06 20:25:34,355 p=10947 u=zubeq n=ansible | PLAY RECAP **************************************************************************************************************
2025-11-06 20:25:34,355 p=10947 u=zubeq n=ansible | 63.176.53.235              : ok=16   changed=11   unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-06 20:28:16,346 p=11170 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] ***********************************************
2025-11-06 20:28:16,352 p=11170 u=zubeq n=ansible | TASK [Gathering Facts] **************************************************************************************************
2025-11-06 20:28:20,218 p=11170 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.176.53.235 is using the discovered Python interpreter at /usr/bin/python3.9, but
future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-06 20:28:20,218 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:20,231 p=11170 u=zubeq n=ansible | TASK [docker : Install Docker engine] ***********************************************************************************
2025-11-06 20:28:23,567 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:23,573 p=11170 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *************************************************************************
2025-11-06 20:28:25,735 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:25,741 p=11170 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **************************************************************
2025-11-06 20:28:27,786 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:27,798 p=11170 u=zubeq n=ansible | TASK [app : Create application directory] *******************************************************************************
2025-11-06 20:28:29,440 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:29,447 p=11170 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***************************************************************************************
2025-11-06 20:28:36,081 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:36,088 p=11170 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ********************************************************************************************
2025-11-06 20:28:38,609 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:38,617 p=11170 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ************************************************************************************
2025-11-06 20:28:41,004 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:41,011 p=11170 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ********************************************************************************
2025-11-06 20:28:43,623 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:43,630 p=11170 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ******************************************************************************
2025-11-06 20:28:45,010 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:45,021 p=11170 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] **********************************************************************************
2025-11-06 20:28:47,478 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:47,487 p=11170 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *********************************************************************************
2025-11-06 20:28:49,748 p=11170 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:28:49,756 p=11170 u=zubeq n=ansible | TASK [app : Show docker-compose output] *********************************************************************************
2025-11-06 20:28:49,771 p=11170 u=zubeq n=ansible | ok: [63.176.53.235] => 
  compose_result.stdout_lines: []
2025-11-06 20:28:49,776 p=11170 u=zubeq n=ansible | TASK [app : Check running containers (formatted)] ***********************************************************************
2025-11-06 20:28:51,540 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:51,547 p=11170 u=zubeq n=ansible | TASK [app : Show container status] **************************************************************************************
2025-11-06 20:28:51,560 p=11170 u=zubeq n=ansible | ok: [63.176.53.235] => 
  docker_ps.stdout_lines:
  - NAMES               STATUS                          PORTS
  - grafana             Up 3 minutes (healthy)          0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - web_app             Up 3 minutes (healthy)          0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - cadvisor_exporter   Up 3 minutes (healthy)          0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
  - 'prometheus          Restarting (2) 28 seconds ago   '
  - node_exporter       Up 3 minutes (healthy)          0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - postgres_db         Up 3 minutes (healthy)          0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - alertmanager        Up 3 minutes (healthy)          0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
2025-11-06 20:28:51,568 p=11170 u=zubeq n=ansible | TASK [app : Create alerts directory] ************************************************************************************
2025-11-06 20:28:53,000 p=11170 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:28:53,007 p=11170 u=zubeq n=ansible | TASK [app : Copy alert rules] *******************************************************************************************
2025-11-06 20:28:56,020 p=11170 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:28:56,038 p=11170 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] ********************************************************************
2025-11-06 20:28:59,148 p=11170 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:28:59,158 p=11170 u=zubeq n=ansible | PLAY RECAP **************************************************************************************************************
2025-11-06 20:28:59,158 p=11170 u=zubeq n=ansible | 63.176.53.235              : ok=18   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-11-06 20:43:13,242 p=11583 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] ***********************************************
2025-11-06 20:43:13,247 p=11583 u=zubeq n=ansible | TASK [Gathering Facts] **************************************************************************************************
2025-11-06 20:43:16,955 p=11583 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.176.53.235 is using the discovered Python interpreter at /usr/bin/python3.9, but
future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-06 20:43:16,955 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:16,965 p=11583 u=zubeq n=ansible | TASK [docker : Install Docker engine] ***********************************************************************************
2025-11-06 20:43:19,928 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:19,933 p=11583 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *************************************************************************
2025-11-06 20:43:21,906 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:21,912 p=11583 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **************************************************************
2025-11-06 20:43:23,758 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:23,767 p=11583 u=zubeq n=ansible | TASK [app : Create application directory] *******************************************************************************
2025-11-06 20:43:25,234 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:25,241 p=11583 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***************************************************************************************
2025-11-06 20:43:31,940 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:31,947 p=11583 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ********************************************************************************************
2025-11-06 20:43:34,417 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:34,423 p=11583 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ************************************************************************************
2025-11-06 20:43:37,552 p=11583 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:43:37,559 p=11583 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ********************************************************************************
2025-11-06 20:43:40,153 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:40,160 p=11583 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ******************************************************************************
2025-11-06 20:43:41,497 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:41,504 p=11583 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] **********************************************************************************
2025-11-06 20:43:43,982 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:43,989 p=11583 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *********************************************************************************
2025-11-06 20:43:48,183 p=11583 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:43:48,189 p=11583 u=zubeq n=ansible | TASK [app : Show docker-compose output] *********************************************************************************
2025-11-06 20:43:48,203 p=11583 u=zubeq n=ansible | ok: [63.176.53.235] => 
  compose_result.stdout_lines: []
2025-11-06 20:43:48,207 p=11583 u=zubeq n=ansible | TASK [app : Check running containers (formatted)] ***********************************************************************
2025-11-06 20:43:50,214 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:50,221 p=11583 u=zubeq n=ansible | TASK [app : Show container status] **************************************************************************************
2025-11-06 20:43:50,235 p=11583 u=zubeq n=ansible | ok: [63.176.53.235] => 
  docker_ps.stdout_lines:
  - NAMES               STATUS                            PORTS
  - 'web_app             Up 2 seconds (health: starting)   0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'grafana             Up 1 second (health: starting)    0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'cadvisor_exporter   Up 3 seconds (health: starting)   0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
  - 'prometheus          Up 2 seconds (health: starting)   0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - 'alertmanager        Up 2 seconds (health: starting)   0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - 'node_exporter       Up 2 seconds (health: starting)   0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
  - 'postgres_db         Up 3 seconds (health: starting)   0.0.0.0:5432->5432/tcp, :::5432->5432/tcp'
2025-11-06 20:43:50,239 p=11583 u=zubeq n=ansible | TASK [app : Create alerts directory] ************************************************************************************
2025-11-06 20:43:51,808 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:51,813 p=11583 u=zubeq n=ansible | TASK [app : Copy alert rules] *******************************************************************************************
2025-11-06 20:43:54,607 p=11583 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 20:43:54,619 p=11583 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] ********************************************************************
2025-11-06 20:43:58,377 p=11583 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 20:43:58,383 p=11583 u=zubeq n=ansible | PLAY RECAP **************************************************************************************************************
2025-11-06 20:43:58,383 p=11583 u=zubeq n=ansible | 63.176.53.235              : ok=18   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-11-06 21:10:00,225 p=12311 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] ***********************************************
2025-11-06 21:10:00,231 p=12311 u=zubeq n=ansible | TASK [Gathering Facts] **************************************************************************************************
2025-11-06 21:10:04,496 p=12311 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.176.53.235 is using the discovered Python interpreter at /usr/bin/python3.9, but
future installation of another Python interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-06 21:10:04,496 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:04,507 p=12311 u=zubeq n=ansible | TASK [docker : Install Docker engine] ***********************************************************************************
2025-11-06 21:10:07,454 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:07,460 p=12311 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *************************************************************************
2025-11-06 21:10:09,426 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:09,432 p=12311 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **************************************************************
2025-11-06 21:10:11,213 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:11,222 p=12311 u=zubeq n=ansible | TASK [app : Create application directory] *******************************************************************************
2025-11-06 21:10:12,738 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:12,745 p=12311 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***************************************************************************************
2025-11-06 21:10:19,060 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:19,067 p=12311 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ********************************************************************************************
2025-11-06 21:10:21,415 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:21,421 p=12311 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ************************************************************************************
2025-11-06 21:10:23,712 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:23,719 p=12311 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ********************************************************************************
2025-11-06 21:10:25,986 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:25,993 p=12311 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ******************************************************************************
2025-11-06 21:10:27,467 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:27,474 p=12311 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] **********************************************************************************
2025-11-06 21:10:29,734 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:29,741 p=12311 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *********************************************************************************
2025-11-06 21:10:34,104 p=12311 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 21:10:34,108 p=12311 u=zubeq n=ansible | TASK [app : Show docker-compose output] *********************************************************************************
2025-11-06 21:10:34,123 p=12311 u=zubeq n=ansible | ok: [63.176.53.235] => 
  compose_result.stdout_lines: []
2025-11-06 21:10:34,126 p=12311 u=zubeq n=ansible | TASK [app : Check running containers (formatted)] ***********************************************************************
2025-11-06 21:10:36,042 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:36,047 p=12311 u=zubeq n=ansible | TASK [app : Show container status] **************************************************************************************
2025-11-06 21:10:36,061 p=12311 u=zubeq n=ansible | ok: [63.176.53.235] => 
  docker_ps.stdout_lines:
  - NAMES               STATUS                            PORTS
  - 'grafana             Up 1 second (health: starting)    0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'web_app             Up 2 seconds (health: starting)   0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'postgres_db         Up 2 seconds (health: starting)   0.0.0.0:5432->5432/tcp, :::5432->5432/tcp'
  - 'cadvisor_exporter   Up 2 seconds (health: starting)   0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
  - 'prometheus          Up 2 seconds (health: starting)   0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - 'alertmanager        Up 3 seconds (health: starting)   0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - 'node_exporter       Up 3 seconds (health: starting)   0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
2025-11-06 21:10:36,065 p=12311 u=zubeq n=ansible | TASK [app : Create alerts directory] ************************************************************************************
2025-11-06 21:10:37,586 p=12311 u=zubeq n=ansible | ok: [63.176.53.235]
2025-11-06 21:10:37,592 p=12311 u=zubeq n=ansible | TASK [app : Copy alert rules] *******************************************************************************************
2025-11-06 21:10:40,841 p=12311 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 21:10:40,857 p=12311 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] ********************************************************************
2025-11-06 21:10:44,533 p=12311 u=zubeq n=ansible | changed: [63.176.53.235]
2025-11-06 21:10:44,542 p=12311 u=zubeq n=ansible | PLAY RECAP **************************************************************************************************************
2025-11-06 21:10:44,542 p=12311 u=zubeq n=ansible | 63.176.53.235              : ok=18   changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-11-08 20:11:32,089 p=4931 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-08 20:11:32,097 p=4931 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-08 20:11:36,497 p=4931 u=zubeq n=ansible | [WARNING]: Platform linux on host 35.156.162.104 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-08 20:11:36,497 p=4931 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:11:36,508 p=4931 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-08 20:12:23,989 p=4931 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:12:23,993 p=4931 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-08 20:12:27,874 p=4931 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:12:27,880 p=4931 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-08 20:12:31,371 p=4931 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:12:31,383 p=4931 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-08 20:12:33,044 p=4931 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:12:33,056 p=4931 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-08 20:12:43,612 p=4931 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:12:43,619 p=4931 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-08 20:12:46,758 p=4931 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:12:46,769 p=4931 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-08 20:12:50,198 p=4931 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:12:50,206 p=4931 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-08 20:12:53,351 p=4931 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:12:53,356 p=4931 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-08 20:12:54,944 p=4931 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:12:54,950 p=4931 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-08 20:12:59,111 p=4931 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:12:59,121 p=4931 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-08 20:13:01,063 p=4931 u=zubeq n=ansible | fatal: [35.156.162.104]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.040413'
  end: '2025-11-08 18:13:00.883244'
  msg: non-zero return code
  rc: 15
  start: '2025-11-08 18:13:00.842831'
  stderr: 'validating /home/ec2-user/app/docker-compose.yml: services.postgres_exporter.depends_on.0 must be a string'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-08 20:13:01,064 p=4931 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-08 20:13:01,064 p=4931 u=zubeq n=ansible | 35.156.162.104             : ok=11   changed=9    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-08 20:16:48,174 p=5171 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-08 20:16:48,179 p=5171 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-08 20:16:51,611 p=5171 u=zubeq n=ansible | [WARNING]: Platform linux on host 35.156.162.104 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-08 20:16:51,611 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:16:51,621 p=5171 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-08 20:16:54,542 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:16:54,548 p=5171 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-08 20:16:56,587 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:16:56,592 p=5171 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-08 20:16:58,448 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:16:58,454 p=5171 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-08 20:16:59,983 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:16:59,989 p=5171 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-08 20:17:07,506 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:17:07,512 p=5171 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-08 20:17:10,111 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:17:10,121 p=5171 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-08 20:17:12,813 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:17:12,820 p=5171 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-08 20:17:16,502 p=5171 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:17:16,507 p=5171 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-08 20:17:18,279 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:17:18,284 p=5171 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-08 20:17:21,414 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:17:21,419 p=5171 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-08 20:17:52,522 p=5171 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:17:52,528 p=5171 u=zubeq n=ansible | TASK [app : Show docker-compose output] *******************************************************
2025-11-08 20:17:52,544 p=5171 u=zubeq n=ansible | ok: [35.156.162.104] => 
  compose_result.stdout_lines:
  - '#0 building with "default" instance using docker driver'
  - ''
  - '#1 [web internal] load build definition from Dockerfile'
  - '#1 transferring dockerfile: 514B done'
  - '#1 DONE 0.0s'
  - ''
  - '#2 [web internal] load metadata for docker.io/library/python:3.11-slim'
  - '#2 DONE 1.4s'
  - ''
  - '#3 [web internal] load .dockerignore'
  - '#3 transferring context: 2B done'
  - '#3 DONE 0.0s'
  - ''
  - '#4 [web internal] load build context'
  - '#4 transferring context: 7.57kB done'
  - '#4 DONE 0.0s'
  - ''
  - '#5 [web 1/5] FROM docker.io/library/python:3.11-slim@sha256:e4676722fba839e2e5cdb844a52262b43e90e56dbd55b7ad953ee3615ad7534f'
  - '#5 resolve docker.io/library/python:3.11-slim@sha256:e4676722fba839e2e5cdb844a52262b43e90e56dbd55b7ad953ee3615ad7534f 0.0s done'
  - '#5 sha256:e4676722fba839e2e5cdb844a52262b43e90e56dbd55b7ad953ee3615ad7534f 10.37kB / 10.37kB done'
  - '#5 sha256:b596083aa14d47c78a652138aa9b98607585499d7c7ec343ae378f6c5770822d 1.75kB / 1.75kB done'
  - '#5 sha256:870925f757415a696459255b0a20b082e914cac42efaff4424b59e21bff80d5b 5.48kB / 5.48kB done'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 0B / 29.78MB 0.1s'
  - '#5 sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0B / 1.29MB 0.1s'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 0B / 14.36MB 0.1s'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 12.58MB / 29.78MB 0.4s'
  - '#5 sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 1.29MB / 1.29MB 0.4s'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 29.36MB / 29.78MB 0.6s'
  - '#5 sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 1.29MB / 1.29MB 0.4s done'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 7.34MB / 14.36MB 0.6s'
  - '#5 sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc 0B / 248B 0.6s'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 29.78MB / 29.78MB 0.6s done'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 11.53MB / 14.36MB 0.7s'
  - '#5 sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc 248B / 248B 0.6s done'
  - '#5 extracting sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 0.1s'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 13.63MB / 14.36MB 0.8s'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 14.36MB / 14.36MB 0.8s done'
  - '#5 extracting sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 1.4s done'
  - '#5 extracting sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0.1s'
  - '#5 extracting sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0.1s done'
  - '#5 extracting sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 0.1s'
  - '#5 extracting sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 1.0s done'
  - '#5 extracting sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc'
  - '#5 extracting sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc done'
  - '#5 DONE 3.5s'
  - ''
  - '#6 [web 2/5] WORKDIR /app'
  - '#6 DONE 0.1s'
  - ''
  - '#7 [web 3/5] COPY requirements.txt .'
  - '#7 DONE 0.0s'
  - ''
  - '#8 [web 4/5] RUN pip install --no-cache-dir -r requirements.txt'
  - '#8 2.340 Collecting Flask (from -r requirements.txt (line 1))'
  - '#8 2.360   Downloading flask-3.1.2-py3-none-any.whl.metadata (3.2 kB)'
  - '#8 2.441 Collecting psycopg2-binary (from -r requirements.txt (line 2))'
  - '#8 2.450   Downloading psycopg2_binary-2.9.11-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (4.9 kB)'
  - '#8 2.473 Collecting prometheus_flask_exporter (from -r requirements.txt (line 3))'
  - '#8 2.478   Downloading prometheus_flask_exporter-0.23.2-py3-none-any.whl.metadata (20 kB)'
  - '#8 2.504 Collecting blinker>=1.9.0 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.508   Downloading blinker-1.9.0-py3-none-any.whl.metadata (1.6 kB)'
  - '#8 2.542 Collecting click>=8.1.3 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.545   Downloading click-8.3.0-py3-none-any.whl.metadata (2.6 kB)'
  - '#8 2.562 Collecting itsdangerous>=2.2.0 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.567   Downloading itsdangerous-2.2.0-py3-none-any.whl.metadata (1.9 kB)'
  - '#8 2.591 Collecting jinja2>=3.1.2 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.597   Downloading jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)'
  - '#8 2.664 Collecting markupsafe>=2.1.1 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.667   Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (2.7 kB)'
  - '#8 2.703 Collecting werkzeug>=3.1.0 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.706   Downloading werkzeug-3.1.3-py3-none-any.whl.metadata (3.7 kB)'
  - '#8 2.736 Collecting prometheus_client (from prometheus_flask_exporter->-r requirements.txt (line 3))'
  - '#8 2.740   Downloading prometheus_client-0.23.1-py3-none-any.whl.metadata (1.9 kB)'
  - '#8 2.761 Downloading flask-3.1.2-py3-none-any.whl (103 kB)'
  - '#8 2.765    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 103.3/103.3 kB 236.4 MB/s eta 0:00:00'
  - '#8 2.770 Downloading psycopg2_binary-2.9.11-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (4.2 MB)'
  - '#8 2.798    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.2/4.2 MB 169.2 MB/s eta 0:00:00'
  - '#8 2.804 Downloading prometheus_flask_exporter-0.23.2-py3-none-any.whl (19 kB)'
  - '#8 2.808 Downloading blinker-1.9.0-py3-none-any.whl (8.5 kB)'
  - '#8 2.812 Downloading click-8.3.0-py3-none-any.whl (107 kB)'
  - '#8 2.815    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 107.3/107.3 kB 201.0 MB/s eta 0:00:00'
  - '#8 2.819 Downloading itsdangerous-2.2.0-py3-none-any.whl (16 kB)'
  - '#8 2.823 Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)'
  - '#8 2.826    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 134.9/134.9 kB 304.6 MB/s eta 0:00:00'
  - '#8 2.830 Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (22 kB)'
  - '#8 2.833 Downloading werkzeug-3.1.3-py3-none-any.whl (224 kB)'
  - '#8 2.836    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 224.5/224.5 kB 331.0 MB/s eta 0:00:00'
  - '#8 2.840 Downloading prometheus_client-0.23.1-py3-none-any.whl (61 kB)'
  - '#8 2.842    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.1/61.1 kB 285.1 MB/s eta 0:00:00'
  - '#8 2.924 Installing collected packages: psycopg2-binary, prometheus_client, markupsafe, itsdangerous, click, blinker, werkzeug, jinja2, Flask, prometheus_flask_exporter'
  - '#8 3.553 Successfully installed Flask-3.1.2 blinker-1.9.0 click-8.3.0 itsdangerous-2.2.0 jinja2-3.1.6 markupsafe-3.0.3 prometheus_client-0.23.1 prometheus_flask_exporter-0.23.2 psycopg2-binary-2.9.11 werkzeug-3.1.3'
  - '#8 3.554 WARNING: Running pip as the ''root'' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv'
  - '#8 3.632 '
  - '#8 3.632 [notice] A new release of pip is available: 24.0 -> 25.3'
  - '#8 3.632 [notice] To update, run: pip install --upgrade pip'
  - '#8 DONE 3.9s'
  - ''
  - '#9 [web 5/5] COPY . /app'
  - '#9 DONE 0.0s'
  - ''
  - '#10 [web] exporting to image'
  - '#10 exporting layers'
  - '#10 exporting layers 0.3s done'
  - '#10 writing image sha256:faac48bbb03f46d56d8ea60e5873db0898ba23296c8fb69c273f67b8b3c5897c done'
  - '#10 naming to docker.io/library/myflaskapp:1.0.0 done'
  - '#10 DONE 0.3s'
2025-11-08 20:17:52,547 p=5171 u=zubeq n=ansible | TASK [app : Check running containers (formatted)] *********************************************
2025-11-08 20:17:54,879 p=5171 u=zubeq n=ansible | ok: [35.156.162.104]
2025-11-08 20:17:54,884 p=5171 u=zubeq n=ansible | TASK [app : Show container status] ************************************************************
2025-11-08 20:17:54,899 p=5171 u=zubeq n=ansible | ok: [35.156.162.104] => 
  docker_ps.stdout_lines:
  - NAMES               STATUS                            PORTS
  - 'postgres_exporter   Up 2 seconds (health: starting)   0.0.0.0:9187->9187/tcp, :::9187->9187/tcp'
  - 'grafana             Up 2 seconds (health: starting)   0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'web_app             Up 2 seconds (health: starting)   0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'alertmanager        Up 3 seconds (health: starting)   0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - 'postgres_db         Up 3 seconds (health: starting)   0.0.0.0:5432->5432/tcp, :::5432->5432/tcp'
  - 'node_exporter       Up 3 seconds (health: starting)   0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
  - 'prometheus          Up 3 seconds (health: starting)   0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - 'cadvisor_exporter   Up 3 seconds (health: starting)   0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
2025-11-08 20:17:54,902 p=5171 u=zubeq n=ansible | TASK [app : Create alerts directory] **********************************************************
2025-11-08 20:17:56,807 p=5171 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:17:56,812 p=5171 u=zubeq n=ansible | TASK [app : Copy alert rules] *****************************************************************
2025-11-08 20:18:00,240 p=5171 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:18:00,257 p=5171 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] ******************************************
2025-11-08 20:18:05,000 p=5171 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:18:05,006 p=5171 u=zubeq n=ansible | RUNNING HANDLER [app : Restart compose stack] *************************************************
2025-11-08 20:18:19,183 p=5171 u=zubeq n=ansible | changed: [35.156.162.104]
2025-11-08 20:18:19,192 p=5171 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-08 20:18:19,192 p=5171 u=zubeq n=ansible | 35.156.162.104             : ok=19   changed=6    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-11-10 18:56:47,216 p=6798 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 18:56:47,226 p=6798 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 18:56:52,535 p=6798 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.177.234.8 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 18:56:52,535 p=6798 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 18:56:52,544 p=6798 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 18:57:40,473 p=6798 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 18:57:40,479 p=6798 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 18:57:44,917 p=6798 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 18:57:44,923 p=6798 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 18:57:48,564 p=6798 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 18:57:48,574 p=6798 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 18:57:50,333 p=6798 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 18:57:50,342 p=6798 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 18:58:03,133 p=6798 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 18:58:03,138 p=6798 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 18:58:06,324 p=6798 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 18:58:06,333 p=6798 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 18:58:10,167 p=6798 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 18:58:10,176 p=6798 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 18:58:13,450 p=6798 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 18:58:13,454 p=6798 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 18:58:15,432 p=6798 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 18:58:15,439 p=6798 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 18:58:20,127 p=6798 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 18:58:20,136 p=6798 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 18:58:22,246 p=6798 u=zubeq n=ansible | fatal: [63.177.234.8]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.041202'
  end: '2025-11-10 16:58:21.767487'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 16:58:21.726285'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 18:58:22,247 p=6798 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 18:58:22,247 p=6798 u=zubeq n=ansible | 63.177.234.8               : ok=11   changed=9    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 19:04:50,078 p=7126 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 19:04:50,084 p=7126 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 19:04:54,271 p=7126 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.177.234.8 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 19:04:54,271 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:04:54,281 p=7126 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 19:04:56,799 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:04:56,805 p=7126 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 19:04:59,458 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:04:59,464 p=7126 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 19:05:01,968 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:05:01,976 p=7126 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 19:05:03,759 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:05:03,765 p=7126 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 19:05:12,045 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:05:12,051 p=7126 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 19:05:15,055 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:05:15,063 p=7126 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 19:05:18,063 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:05:18,068 p=7126 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 19:05:21,375 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:05:21,380 p=7126 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 19:05:23,238 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:05:23,244 p=7126 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 19:05:26,244 p=7126 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:05:26,251 p=7126 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 19:05:28,127 p=7126 u=zubeq n=ansible | fatal: [63.177.234.8]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.033097'
  end: '2025-11-10 17:05:27.897661'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 17:05:27.864564'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 19:05:28,128 p=7126 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 19:05:28,128 p=7126 u=zubeq n=ansible | 63.177.234.8               : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 19:06:28,364 p=7285 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 19:06:28,370 p=7285 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 19:06:32,948 p=7285 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.177.234.8 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 19:06:32,948 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:06:32,958 p=7285 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 19:06:35,711 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:06:35,716 p=7285 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 19:06:38,331 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:06:38,337 p=7285 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 19:06:40,427 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:06:40,436 p=7285 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 19:06:42,175 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:06:42,181 p=7285 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 19:06:53,492 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:06:53,498 p=7285 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 19:07:03,485 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:07:03,493 p=7285 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 19:07:17,068 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:07:17,075 p=7285 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 19:07:23,605 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:07:23,611 p=7285 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 19:07:25,209 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:07:25,216 p=7285 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 19:07:29,155 p=7285 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:07:29,163 p=7285 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 19:07:31,213 p=7285 u=zubeq n=ansible | fatal: [63.177.234.8]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.032212'
  end: '2025-11-10 17:07:30.909033'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 17:07:30.876821'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 19:07:31,213 p=7285 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 19:07:31,213 p=7285 u=zubeq n=ansible | 63.177.234.8               : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 19:15:05,909 p=7556 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 19:15:05,914 p=7556 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 19:15:10,688 p=7556 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.177.234.8 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 19:15:10,689 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:10,698 p=7556 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 19:15:13,169 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:13,175 p=7556 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 19:15:15,377 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:15,382 p=7556 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 19:15:17,542 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:17,551 p=7556 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 19:15:19,145 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:19,152 p=7556 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 19:15:26,838 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:26,844 p=7556 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 19:15:29,508 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:29,516 p=7556 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 19:15:32,597 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:32,604 p=7556 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 19:15:35,379 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:35,386 p=7556 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 19:15:36,925 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:36,931 p=7556 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 19:15:39,606 p=7556 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:15:39,612 p=7556 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 19:15:41,164 p=7556 u=zubeq n=ansible | fatal: [63.177.234.8]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.031765'
  end: '2025-11-10 17:15:40.931386'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 17:15:40.899621'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 19:15:41,165 p=7556 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 19:15:41,165 p=7556 u=zubeq n=ansible | 63.177.234.8               : ok=11   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 19:17:23,082 p=7757 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 19:17:23,088 p=7757 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 19:17:26,408 p=7757 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.177.234.8 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 19:17:26,408 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:26,414 p=7757 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 19:17:28,879 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:28,882 p=7757 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 19:17:31,208 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:31,211 p=7757 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 19:17:33,237 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:33,243 p=7757 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 19:17:34,782 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:34,785 p=7757 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 19:17:42,659 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:42,665 p=7757 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 19:17:45,298 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:45,305 p=7757 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 19:17:47,934 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:47,940 p=7757 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 19:17:51,134 p=7757 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 19:17:51,139 p=7757 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 19:17:52,615 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:52,621 p=7757 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 19:17:55,116 p=7757 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:17:55,121 p=7757 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 19:17:56,678 p=7757 u=zubeq n=ansible | fatal: [63.177.234.8]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.030842'
  end: '2025-11-10 17:17:56.443989'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 17:17:56.413147'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 19:17:56,679 p=7757 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 19:17:56,679 p=7757 u=zubeq n=ansible | 63.177.234.8               : ok=11   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 19:25:43,123 p=7998 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 19:25:43,129 p=7998 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 19:25:47,061 p=7998 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.177.234.8 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 19:25:47,061 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:25:47,071 p=7998 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 19:25:49,602 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:25:49,608 p=7998 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 19:25:52,471 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:25:52,477 p=7998 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 19:25:54,625 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:25:54,634 p=7998 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 19:25:56,340 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:25:56,346 p=7998 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 19:26:04,853 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:26:04,859 p=7998 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 19:26:07,601 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:26:07,608 p=7998 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 19:26:10,561 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:26:10,565 p=7998 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 19:26:13,862 p=7998 u=zubeq n=ansible | changed: [63.177.234.8]
2025-11-10 19:26:13,867 p=7998 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 19:26:15,448 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:26:15,454 p=7998 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 19:26:18,263 p=7998 u=zubeq n=ansible | ok: [63.177.234.8]
2025-11-10 19:26:18,269 p=7998 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 19:26:19,941 p=7998 u=zubeq n=ansible | fatal: [63.177.234.8]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.032699'
  end: '2025-11-10 17:26:19.689761'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 17:26:19.657062'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 19:26:19,942 p=7998 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 19:26:19,942 p=7998 u=zubeq n=ansible | 63.177.234.8               : ok=11   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 19:59:28,669 p=9157 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 19:59:28,674 p=9157 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 19:59:32,851 p=9157 u=zubeq n=ansible | [WARNING]: Platform linux on host 3.65.1.5 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 19:59:32,851 p=9157 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 19:59:32,861 p=9157 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 20:00:24,101 p=9157 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:00:24,107 p=9157 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 20:00:29,067 p=9157 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:00:29,072 p=9157 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 20:00:32,570 p=9157 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:00:32,576 p=9157 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 20:00:34,275 p=9157 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:00:34,281 p=9157 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 20:00:47,197 p=9157 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:00:47,202 p=9157 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 20:00:50,824 p=9157 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:00:50,830 p=9157 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 20:00:54,607 p=9157 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:00:54,615 p=9157 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 20:00:58,778 p=9157 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:00:58,784 p=9157 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 20:01:02,751 p=9157 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:01:02,757 p=9157 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 20:01:06,480 p=9157 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:01:06,485 p=9157 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 20:01:08,034 p=9157 u=zubeq n=ansible | fatal: [3.65.1.5]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.032581'
  end: '2025-11-10 18:01:07.872298'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 18:01:07.839717'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 20:01:08,036 p=9157 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 20:01:08,037 p=9157 u=zubeq n=ansible | 3.65.1.5                   : ok=11   changed=9    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 20:03:27,596 p=9357 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 20:03:27,602 p=9357 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 20:03:31,355 p=9357 u=zubeq n=ansible | [WARNING]: Platform linux on host 3.65.1.5 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 20:03:31,356 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:03:31,365 p=9357 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 20:03:33,896 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:03:33,902 p=9357 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 20:03:36,058 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:03:36,064 p=9357 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 20:03:38,391 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:03:38,399 p=9357 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 20:03:40,069 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:03:40,075 p=9357 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 20:03:48,540 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:03:48,546 p=9357 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 20:03:51,661 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:03:51,668 p=9357 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 20:03:54,494 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:03:54,499 p=9357 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 20:03:57,787 p=9357 u=zubeq n=ansible | changed: [3.65.1.5]
2025-11-10 20:03:57,792 p=9357 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 20:03:59,395 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:03:59,400 p=9357 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 20:04:02,685 p=9357 u=zubeq n=ansible | ok: [3.65.1.5]
2025-11-10 20:04:02,692 p=9357 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 20:04:04,620 p=9357 u=zubeq n=ansible | fatal: [3.65.1.5]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.029226'
  end: '2025-11-10 18:04:04.439725'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 18:04:04.410499'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 20:04:04,621 p=9357 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 20:04:04,621 p=9357 u=zubeq n=ansible | 3.65.1.5                   : ok=11   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 21:44:44,706 p=15770 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 21:44:44,711 p=15770 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 21:44:48,199 p=15770 u=zubeq n=ansible | [WARNING]: Platform linux on host 3.121.180.47 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 21:44:48,199 p=15770 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:44:48,208 p=15770 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 21:45:37,613 p=15770 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:45:37,619 p=15770 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 21:45:41,851 p=15770 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:45:41,857 p=15770 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 21:45:45,122 p=15770 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:45:45,130 p=15770 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 21:45:46,833 p=15770 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:45:46,838 p=15770 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 21:45:56,019 p=15770 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:45:56,025 p=15770 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 21:45:58,516 p=15770 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:45:58,522 p=15770 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 21:46:02,201 p=15770 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:46:02,208 p=15770 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 21:46:05,449 p=15770 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:46:05,453 p=15770 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 21:46:06,894 p=15770 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:46:06,899 p=15770 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 21:46:10,221 p=15770 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:46:10,226 p=15770 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 21:46:11,845 p=15770 u=zubeq n=ansible | fatal: [3.121.180.47]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.033992'
  end: '2025-11-10 19:46:11.675963'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 19:46:11.641971'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 21:46:11,846 p=15770 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 21:46:11,846 p=15770 u=zubeq n=ansible | 3.121.180.47               : ok=11   changed=9    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 21:48:38,005 p=15960 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 21:48:38,011 p=15960 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 21:48:42,374 p=15960 u=zubeq n=ansible | [WARNING]: Platform linux on host 3.121.180.47 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 21:48:42,374 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:48:42,386 p=15960 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 21:48:45,149 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:48:45,154 p=15960 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 21:48:47,498 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:48:47,503 p=15960 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 21:48:49,956 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:48:49,965 p=15960 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 21:48:51,597 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:48:51,604 p=15960 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 21:48:59,324 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:48:59,331 p=15960 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 21:49:02,692 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:49:02,698 p=15960 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 21:49:05,478 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:49:05,482 p=15960 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 21:49:08,861 p=15960 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:49:08,867 p=15960 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 21:49:10,497 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:49:10,503 p=15960 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 21:49:13,218 p=15960 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:49:13,225 p=15960 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 21:49:14,797 p=15960 u=zubeq n=ansible | fatal: [3.121.180.47]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.029585'
  end: '2025-11-10 19:49:14.608596'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 19:49:14.579011'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 21:49:14,798 p=15960 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 21:49:14,798 p=15960 u=zubeq n=ansible | 3.121.180.47               : ok=11   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 21:51:39,343 p=16172 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 21:51:39,348 p=16172 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 21:51:43,529 p=16172 u=zubeq n=ansible | [WARNING]: Platform linux on host 3.121.180.47 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 21:51:43,529 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:51:43,539 p=16172 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 21:51:45,769 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:51:45,776 p=16172 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 21:51:47,797 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:51:47,804 p=16172 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 21:51:49,774 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:51:49,784 p=16172 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 21:51:51,314 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:51:51,320 p=16172 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 21:51:58,539 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:51:58,545 p=16172 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 21:52:01,431 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:52:01,440 p=16172 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 21:52:04,583 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:52:04,589 p=16172 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 21:52:07,716 p=16172 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:52:07,721 p=16172 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 21:52:09,163 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:52:09,170 p=16172 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 21:52:11,848 p=16172 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:52:11,855 p=16172 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 21:52:13,361 p=16172 u=zubeq n=ansible | fatal: [3.121.180.47]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.029669'
  end: '2025-11-10 19:52:13.191524'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 19:52:13.161855'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 21:52:13,362 p=16172 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 21:52:13,362 p=16172 u=zubeq n=ansible | 3.121.180.47               : ok=11   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 21:57:57,716 p=16369 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 21:57:57,721 p=16369 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 21:58:02,160 p=16369 u=zubeq n=ansible | [WARNING]: Platform linux on host 3.121.180.47 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 21:58:02,160 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:02,170 p=16369 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 21:58:04,688 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:04,693 p=16369 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 21:58:07,259 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:07,268 p=16369 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 21:58:09,578 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:09,588 p=16369 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 21:58:11,178 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:11,184 p=16369 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 21:58:17,841 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:17,846 p=16369 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 21:58:20,222 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:20,231 p=16369 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 21:58:22,648 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:22,655 p=16369 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 21:58:25,836 p=16369 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 21:58:25,844 p=16369 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 21:58:28,098 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:28,105 p=16369 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 21:58:30,744 p=16369 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 21:58:30,750 p=16369 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 21:58:32,290 p=16369 u=zubeq n=ansible | fatal: [3.121.180.47]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.030924'
  end: '2025-11-10 19:58:32.123029'
  msg: non-zero return code
  rc: 15
  start: '2025-11-10 19:58:32.092105'
  stderr: 'yaml: line 134: mapping values are not allowed in this context'
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-10 21:58:32,291 p=16369 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 21:58:32,292 p=16369 u=zubeq n=ansible | 3.121.180.47               : ok=11   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-10 22:02:32,373 p=16624 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Prometheus + Grafana stack with Docker] *********************
2025-11-10 22:02:32,378 p=16624 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-10 22:02:35,775 p=16624 u=zubeq n=ansible | [WARNING]: Platform linux on host 3.121.180.47 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-10 22:02:35,775 p=16624 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 22:02:35,785 p=16624 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-10 22:02:37,963 p=16624 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 22:02:37,969 p=16624 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-10 22:02:40,160 p=16624 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 22:02:40,166 p=16624 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-10 22:02:42,262 p=16624 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 22:02:42,270 p=16624 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-10 22:02:43,949 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:02:43,955 p=16624 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-10 22:02:52,835 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:02:52,842 p=16624 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-10 22:02:55,657 p=16624 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 22:02:55,664 p=16624 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-10 22:02:58,764 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:02:58,769 p=16624 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-10 22:03:02,786 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:03:02,791 p=16624 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-10 22:03:04,588 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:03:04,594 p=16624 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-10 22:03:08,008 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:03:08,013 p=16624 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-10 22:03:42,259 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:03:42,263 p=16624 u=zubeq n=ansible | TASK [app : Show docker-compose output] *******************************************************
2025-11-10 22:03:42,278 p=16624 u=zubeq n=ansible | ok: [3.121.180.47] => 
  compose_result.stdout_lines:
  - '#0 building with "default" instance using docker driver'
  - ''
  - '#1 [web internal] load build definition from Dockerfile'
  - '#1 transferring dockerfile: 514B done'
  - '#1 DONE 0.1s'
  - ''
  - '#2 [web internal] load metadata for docker.io/library/python:3.11-slim'
  - '#2 DONE 1.5s'
  - ''
  - '#3 [web internal] load .dockerignore'
  - '#3 transferring context: 2B done'
  - '#3 DONE 0.0s'
  - ''
  - '#4 [web internal] load build context'
  - '#4 transferring context: 7.91kB done'
  - '#4 DONE 0.0s'
  - ''
  - '#5 [web 1/5] FROM docker.io/library/python:3.11-slim@sha256:e4676722fba839e2e5cdb844a52262b43e90e56dbd55b7ad953ee3615ad7534f'
  - '#5 resolve docker.io/library/python:3.11-slim@sha256:e4676722fba839e2e5cdb844a52262b43e90e56dbd55b7ad953ee3615ad7534f 0.0s done'
  - '#5 sha256:e4676722fba839e2e5cdb844a52262b43e90e56dbd55b7ad953ee3615ad7534f 10.37kB / 10.37kB done'
  - '#5 sha256:b596083aa14d47c78a652138aa9b98607585499d7c7ec343ae378f6c5770822d 1.75kB / 1.75kB done'
  - '#5 sha256:870925f757415a696459255b0a20b082e914cac42efaff4424b59e21bff80d5b 5.48kB / 5.48kB done'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 0B / 29.78MB 0.1s'
  - '#5 sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0B / 1.29MB 0.1s'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 0B / 14.36MB 0.1s'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 6.29MB / 29.78MB 0.4s'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 19.92MB / 29.78MB 0.6s'
  - '#5 sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 1.29MB / 1.29MB 0.4s done'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 5.24MB / 14.36MB 0.6s'
  - '#5 sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc 0B / 248B 0.6s'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 27.26MB / 29.78MB 0.7s'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 12.58MB / 14.36MB 0.7s'
  - '#5 sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc 248B / 248B 0.7s done'
  - '#5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 29.78MB / 29.78MB 0.8s done'
  - '#5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 14.36MB / 14.36MB 0.7s done'
  - '#5 extracting sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc'
  - '#5 extracting sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 1.4s done'
  - '#5 extracting sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0.1s'
  - '#5 extracting sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0.1s done'
  - '#5 extracting sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 0.1s'
  - '#5 extracting sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 1.0s done'
  - '#5 extracting sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc done'
  - '#5 DONE 3.6s'
  - ''
  - '#6 [web 2/5] WORKDIR /app'
  - '#6 DONE 0.2s'
  - ''
  - '#7 [web 3/5] COPY requirements.txt .'
  - '#7 DONE 0.0s'
  - ''
  - '#8 [web 4/5] RUN pip install --no-cache-dir -r requirements.txt'
  - '#8 2.418 Collecting Flask (from -r requirements.txt (line 1))'
  - '#8 2.439   Downloading flask-3.1.2-py3-none-any.whl.metadata (3.2 kB)'
  - '#8 2.526 Collecting psycopg2-binary (from -r requirements.txt (line 2))'
  - '#8 2.529   Downloading psycopg2_binary-2.9.11-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (4.9 kB)'
  - '#8 2.552 Collecting prometheus_flask_exporter (from -r requirements.txt (line 3))'
  - '#8 2.558   Downloading prometheus_flask_exporter-0.23.2-py3-none-any.whl.metadata (20 kB)'
  - '#8 2.586 Collecting blinker>=1.9.0 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.591   Downloading blinker-1.9.0-py3-none-any.whl.metadata (1.6 kB)'
  - '#8 2.617 Collecting click>=8.1.3 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.621   Downloading click-8.3.0-py3-none-any.whl.metadata (2.6 kB)'
  - '#8 2.640 Collecting itsdangerous>=2.2.0 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.643   Downloading itsdangerous-2.2.0-py3-none-any.whl.metadata (1.9 kB)'
  - '#8 2.668 Collecting jinja2>=3.1.2 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.672   Downloading jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)'
  - '#8 2.745 Collecting markupsafe>=2.1.1 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.749   Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (2.7 kB)'
  - '#8 2.803 Collecting werkzeug>=3.1.0 (from Flask->-r requirements.txt (line 1))'
  - '#8 2.807   Downloading werkzeug-3.1.3-py3-none-any.whl.metadata (3.7 kB)'
  - '#8 2.842 Collecting prometheus_client (from prometheus_flask_exporter->-r requirements.txt (line 3))'
  - '#8 2.846   Downloading prometheus_client-0.23.1-py3-none-any.whl.metadata (1.9 kB)'
  - '#8 2.868 Downloading flask-3.1.2-py3-none-any.whl (103 kB)'
  - '#8 2.872    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 103.3/103.3 kB 250.0 MB/s eta 0:00:00'
  - '#8 2.876 Downloading psycopg2_binary-2.9.11-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (4.2 MB)'
  - '#8 2.902    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.2/4.2 MB 186.5 MB/s eta 0:00:00'
  - '#8 2.913 Downloading prometheus_flask_exporter-0.23.2-py3-none-any.whl (19 kB)'
  - '#8 2.917 Downloading blinker-1.9.0-py3-none-any.whl (8.5 kB)'
  - '#8 2.921 Downloading click-8.3.0-py3-none-any.whl (107 kB)'
  - '#8 2.924    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 107.3/107.3 kB 249.4 MB/s eta 0:00:00'
  - '#8 2.928 Downloading itsdangerous-2.2.0-py3-none-any.whl (16 kB)'
  - '#8 2.933 Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)'
  - '#8 2.936    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 134.9/134.9 kB 295.6 MB/s eta 0:00:00'
  - '#8 2.940 Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (22 kB)'
  - '#8 2.944 Downloading werkzeug-3.1.3-py3-none-any.whl (224 kB)'
  - '#8 2.948    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 224.5/224.5 kB 316.4 MB/s eta 0:00:00'
  - '#8 2.953 Downloading prometheus_client-0.23.1-py3-none-any.whl (61 kB)'
  - '#8 2.956    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.1/61.1 kB 236.8 MB/s eta 0:00:00'
  - '#8 3.063 Installing collected packages: psycopg2-binary, prometheus_client, markupsafe, itsdangerous, click, blinker, werkzeug, jinja2, Flask, prometheus_flask_exporter'
  - '#8 3.751 Successfully installed Flask-3.1.2 blinker-1.9.0 click-8.3.0 itsdangerous-2.2.0 jinja2-3.1.6 markupsafe-3.0.3 prometheus_client-0.23.1 prometheus_flask_exporter-0.23.2 psycopg2-binary-2.9.11 werkzeug-3.1.3'
  - '#8 3.752 WARNING: Running pip as the ''root'' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv'
  - '#8 3.833 '
  - '#8 3.833 [notice] A new release of pip is available: 24.0 -> 25.3'
  - '#8 3.833 [notice] To update, run: pip install --upgrade pip'
  - '#8 DONE 4.1s'
  - ''
  - '#9 [web 5/5] COPY . /app'
  - '#9 DONE 0.0s'
  - ''
  - '#10 [web] exporting to image'
  - '#10 exporting layers'
  - '#10 exporting layers 0.3s done'
  - '#10 writing image sha256:d3190e9cb7216d5afb038c658a832e890bb71bb570e6ef0126c0046e4f9800d8 done'
  - '#10 naming to docker.io/library/myflaskapp:1.0.0 done'
  - '#10 DONE 0.3s'
2025-11-10 22:03:42,281 p=16624 u=zubeq n=ansible | TASK [app : Check running containers (formatted)] *********************************************
2025-11-10 22:03:44,544 p=16624 u=zubeq n=ansible | ok: [3.121.180.47]
2025-11-10 22:03:44,551 p=16624 u=zubeq n=ansible | TASK [app : Show container status] ************************************************************
2025-11-10 22:03:44,565 p=16624 u=zubeq n=ansible | ok: [3.121.180.47] => 
  docker_ps.stdout_lines:
  - NAMES               STATUS                            PORTS
  - 'grafana             Up 2 seconds (health: starting)   0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'postgres_exporter   Up 2 seconds (health: starting)   0.0.0.0:9187->9187/tcp, :::9187->9187/tcp'
  - 'web_app             Up 2 seconds (health: starting)   0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'alertmanager        Up 3 seconds (health: starting)   0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - 'prometheus          Up 3 seconds (health: starting)   0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - 'cadvisor_exporter   Up 3 seconds (health: starting)   0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
  - 'postgres_db         Up 3 seconds (health: starting)   0.0.0.0:5432->5432/tcp, :::5432->5432/tcp'
  - 'node_exporter       Up 3 seconds (health: starting)   0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
2025-11-10 22:03:44,569 p=16624 u=zubeq n=ansible | TASK [app : Create alerts directory] **********************************************************
2025-11-10 22:03:46,173 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:03:46,180 p=16624 u=zubeq n=ansible | TASK [app : Copy alert rules] *****************************************************************
2025-11-10 22:03:49,658 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:03:49,676 p=16624 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] ******************************************
2025-11-10 22:03:53,558 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:03:53,561 p=16624 u=zubeq n=ansible | RUNNING HANDLER [app : Restart compose stack] *************************************************
2025-11-10 22:04:07,778 p=16624 u=zubeq n=ansible | changed: [3.121.180.47]
2025-11-10 22:04:07,786 p=16624 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-10 22:04:07,786 p=16624 u=zubeq n=ansible | 3.121.180.47               : ok=19   changed=11   unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-11-12 20:15:21,649 p=10084 u=zubeq n=ansible | ERROR! no module/action detected in task.

The error appears to be in '/media/zubeq/ext4d4/gpt5/5 eto 6/ansible/roles/backup/tasks/main.yml': line 26, column 3, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:


- name: Setup daily
  ^ here

2025-11-12 20:27:35,210 p=10584 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ******************************
2025-11-12 20:27:35,216 p=10584 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-12 20:27:42,126 p=10584 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 20:27:42,126 p=10584 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:27:42,138 p=10584 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-12 20:28:30,224 p=10584 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:28:30,228 p=10584 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-12 20:28:42,475 p=10584 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:28:42,481 p=10584 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-12 20:28:47,855 p=10584 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:28:47,865 p=10584 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-12 20:28:50,461 p=10584 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:28:50,467 p=10584 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-12 20:29:25,865 p=10584 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:29:25,871 p=10584 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-12 20:29:31,773 p=10584 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:29:31,779 p=10584 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-12 20:29:39,730 p=10584 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:29:39,735 p=10584 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-12 20:29:40,782 p=10584 u=zubeq n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: ansible.errors.AnsibleUndefinedVariable: 'postgresexporter_image' is undefined. 'postgresexporter_image' is undefined
2025-11-12 20:29:40,783 p=10584 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => changed=false 
  msg: 'AnsibleUndefinedVariable: ''postgresexporter_image'' is undefined. ''postgresexporter_image'' is undefined'
2025-11-12 20:29:40,785 p=10584 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-12 20:29:40,785 p=10584 u=zubeq n=ansible | 52.59.210.211              : ok=8    changed=5    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 20:30:53,571 p=10767 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ******************************
2025-11-12 20:30:53,577 p=10767 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-12 20:31:10,722 p=10767 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 20:31:10,722 p=10767 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:31:10,732 p=10767 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-12 20:31:18,224 p=10767 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:31:18,229 p=10767 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-12 20:32:22,154 p=10767 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:32:22,160 p=10767 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-12 20:32:30,727 p=10767 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:32:30,735 p=10767 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-12 20:32:32,922 p=10767 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:32:32,926 p=10767 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-12 20:32:44,410 p=10767 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:32:44,415 p=10767 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-12 20:32:48,838 p=10767 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:32:48,845 p=10767 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-12 20:32:53,730 p=10767 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:32:53,735 p=10767 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-12 20:32:58,336 p=10767 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:32:58,343 p=10767 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-12 20:33:00,924 p=10767 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:33:00,931 p=10767 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-12 20:33:06,587 p=10767 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:33:06,593 p=10767 u=zubeq n=ansible | TASK [app : Create alerts directory] **********************************************************
2025-11-12 20:33:08,986 p=10767 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:33:08,993 p=10767 u=zubeq n=ansible | TASK [app : Template alert rules] *************************************************************
2025-11-12 20:33:09,384 p=10767 u=zubeq n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was:           description: "Container {{ $labels.name }} has restarted {{ $value | humanize }} times in the last 15 minutes.". unexpected char '$' at 536
2025-11-12 20:33:09,387 p=10767 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => changed=false 
  msg: |-
    AnsibleError: template error while templating string: unexpected char '$' at 536. String: # ========================================
    # PROMETHEUS ALERT RULES
    # ========================================
    # Правила для мониторинга инфраструктуры и приложений
  
    groups:
      # --- Базовые алерты ---
      - name: basic_alerts
        interval: 30s
        rules:
          # Контейнер недоступен (через up метрику)
          - alert: ServiceDown
            expr: up == 0
            for: 2m  # Увеличено до 2 минут, чтобы избежать ложных срабатываний при рестарте
            labels:
              severity: critical
            annotations:
              summary: "Service {{ $labels.job }} is down"
              description: "{{ $labels.job }} on {{ $labels.instance }} has been down for more than 2 minutes."
  
          # Контейнер не виден в cAdvisor
          - alert: ContainerNotSeen
            expr: (time() - container_last_seen{name=~"web_app|postgres_db|prometheus|grafana|alertmanager"}) > 120
            for: 1m
            labels:
              severity: critical
            annotations:
              summary: "Container {{ $labels.name }} not seen"
              description: "Container {{ $labels.name }} hasn't been seen by cAdvisor for more than 2 minutes."
  
      # --- Системные ресурсы ---
      - name: system_resources
        interval: 30s
        rules:
          # Высокая загрузка CPU (хост)
          - alert: HighCPUUsage
            expr: 100 - (avg by (instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 80
            for: 5m  # 5 минут стабильно высокого CPU
            labels:
              severity: warning
            annotations:
              summary: "High CPU usage on {{ $labels.instance }}"
              description: "CPU usage is {{ $value | humanize }}% (threshold: 80%) for more than 5 minutes."
  
          # Критически высокая загрузка CPU
          - alert: CriticalCPUUsage
            expr: 100 - (avg by (instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 95
            for: 2m
            labels:
              severity: critical
            annotations:
              summary: "Critical CPU usage on {{ $labels.instance }}"
              description: "CPU usage is {{ $value | humanize }}% (threshold: 95%)."
  
          # Высокое использование памяти
          - alert: HighMemoryUsage
            expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100 > 85
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "High memory usage on {{ $labels.instance }}"
              description: "Memory usage is {{ $value | humanize }}% (threshold: 85%)."
  
          # Критически мало памяти
          - alert: CriticalMemoryUsage
            expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100 > 95
            for: 2m
            labels:
              severity: critical
            annotations:
              summary: "Critical memory usage on {{ $labels.instance }}"
              description: "Memory usage is {{ $value | humanize }}% (threshold: 95%)."
  
          # Заканчивается место на диске
          - alert: DiskSpaceLow
            expr: (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"}) * 100 < 20
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Low disk space on {{ $labels.instance }}"
              description: "Root filesystem has {{ $value | humanize }}% free space remaining."
  
          # Критически мало места на диске
          - alert: DiskSpaceCritical
            expr: (node_filesystem_avail_bytes{mountpoint="/"} / node_filesystem_size_bytes{mountpoint="/"}) * 100 < 10
            for: 2m
            labels:
              severity: critical
            annotations:
              summary: "Critical disk space on {{ $labels.instance }}"
              description: "Root filesystem has only {{ $value | humanize }}% free space remaining."
  
      # --- Database Alerts ---
      - name: database_alerts
        interval: 30s
        rules:
          # PostgreSQL недоступен (через postgres_exporter)
          - alert: PostgresDown
            expr: pg_up == 0
            for: 2m
            labels:
              severity: critical
            annotations:
              summary: "PostgreSQL is down"
              description: "PostgreSQL on {{ $labels.instance }} has been down for more than 2 minutes."
  
          # Слишком много подключений к БД
          - alert: PostgresTooManyConnections
            expr: sum(pg_stat_activity_count) > 80
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "PostgreSQL has too many connections"
              description: "PostgreSQL has {{ $value }} active connections."
  
          # Медленные запросы в БД
          - alert: PostgresSlowQueries
            expr: rate(pg_stat_activity_max_tx_duration[5m]) > 60
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "PostgreSQL has slow queries"
              description: "Longest transaction duration is {{ $value | humanize }}s."
  
      # --- Application Alerts ---
      - name: application_alerts
        interval: 30s
        rules:
          # Flask приложение отвечает медленно
          - alert: SlowFlaskResponse
            expr: histogram_quantile(0.95, rate(flask_http_request_duration_seconds_bucket[5m])) > 2
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Flask app is responding slowly"
              description: "95th percentile response time is {{ $value | humanize }}s (threshold: 2s)."
  
          # Много 5xx ошибок
          - alert: HighErrorRate
            expr: rate(flask_http_request_total{status=~"5.."}[5m]) > 0.1
            for: 5m
            labels:
              severity: critical
            annotations:
              summary: "High error rate in Flask app"
              description: "Flask is returning {{ $value | humanize }} 5xx errors per second."
  
          # Flask не может подключиться к БД
          - alert: FlaskDatabaseConnectionFailed
            expr: up{job="flask"} == 1 and rate(flask_http_request_total{status="500"}[5m]) > 0
            for: 2m
            labels:
              severity: critical
            annotations:
              summary: "Flask cannot connect to database"
              description: "Flask is returning 500 errors, database connection might be broken."
  
      # --- Container Resource Alerts ---
      - name: container_resources
        interval: 30s
        rules:
          # Контейнер использует слишком много CPU
          - alert: ContainerHighCPU
            expr: rate(container_cpu_usage_seconds_total{name!=""}[5m]) * 100 > 80
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Container {{ $labels.name }} high CPU usage"
              description: "Container {{ $labels.name }} is using {{ $value | humanize }}% CPU."
  
          # Контейнер использует слишком много памяти
          - alert: ContainerHighMemory
            expr: (container_memory_usage_bytes{name!=""} / container_spec_memory_limit_bytes{name!=""}) * 100 > 80
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Container {{ $labels.name }} high memory usage"
              description: "Container {{ $labels.name }} is using {{ $value | humanize }}% of its memory limit."
  
          # Контейнер перезапускается слишком часто
          - alert: ContainerRestartingOften
            expr: rate(container_last_seen{name!=""}[15m]) > 0.1
            for: 5m
            labels:
              severity: warning
            annotations:
              summary: "Container {{ $labels.name }} restarting frequently"
              description: "Container {{ $labels.name }} has restarted {{ $value | humanize }} times in the last 15 minutes.". unexpected char '$' at 536
2025-11-12 20:33:09,389 p=10767 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-12 20:33:09,389 p=10767 u=zubeq n=ansible | 52.59.210.211              : ok=12   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 20:39:18,049 p=11001 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ***************
2025-11-12 20:39:18,056 p=11001 u=zubeq n=ansible | TASK [Gathering Facts] *********************************************************
2025-11-12 20:39:57,691 p=11001 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python
interpreter at /usr/bin/python3.9, but future installation of another Python
interpreter could change the meaning of that path. See
https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 20:39:57,692 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:39:57,698 p=11001 u=zubeq n=ansible | TASK [docker : Install Docker engine] ******************************************
2025-11-12 20:40:35,457 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:40:35,461 p=11001 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ********************************
2025-11-12 20:40:48,039 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:40:48,045 p=11001 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] *********************
2025-11-12 20:41:13,571 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:41:13,581 p=11001 u=zubeq n=ansible | TASK [app : Create application directory] **************************************
2025-11-12 20:41:30,147 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:41:30,153 p=11001 u=zubeq n=ansible | TASK [app : Copy Flask app files] **********************************************
2025-11-12 20:42:18,717 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:42:18,723 p=11001 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ***************************************************
2025-11-12 20:42:31,387 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:42:31,394 p=11001 u=zubeq n=ansible | TASK [app : Template prometheus.yml] *******************************************
2025-11-12 20:43:06,729 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:43:06,735 p=11001 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ***************************************
2025-11-12 20:43:34,315 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:43:34,321 p=11001 u=zubeq n=ansible | TASK [app : Create alertmanager directory] *************************************
2025-11-12 20:43:44,658 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:43:44,664 p=11001 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] *****************************************
2025-11-12 20:44:27,967 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:44:27,973 p=11001 u=zubeq n=ansible | TASK [app : Create alerts directory] *******************************************
2025-11-12 20:44:41,261 p=11001 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:44:41,267 p=11001 u=zubeq n=ansible | TASK [app : Template alert rules] **********************************************
2025-11-12 20:44:51,402 p=11001 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 20:44:51,407 p=11001 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] ****************************************
2025-11-12 20:44:57,311 p=11001 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => changed=false 
  cmd: /usr/bin/docker --host unix:///var/run/docker.sock version --format '{{ json . }}'
  msg: 'permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Frun%2Fdocker.sock/v1.44/version": dial unix /var/run/docker.sock: connect: permission denied'
  rc: 1
  stderr: |-
    permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock: Get "http://%2Fvar%2Frun%2Fdocker.sock/v1.44/version": dial unix /var/run/docker.sock: connect: permission denied
  stderr_lines: <omitted>
  stdout: |-
    {"Client":{"Version":"25.0.13","ApiVersion":"1.44","DefaultAPIVersion":"1.44","GitCommit":"0bab007","GoVersion":"go1.24.7","Os":"linux","Arch":"amd64","BuildTime":"Tue Sep 23 00:00:00 2025","Context":"default"},"Server":null}
  stdout_lines: <omitted>
2025-11-12 20:44:57,312 p=11001 u=zubeq n=ansible | PLAY RECAP *********************************************************************
2025-11-12 20:44:57,313 p=11001 u=zubeq n=ansible | 52.59.210.211              : ok=13   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 20:57:24,705 p=11567 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 20:57:24,712 p=11567 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 20:57:32,745 p=11567 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 20:57:32,745 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:57:32,755 p=11567 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 20:57:41,856 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:57:41,862 p=11567 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 20:57:46,523 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:57:46,529 p=11567 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 20:57:50,863 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:57:50,874 p=11567 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 20:57:53,578 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:57:53,583 p=11567 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 20:58:05,422 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:58:05,429 p=11567 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 20:58:10,565 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:58:10,571 p=11567 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 20:58:16,327 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:58:16,333 p=11567 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 20:58:22,083 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:58:22,091 p=11567 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 20:58:24,897 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:58:24,904 p=11567 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 20:58:30,617 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:58:30,624 p=11567 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 20:58:33,201 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:58:33,209 p=11567 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 20:58:37,986 p=11567 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 20:58:37,995 p=11567 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 20:59:14,785 p=11567 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:34.008639'
  end: '2025-11-12 18:59:14.384785'
  msg: non-zero return code
  rc: 1
  start: '2025-11-12 18:58:40.376146'
  stderr: |2-
     node_exporter Pulling
     alertmanager Pulling
     cadvisor_exporter Pulling
     promtail Pulling
     web Pulling
     loki Pulling
     prometheus Pulling
     db Pulling
     grafana Pulling
     postgres_exporter Pulling
     web Warning
     a88dc8b54e91 Pulling fs layer
     7d9d19af92b7 Pulling fs layer
     0aadeeacd5c8 Pulling fs layer
     38472f976319 Pulling fs layer
     1c292d3fb613 Pulling fs layer
     38472f976319 Waiting
     1c292d3fb613 Waiting
     2abcce694348 Pulling fs layer
     455fd88e5221 Pulling fs layer
     324153f2810a Pulling fs layer
     2abcce694348 Waiting
     455fd88e5221 Waiting
     324153f2810a Waiting
     31e352740f53 Pulling fs layer
     8b1f00c5e787 Pulling fs layer
     a91d5e9859cb Pulling fs layer
     970cece5abde Pulling fs layer
     4afc9154faa4 Pulling fs layer
     0da8239be4a8 Pulling fs layer
     31e352740f53 Waiting
     8b1f00c5e787 Waiting
     a91d5e9859cb Waiting
     970cece5abde Waiting
     4afc9154faa4 Waiting
     0da8239be4a8 Waiting
     2abcce694348 Pulling fs layer
     151551e7d8a1 Pulling fs layer
     744fa558efa2 Pulling fs layer
     9d816f19104b Pulling fs layer
     d468cb5d2306 Pulling fs layer
     2bfe8123e814 Pulling fs layer
     2abcce694348 Waiting
     151551e7d8a1 Waiting
     744fa558efa2 Waiting
     9d816f19104b Waiting
     d468cb5d2306 Waiting
     2bfe8123e814 Waiting
     7d97e254a046 Pulling fs layer
     39932bcaa1cc Pulling fs layer
     4059d897dde4 Pulling fs layer
     325d59b59788 Pulling fs layer
     9e9c5b842176 Pulling fs layer
     01befd6b403e Pulling fs layer
     7d97e254a046 Waiting
     39932bcaa1cc Waiting
     4059d897dde4 Waiting
     325d59b59788 Waiting
     9e9c5b842176 Waiting
     01befd6b403e Waiting
     96526aa774ef Pulling fs layer
     932a65841cb5 Pulling fs layer
     a486d8a79b5f Pulling fs layer
     9f17a73c904a Pulling fs layer
     c1ade82e0f62 Pulling fs layer
     882619e0a642 Pulling fs layer
     2f0808654570 Pulling fs layer
     df5835f957f7 Pulling fs layer
     b94284e881a5 Pulling fs layer
     3e944d3294a3 Pulling fs layer
     96526aa774ef Waiting
     932a65841cb5 Waiting
     a486d8a79b5f Waiting
     9f17a73c904a Waiting
     df5835f957f7 Waiting
     c1ade82e0f62 Waiting
     b94284e881a5 Waiting
     3e944d3294a3 Waiting
     882619e0a642 Waiting
     2f0808654570 Waiting
     4abcf2066143 Pulling fs layer
     9365e9fefaed Pulling fs layer
     e117f3c64d80 Pulling fs layer
     c8784d631c66 Pulling fs layer
     516e02358a0a Pulling fs layer
     f8a4c09a9d57 Pulling fs layer
     d65e86d73fd5 Pulling fs layer
     dd49384f9b90 Pulling fs layer
     98c512a85a3e Pulling fs layer
     4abcf2066143 Waiting
     9365e9fefaed Waiting
     e117f3c64d80 Waiting
     c8784d631c66 Waiting
     516e02358a0a Waiting
     f8a4c09a9d57 Waiting
     d65e86d73fd5 Waiting
     dd49384f9b90 Waiting
     98c512a85a3e Waiting
     2abcce694348 Pulling fs layer
     0491ad62256e Pulling fs layer
     c2417c8f4f7c Pulling fs layer
     7cba3896d5e3 Pulling fs layer
     1979e9ba2ee4 Pulling fs layer
     0da5791e6e74 Pulling fs layer
     f256c16a5607 Pulling fs layer
     0e36311405c5 Pulling fs layer
     deacc6707a51 Pulling fs layer
     62c7872eeedd Pulling fs layer
     6a5286f5f0ae Pulling fs layer
     aaf7e836db0f Pulling fs layer
     2abcce694348 Waiting
     0491ad62256e Waiting
     c2417c8f4f7c Waiting
     7cba3896d5e3 Waiting
     1979e9ba2ee4 Waiting
     0da5791e6e74 Waiting
     f256c16a5607 Waiting
     0e36311405c5 Waiting
     deacc6707a51 Waiting
     62c7872eeedd Waiting
     6a5286f5f0ae Waiting
     aaf7e836db0f Waiting
     a88dc8b54e91 Downloading  29.41kB/2.808MB
     2abcce694348 Pulling fs layer
     455fd88e5221 Pulling fs layer
     4f3aa30077cb Pulling fs layer
     2abcce694348 Waiting
     455fd88e5221 Waiting
     4f3aa30077cb Waiting
     0aadeeacd5c8 Downloading  21.14kB/2.062MB
     a88dc8b54e91 Downloading  574.1kB/2.808MB
     7d9d19af92b7 Downloading  73.03kB/7.177MB
     0aadeeacd5c8 Download complete
     a88dc8b54e91 Downloading  1.195MB/2.808MB
     7d9d19af92b7 Downloading  6.832MB/7.177MB
     7d9d19af92b7 Verifying Checksum
     7d9d19af92b7 Download complete
     a88dc8b54e91 Downloading  1.818MB/2.808MB
     a88dc8b54e91 Downloading  2.474MB/2.808MB
     a88dc8b54e91 Verifying Checksum
     a88dc8b54e91 Download complete
     a88dc8b54e91 Extracting  32.77kB/2.808MB
     a88dc8b54e91 Extracting  2.808MB/2.808MB
     a88dc8b54e91 Pull complete
     7d9d19af92b7 Extracting   98.3kB/7.177MB
     38472f976319 Downloading  19.76kB/1.884MB
     7d9d19af92b7 Extracting  2.851MB/7.177MB
     38472f976319 Downloading    824kB/1.884MB
     7d9d19af92b7 Extracting   6.39MB/7.177MB
     2abcce694348 Downloading  9.146kB/778.8kB
     2abcce694348 Downloading  9.146kB/778.8kB
     2abcce694348 Downloading  9.146kB/778.8kB
     2abcce694348 Downloading  9.146kB/778.8kB
     2abcce694348 Verifying Checksum
     2abcce694348 Verifying Checksum
     2abcce694348 Verifying Checksum
     2abcce694348 Download complete
     2abcce694348 Verifying Checksum
     2abcce694348 Download complete
     2abcce694348 Download complete
     2abcce694348 Download complete
     2abcce694348 Extracting  32.77kB/778.8kB
     2abcce694348 Extracting  32.77kB/778.8kB
     2abcce694348 Extracting  32.77kB/778.8kB
     2abcce694348 Extracting  32.77kB/778.8kB
     2abcce694348 Extracting  778.8kB/778.8kB
     2abcce694348 Extracting  778.8kB/778.8kB
     2abcce694348 Extracting  778.8kB/778.8kB
     2abcce694348 Extracting  778.8kB/778.8kB
     2abcce694348 Extracting  778.8kB/778.8kB
     2abcce694348 Extracting  778.8kB/778.8kB
     2abcce694348 Extracting  778.8kB/778.8kB
     2abcce694348 Extracting  778.8kB/778.8kB
     7d9d19af92b7 Extracting  7.177MB/7.177MB
     38472f976319 Verifying Checksum
     38472f976319 Download complete
     7d9d19af92b7 Pull complete
     0aadeeacd5c8 Extracting  32.77kB/2.062MB
     2abcce694348 Pull complete
     2abcce694348 Pull complete
     2abcce694348 Pull complete
     2abcce694348 Pull complete
     0aadeeacd5c8 Extracting  2.032MB/2.062MB
     0aadeeacd5c8 Extracting  2.062MB/2.062MB
     0aadeeacd5c8 Extracting  2.062MB/2.062MB
     0aadeeacd5c8 Pull complete
     38472f976319 Extracting  32.77kB/1.884MB
     38472f976319 Extracting  1.884MB/1.884MB
     38472f976319 Pull complete
     455fd88e5221 Downloading  5.039kB/480.6kB
     455fd88e5221 Downloading  5.039kB/480.6kB
     455fd88e5221 Download complete
     455fd88e5221 Download complete
     455fd88e5221 Extracting  32.77kB/480.6kB
     455fd88e5221 Extracting  32.77kB/480.6kB
     324153f2810a Downloading  105.5kB/10.51MB
     324153f2810a Downloading   2.27MB/10.51MB
     455fd88e5221 Extracting  458.8kB/480.6kB
     455fd88e5221 Extracting  458.8kB/480.6kB
     455fd88e5221 Extracting  480.6kB/480.6kB
     455fd88e5221 Extracting  480.6kB/480.6kB
     455fd88e5221 Extracting  480.6kB/480.6kB
     455fd88e5221 Extracting  480.6kB/480.6kB
     324153f2810a Downloading  5.601MB/10.51MB
     1c292d3fb613 Downloading  198.6kB/19.82MB
     31e352740f53 Downloading   34.3kB/3.398MB
     455fd88e5221 Pull complete
     455fd88e5221 Pull complete
     324153f2810a Downloading  8.902MB/10.51MB
     1c292d3fb613 Downloading  597.3kB/19.82MB
     324153f2810a Verifying Checksum
     324153f2810a Download complete
     324153f2810a Extracting  131.1kB/10.51MB
     31e352740f53 Downloading   3.33MB/3.398MB
     31e352740f53 Verifying Checksum
     31e352740f53 Download complete
     31e352740f53 Extracting  65.54kB/3.398MB
     1c292d3fb613 Downloading  996.1kB/19.82MB
     324153f2810a Extracting   2.49MB/10.51MB
     31e352740f53 Extracting  1.573MB/3.398MB
     324153f2810a Extracting  4.588MB/10.51MB
     1c292d3fb613 Downloading  1.408MB/19.82MB
     31e352740f53 Extracting  3.398MB/3.398MB
     31e352740f53 Extracting  3.398MB/3.398MB
     324153f2810a Extracting  10.51MB/10.51MB
     31e352740f53 Pull complete
     8b1f00c5e787 Downloading   3.67kB/329.6kB
     1c292d3fb613 Downloading  1.834MB/19.82MB
     324153f2810a Pull complete
     8b1f00c5e787 Downloading  329.6kB/329.6kB
     8b1f00c5e787 Verifying Checksum
     8b1f00c5e787 Download complete
     8b1f00c5e787 Extracting  32.77kB/329.6kB
     node_exporter Pulled
     8b1f00c5e787 Extracting  329.6kB/329.6kB
     a91d5e9859cb Downloading  214.6kB/21.08MB
     8b1f00c5e787 Pull complete
     1c292d3fb613 Downloading  2.261MB/19.82MB
     a91d5e9859cb Downloading  3.003MB/21.08MB
     1c292d3fb613 Downloading  2.687MB/19.82MB
     a91d5e9859cb Downloading  16.63MB/21.08MB
     a91d5e9859cb Verifying Checksum
     a91d5e9859cb Download complete
     a91d5e9859cb Extracting  229.4kB/21.08MB
     970cece5abde Downloading     776B/776B
     970cece5abde Verifying Checksum
     970cece5abde Download complete
     1c292d3fb613 Downloading  3.326MB/19.82MB
     a91d5e9859cb Extracting  3.441MB/21.08MB
     1c292d3fb613 Downloading  4.178MB/19.82MB
     a91d5e9859cb Extracting  6.881MB/21.08MB
     1c292d3fb613 Downloading  6.733MB/19.82MB
     4afc9154faa4 Downloading     933B/1.239kB
     4afc9154faa4 Downloading  1.239kB/1.239kB
     4afc9154faa4 Verifying Checksum
     4afc9154faa4 Download complete
     a91d5e9859cb Extracting  9.404MB/21.08MB
     1c292d3fb613 Downloading  14.39MB/19.82MB
     0da8239be4a8 Downloading     843B/843B
     0da8239be4a8 Verifying Checksum
     0da8239be4a8 Download complete
     a91d5e9859cb Extracting   11.7MB/21.08MB
     1c292d3fb613 Verifying Checksum
     1c292d3fb613 Download complete
     1c292d3fb613 Extracting  229.4kB/19.82MB
     a91d5e9859cb Extracting  13.76MB/21.08MB
     1c292d3fb613 Extracting  2.064MB/19.82MB
     151551e7d8a1 Downloading  5.549kB/480.6kB
     a91d5e9859cb Extracting  14.68MB/21.08MB
     151551e7d8a1 Verifying Checksum
     151551e7d8a1 Download complete
     151551e7d8a1 Extracting  32.77kB/480.6kB
     1c292d3fb613 Extracting  3.899MB/19.82MB
     744fa558efa2 Downloading  133.5kB/13.27MB
     a91d5e9859cb Extracting  15.83MB/21.08MB
     1c292d3fb613 Extracting  4.588MB/19.82MB
     151551e7d8a1 Extracting  360.4kB/480.6kB
     744fa558efa2 Downloading  7.552MB/13.27MB
     744fa558efa2 Verifying Checksum
     744fa558efa2 Download complete
     9d816f19104b Downloading  168.6kB/16.71MB
     151551e7d8a1 Extracting    426kB/480.6kB
     a91d5e9859cb Extracting  16.97MB/21.08MB
     9d816f19104b Downloading  11.24MB/16.71MB
     151551e7d8a1 Extracting  480.6kB/480.6kB
     151551e7d8a1 Extracting  480.6kB/480.6kB
     9d816f19104b Verifying Checksum
     9d816f19104b Download complete
     a91d5e9859cb Extracting  17.66MB/21.08MB
     1c292d3fb613 Extracting  5.276MB/19.82MB
     d468cb5d2306 Downloading     357B/357B
     d468cb5d2306 Verifying Checksum
     d468cb5d2306 Download complete
     a91d5e9859cb Extracting  19.96MB/21.08MB
     1c292d3fb613 Extracting  7.111MB/19.82MB
     2bfe8123e814 Downloading     378B/378B
     2bfe8123e814 Verifying Checksum
     2bfe8123e814 Download complete
     a91d5e9859cb Extracting  21.08MB/21.08MB
     151551e7d8a1 Pull complete
     744fa558efa2 Extracting  163.8kB/13.27MB
     a91d5e9859cb Pull complete
     1c292d3fb613 Extracting  8.028MB/19.82MB
     970cece5abde Extracting     776B/776B
     970cece5abde Extracting     776B/776B
     970cece5abde Pull complete
     4afc9154faa4 Extracting  1.239kB/1.239kB
     4afc9154faa4 Extracting  1.239kB/1.239kB
     1c292d3fb613 Extracting  11.24MB/19.82MB
     744fa558efa2 Extracting  1.311MB/13.27MB
     7d97e254a046 Downloading  319.8kB/31.42MB
     4afc9154faa4 Pull complete
     0da8239be4a8 Extracting     843B/843B
     0da8239be4a8 Pull complete
     1c292d3fb613 Extracting  12.39MB/19.82MB
     7d97e254a046 Downloading  9.353MB/31.42MB
     744fa558efa2 Extracting   2.13MB/13.27MB
     39932bcaa1cc Downloading     279B/279B
     39932bcaa1cc Verifying Checksum
     39932bcaa1cc Download complete
     loki Pulled
     7d97e254a046 Downloading  18.13MB/31.42MB
     1c292d3fb613 Extracting  16.74MB/19.82MB
     4059d897dde4 Downloading  160.6kB/15.67MB
     744fa558efa2 Extracting  2.949MB/13.27MB
     7d97e254a046 Downloading  27.82MB/31.42MB
     1c292d3fb613 Extracting  18.81MB/19.82MB
     4059d897dde4 Downloading  7.399MB/15.67MB
     7d97e254a046 Verifying Checksum
     7d97e254a046 Download complete
     744fa558efa2 Extracting  3.604MB/13.27MB
     7d97e254a046 Extracting  327.7kB/31.42MB
     1c292d3fb613 Extracting  19.82MB/19.82MB
     4059d897dde4 Verifying Checksum
     4059d897dde4 Download complete
     325d59b59788 Downloading  7.777kB/691.6kB
     1c292d3fb613 Pull complete
     325d59b59788 Verifying Checksum
     325d59b59788 Download complete
     7d97e254a046 Extracting  1.638MB/31.42MB
     744fa558efa2 Extracting  5.243MB/13.27MB
     cadvisor_exporter Pulled
     744fa558efa2 Extracting  8.684MB/13.27MB
     7d97e254a046 Extracting  2.949MB/31.42MB
     744fa558efa2 Extracting  13.27MB/13.27MB
     744fa558efa2 Extracting  13.27MB/13.27MB
     9e9c5b842176 Downloading  286.7kB/27.5MB
     744fa558efa2 Pull complete
     7d97e254a046 Extracting  5.243MB/31.42MB
     9d816f19104b Extracting  196.6kB/16.71MB
     9e9c5b842176 Downloading  9.622MB/27.5MB
     96526aa774ef Downloading  34.25kB/3.402MB
     01befd6b403e Downloading     338B/338B
     01befd6b403e Verifying Checksum
     01befd6b403e Download complete
     9d816f19104b Extracting   1.18MB/16.71MB
     7d97e254a046 Extracting  6.554MB/31.42MB
     96526aa774ef Verifying Checksum
     96526aa774ef Download complete
     9e9c5b842176 Downloading  18.69MB/27.5MB
     96526aa774ef Extracting  65.54kB/3.402MB
     7d97e254a046 Extracting  7.209MB/31.42MB
     9d816f19104b Extracting  1.769MB/16.71MB
     9e9c5b842176 Downloading  24.09MB/27.5MB
     96526aa774ef Extracting  786.4kB/3.402MB
     7d97e254a046 Extracting   8.52MB/31.42MB
     9d816f19104b Extracting  3.146MB/16.71MB
     9e9c5b842176 Downloading  24.37MB/27.5MB
     96526aa774ef Extracting   2.49MB/3.402MB
     9e9c5b842176 Verifying Checksum
     9e9c5b842176 Download complete
     9d816f19104b Extracting  4.129MB/16.71MB
     7d97e254a046 Extracting  10.16MB/31.42MB
     932a65841cb5 Downloading     140B/140B
     932a65841cb5 Verifying Checksum
     932a65841cb5 Download complete
     96526aa774ef Extracting  3.402MB/3.402MB
     96526aa774ef Extracting  3.402MB/3.402MB
     a486d8a79b5f Downloading  31.45kB/3.045MB
     9d816f19104b Extracting  6.095MB/16.71MB
     7d97e254a046 Extracting   11.8MB/31.42MB
     a486d8a79b5f Verifying Checksum
     a486d8a79b5f Download complete
     96526aa774ef Pull complete
     932a65841cb5 Extracting     140B/140B
     932a65841cb5 Extracting     140B/140B
     9d816f19104b Extracting  7.078MB/16.71MB
     932a65841cb5 Pull complete
     a486d8a79b5f Extracting  32.77kB/3.045MB
     7d97e254a046 Extracting  13.43MB/31.42MB
     9d816f19104b Extracting  8.651MB/16.71MB
     a486d8a79b5f Extracting  622.6kB/3.045MB
     7d97e254a046 Extracting  15.07MB/31.42MB
     c1ade82e0f62 Downloading     933B/43.59kB
     c1ade82e0f62 Downloading  43.59kB/43.59kB
     c1ade82e0f62 Verifying Checksum
     c1ade82e0f62 Download complete
     9f17a73c904a Downloading  47.87kB/4.691MB
     9d816f19104b Extracting  10.22MB/16.71MB
     a486d8a79b5f Extracting    983kB/3.045MB
     9f17a73c904a Verifying Checksum
     9f17a73c904a Download complete
     7d97e254a046 Extracting  16.38MB/31.42MB
     882619e0a642 Downloading     932B/22.13kB
     882619e0a642 Downloading  22.13kB/22.13kB
     882619e0a642 Verifying Checksum
     882619e0a642 Download complete
     9d816f19104b Extracting  13.17MB/16.71MB
     a486d8a79b5f Extracting  2.261MB/3.045MB
     7d97e254a046 Extracting  17.37MB/31.42MB
     9d816f19104b Extracting  14.75MB/16.71MB
     a486d8a79b5f Extracting  2.949MB/3.045MB
     9d816f19104b Extracting  16.71MB/16.71MB
     7d97e254a046 Extracting  19.33MB/31.42MB
     9d816f19104b Pull complete
     d468cb5d2306 Extracting     357B/357B
     d468cb5d2306 Extracting     357B/357B
     2f0808654570 Downloading  528.5kB/54.33MB
     d468cb5d2306 Pull complete
     2bfe8123e814 Extracting     378B/378B
     2bfe8123e814 Extracting     378B/378B
     a486d8a79b5f Extracting  3.045MB/3.045MB
     df5835f957f7 Downloading  462.9kB/45.49MB
     2bfe8123e814 Pull complete
     2f0808654570 Downloading  8.551MB/54.33MB
     a486d8a79b5f Extracting  3.045MB/3.045MB
     b94284e881a5 Downloading     932B/11.92kB
     b94284e881a5 Downloading  11.92kB/11.92kB
     b94284e881a5 Verifying Checksum
     b94284e881a5 Download complete
     df5835f957f7 Downloading  8.351MB/45.49MB
     2f0808654570 Downloading  16.03MB/54.33MB
     7d97e254a046 Extracting  20.64MB/31.42MB
     df5835f957f7 Downloading  18.51MB/45.49MB
     alertmanager Pulled
     2f0808654570 Downloading  22.99MB/54.33MB
     7d97e254a046 Extracting   21.3MB/31.42MB
     df5835f957f7 Downloading   27.3MB/45.49MB
     2f0808654570 Downloading  30.44MB/54.33MB
     df5835f957f7 Downloading  36.09MB/45.49MB
     2f0808654570 Downloading  37.39MB/54.33MB
     7d97e254a046 Extracting  21.63MB/31.42MB
     df5835f957f7 Verifying Checksum
     df5835f957f7 Download complete
     a486d8a79b5f Pull complete
     9f17a73c904a Extracting  65.54kB/4.691MB
     3e944d3294a3 Downloading     933B/1.223kB
     3e944d3294a3 Downloading  1.223kB/1.223kB
     3e944d3294a3 Verifying Checksum
     3e944d3294a3 Download complete
     2f0808654570 Downloading  47.04MB/54.33MB
     7d97e254a046 Extracting  22.61MB/31.42MB
     9f17a73c904a Extracting   1.18MB/4.691MB
     2f0808654570 Verifying Checksum
     2f0808654570 Download complete
     7d97e254a046 Extracting  24.25MB/31.42MB
     9f17a73c904a Extracting  4.194MB/4.691MB
     9f17a73c904a Extracting  4.691MB/4.691MB
     9f17a73c904a Pull complete
     7d97e254a046 Extracting  26.87MB/31.42MB
     c1ade82e0f62 Extracting  32.77kB/43.59kB
     c1ade82e0f62 Extracting  43.59kB/43.59kB
     4abcf2066143 Downloading  34.26kB/3.409MB
     c1ade82e0f62 Pull complete
     882619e0a642 Extracting  22.13kB/22.13kB
     882619e0a642 Extracting  22.13kB/22.13kB
     4abcf2066143 Downloading  3.409MB/3.409MB
     4abcf2066143 Verifying Checksum
     4abcf2066143 Download complete
     4abcf2066143 Extracting  65.54kB/3.409MB
     9365e9fefaed Downloading     934B/1.264kB
     9365e9fefaed Downloading  1.264kB/1.264kB
     9365e9fefaed Verifying Checksum
     9365e9fefaed Download complete
     7d97e254a046 Extracting  28.51MB/31.42MB
     882619e0a642 Pull complete
     4abcf2066143 Extracting  786.4kB/3.409MB
     e117f3c64d80 Downloading     116B/116B
     e117f3c64d80 Verifying Checksum
     e117f3c64d80 Download complete
     2f0808654570 Extracting  557.1kB/54.33MB
     4abcf2066143 Extracting  2.687MB/3.409MB
     2f0808654570 Extracting  1.671MB/54.33MB
     4abcf2066143 Extracting  3.409MB/3.409MB
     7d97e254a046 Extracting  28.84MB/31.42MB
     2f0808654570 Extracting  2.785MB/54.33MB
     4abcf2066143 Pull complete
     9365e9fefaed Extracting  1.264kB/1.264kB
     9365e9fefaed Extracting  1.264kB/1.264kB
     9365e9fefaed Pull complete
     e117f3c64d80 Extracting     116B/116B
     e117f3c64d80 Extracting     116B/116B
     7d97e254a046 Extracting  29.82MB/31.42MB
     2f0808654570 Extracting  4.456MB/54.33MB
     e117f3c64d80 Pull complete
     2f0808654570 Extracting  7.799MB/54.33MB
     c8784d631c66 Downloading  540.7kB/90.74MB
     516e02358a0a Downloading     953B/9.199kB
     516e02358a0a Verifying Checksum
     516e02358a0a Download complete
     f8a4c09a9d57 Downloading     128B/128B
     f8a4c09a9d57 Verifying Checksum
     f8a4c09a9d57 Download complete
     c8784d631c66 Downloading  9.093MB/90.74MB
     2f0808654570 Extracting  8.913MB/54.33MB
     7d97e254a046 Extracting  30.15MB/31.42MB
     c8784d631c66 Downloading  16.58MB/90.74MB
     c8784d631c66 Downloading  24.58MB/90.74MB
     2f0808654570 Extracting  10.03MB/54.33MB
     c8784d631c66 Downloading  30.46MB/90.74MB
     2f0808654570 Extracting  10.58MB/54.33MB
     d65e86d73fd5 Downloading     170B/170B
     d65e86d73fd5 Verifying Checksum
     d65e86d73fd5 Download complete
     c8784d631c66 Downloading  37.92MB/90.74MB
     dd49384f9b90 Downloading     934B/5.414kB
     dd49384f9b90 Downloading  5.414kB/5.414kB
     dd49384f9b90 Verifying Checksum
     dd49384f9b90 Download complete
     7d97e254a046 Extracting  30.47MB/31.42MB
     c8784d631c66 Downloading  44.88MB/90.74MB
     2f0808654570 Extracting   11.7MB/54.33MB
     7d97e254a046 Extracting  31.13MB/31.42MB
     c8784d631c66 Downloading  54.49MB/90.74MB
     2f0808654570 Extracting  13.37MB/54.33MB
     7d97e254a046 Extracting  31.42MB/31.42MB
     c8784d631c66 Downloading  62.49MB/90.74MB
     c8784d631c66 Downloading   70.5MB/90.74MB
     2f0808654570 Extracting  14.48MB/54.33MB
     0491ad62256e Downloading  5.038kB/480.9kB
     7d97e254a046 Pull complete
     0491ad62256e Downloading  480.9kB/480.9kB
     0491ad62256e Verifying Checksum
     0491ad62256e Download complete
     0491ad62256e Extracting  32.77kB/480.9kB
     39932bcaa1cc Extracting     279B/279B
     39932bcaa1cc Extracting     279B/279B
     39932bcaa1cc Pull complete
     c8784d631c66 Downloading  77.41MB/90.74MB
     4059d897dde4 Extracting  163.8kB/15.67MB
     2f0808654570 Extracting  16.15MB/54.33MB
     0491ad62256e Extracting  393.2kB/480.9kB
     98c512a85a3e Downloading     183B/183B
     98c512a85a3e Verifying Checksum
     98c512a85a3e Download complete
     c8784d631c66 Downloading  85.96MB/90.74MB
     4059d897dde4 Extracting  491.5kB/15.67MB
     c8784d631c66 Verifying Checksum
     c8784d631c66 Download complete
     0491ad62256e Extracting    426kB/480.9kB
     2f0808654570 Extracting  17.27MB/54.33MB
     4059d897dde4 Extracting  1.147MB/15.67MB
     c8784d631c66 Extracting  557.1kB/90.74MB
     4059d897dde4 Extracting  2.458MB/15.67MB
     2f0808654570 Extracting  18.94MB/54.33MB
     c8784d631c66 Extracting  1.114MB/90.74MB
     c2417c8f4f7c Downloading  510.5kB/50.66MB
     0491ad62256e Extracting  480.9kB/480.9kB
     0491ad62256e Extracting  480.9kB/480.9kB
     4059d897dde4 Extracting  3.113MB/15.67MB
     c2417c8f4f7c Downloading  7.691MB/50.66MB
     7cba3896d5e3 Downloading  466.9kB/46.64MB
     2f0808654570 Extracting  20.05MB/54.33MB
     4059d897dde4 Extracting  4.096MB/15.67MB
     1979e9ba2ee4 Downloading     605B/605B
     1979e9ba2ee4 Verifying Checksum
     1979e9ba2ee4 Download complete
     c2417c8f4f7c Downloading  11.79MB/50.66MB
     7cba3896d5e3 Downloading  6.148MB/46.64MB
     c8784d631c66 Extracting  2.228MB/90.74MB
     4059d897dde4 Extracting  4.424MB/15.67MB
     c2417c8f4f7c Downloading  17.94MB/50.66MB
     7cba3896d5e3 Downloading  14.68MB/46.64MB
     2f0808654570 Extracting  20.61MB/54.33MB
     0491ad62256e Pull complete
     c2417c8f4f7c Downloading  26.13MB/50.66MB
     7cba3896d5e3 Downloading  20.38MB/46.64MB
     4059d897dde4 Extracting  4.915MB/15.67MB
     c8784d631c66 Extracting  2.785MB/90.74MB
     2f0808654570 Extracting  21.17MB/54.33MB
     7cba3896d5e3 Downloading  27.98MB/46.64MB
     c2417c8f4f7c Downloading   33.3MB/50.66MB
     4059d897dde4 Extracting  5.571MB/15.67MB
     c2417c8f4f7c Downloading  40.99MB/50.66MB
     7cba3896d5e3 Downloading  35.09MB/46.64MB
     2f0808654570 Extracting  21.73MB/54.33MB
     4059d897dde4 Extracting   6.39MB/15.67MB
     c8784d631c66 Extracting  3.899MB/90.74MB
     0da5791e6e74 Downloading     933B/2.675kB
     0da5791e6e74 Downloading  2.675kB/2.675kB
     0da5791e6e74 Verifying Checksum
     0da5791e6e74 Download complete
     7cba3896d5e3 Downloading  40.79MB/46.64MB
     c2417c8f4f7c Downloading  47.16MB/50.66MB
     4059d897dde4 Extracting  7.373MB/15.67MB
     c8784d631c66 Extracting  4.456MB/90.74MB
     2f0808654570 Extracting  22.28MB/54.33MB
     c2417c8f4f7c Verifying Checksum
     c2417c8f4f7c Download complete
     7cba3896d5e3 Verifying Checksum
     7cba3896d5e3 Download complete
     c2417c8f4f7c Extracting  524.3kB/50.66MB
     4059d897dde4 Extracting  8.684MB/15.67MB
     c8784d631c66 Extracting  5.571MB/90.74MB
     2f0808654570 Extracting   23.4MB/54.33MB
     4059d897dde4 Extracting  10.16MB/15.67MB
     c2417c8f4f7c Extracting  2.097MB/50.66MB
     c8784d631c66 Extracting  6.685MB/90.74MB
     2f0808654570 Extracting  24.51MB/54.33MB
     f256c16a5607 Downloading     933B/3.051kB
     f256c16a5607 Downloading  3.051kB/3.051kB
     f256c16a5607 Verifying Checksum
     f256c16a5607 Download complete
     4059d897dde4 Extracting  12.45MB/15.67MB
     c8784d631c66 Extracting  8.356MB/90.74MB
     c2417c8f4f7c Extracting  3.146MB/50.66MB
     deacc6707a51 Downloading     933B/1.441kB
     deacc6707a51 Downloading  1.441kB/1.441kB
     deacc6707a51 Verifying Checksum
     deacc6707a51 Download complete
     2f0808654570 Extracting  26.18MB/54.33MB
     0e36311405c5 Downloading     933B/4.019kB
     0e36311405c5 Downloading  4.019kB/4.019kB
     0e36311405c5 Verifying Checksum
     0e36311405c5 Download complete
     4059d897dde4 Extracting  14.25MB/15.67MB
     c8784d631c66 Extracting  10.03MB/90.74MB
     2f0808654570 Extracting   27.3MB/54.33MB
     4059d897dde4 Extracting  15.67MB/15.67MB
     c2417c8f4f7c Extracting  4.719MB/50.66MB
     4059d897dde4 Pull complete
     325d59b59788 Extracting  32.77kB/691.6kB
     2f0808654570 Extracting  28.41MB/54.33MB
     62c7872eeedd Downloading  2.301kB/138.3kB
     62c7872eeedd Verifying Checksum
     62c7872eeedd Download complete
     c2417c8f4f7c Extracting  5.767MB/50.66MB
     c8784d631c66 Extracting   11.7MB/90.74MB
     325d59b59788 Extracting  691.6kB/691.6kB
     2f0808654570 Extracting  29.52MB/54.33MB
     325d59b59788 Pull complete
     c2417c8f4f7c Extracting  6.816MB/50.66MB
     6a5286f5f0ae Downloading     100B/100B
     6a5286f5f0ae Verifying Checksum
     6a5286f5f0ae Download complete
     c8784d631c66 Extracting  12.81MB/90.74MB
     9e9c5b842176 Extracting  294.9kB/27.5MB
     aaf7e836db0f Downloading     718B/718B
     aaf7e836db0f Verifying Checksum
     aaf7e836db0f Download complete
     2f0808654570 Extracting  30.64MB/54.33MB
     c2417c8f4f7c Extracting  7.864MB/50.66MB
     9e9c5b842176 Extracting  1.769MB/27.5MB
     c8784d631c66 Extracting  14.48MB/90.74MB
     2f0808654570 Extracting  31.75MB/54.33MB
     c2417c8f4f7c Extracting  8.913MB/50.66MB
     4f3aa30077cb Downloading  89.36kB/8.785MB
     9e9c5b842176 Extracting  2.949MB/27.5MB
     c8784d631c66 Extracting   15.6MB/90.74MB
     4f3aa30077cb Downloading   6.48MB/8.785MB
     2f0808654570 Extracting  32.87MB/54.33MB
     4f3aa30077cb Verifying Checksum
     4f3aa30077cb Download complete
     c2417c8f4f7c Extracting  9.961MB/50.66MB
     4f3aa30077cb Extracting   98.3kB/8.785MB
     9e9c5b842176 Extracting  3.539MB/27.5MB
     c8784d631c66 Extracting  16.71MB/90.74MB
     4f3aa30077cb Extracting  1.278MB/8.785MB
     2f0808654570 Extracting  33.98MB/54.33MB
     c2417c8f4f7c Extracting  11.01MB/50.66MB
     9e9c5b842176 Extracting  4.424MB/27.5MB
     c8784d631c66 Extracting  17.83MB/90.74MB
     4f3aa30077cb Extracting  2.654MB/8.785MB
     c2417c8f4f7c Extracting  12.06MB/50.66MB
     9e9c5b842176 Extracting  5.308MB/27.5MB
     2f0808654570 Extracting  35.09MB/54.33MB
     c8784d631c66 Extracting  18.94MB/90.74MB
     4f3aa30077cb Extracting  4.325MB/8.785MB
     9e9c5b842176 Extracting  5.898MB/27.5MB
     c2417c8f4f7c Extracting  12.58MB/50.66MB
     2f0808654570 Extracting  36.21MB/54.33MB
     4f3aa30077cb Extracting  5.112MB/8.785MB
     c8784d631c66 Extracting  20.05MB/90.74MB
     2f0808654570 Extracting  36.77MB/54.33MB
     9e9c5b842176 Extracting  6.783MB/27.5MB
     4f3aa30077cb Extracting  7.274MB/8.785MB
     c2417c8f4f7c Extracting  13.63MB/50.66MB
     c8784d631c66 Extracting  21.17MB/90.74MB
     4f3aa30077cb Extracting  8.785MB/8.785MB
     9e9c5b842176 Extracting  7.963MB/27.5MB
     2f0808654570 Extracting  37.88MB/54.33MB
     4f3aa30077cb Pull complete
     c2417c8f4f7c Extracting  14.68MB/50.66MB
     postgres_exporter Pulled
     c8784d631c66 Extracting  22.28MB/90.74MB
     9e9c5b842176 Extracting  8.847MB/27.5MB
     2f0808654570 Extracting  38.99MB/54.33MB
     c2417c8f4f7c Extracting  15.73MB/50.66MB
     c8784d631c66 Extracting   23.4MB/90.74MB
     9e9c5b842176 Extracting  10.03MB/27.5MB
     2f0808654570 Extracting  40.11MB/54.33MB
     c2417c8f4f7c Extracting  18.87MB/50.66MB
     c8784d631c66 Extracting  25.07MB/90.74MB
     9e9c5b842176 Extracting  11.21MB/27.5MB
     2f0808654570 Extracting  40.67MB/54.33MB
     c8784d631c66 Extracting  26.74MB/90.74MB
     9e9c5b842176 Extracting  12.68MB/27.5MB
     c2417c8f4f7c Extracting   19.4MB/50.66MB
     2f0808654570 Extracting  41.22MB/54.33MB
     9e9c5b842176 Extracting  13.86MB/27.5MB
     c8784d631c66 Extracting  28.41MB/90.74MB
     c2417c8f4f7c Extracting  19.92MB/50.66MB
     2f0808654570 Extracting  42.34MB/54.33MB
     c8784d631c66 Extracting  29.52MB/90.74MB
     9e9c5b842176 Extracting  14.75MB/27.5MB
     c2417c8f4f7c Extracting  20.97MB/50.66MB
     2f0808654570 Extracting  43.45MB/54.33MB
     9e9c5b842176 Extracting  16.22MB/27.5MB
     c8784d631c66 Extracting   31.2MB/90.74MB
     c2417c8f4f7c Extracting  22.02MB/50.66MB
     9e9c5b842176 Extracting  18.87MB/27.5MB
     2f0808654570 Extracting  44.56MB/54.33MB
     c2417c8f4f7c Extracting  23.07MB/50.66MB
     c8784d631c66 Extracting  32.87MB/90.74MB
     9e9c5b842176 Extracting  19.46MB/27.5MB
     c8784d631c66 Extracting  33.98MB/90.74MB
     2f0808654570 Extracting  45.68MB/54.33MB
     c2417c8f4f7c Extracting  24.64MB/50.66MB
     9e9c5b842176 Extracting  20.05MB/27.5MB
     c8784d631c66 Extracting  35.09MB/90.74MB
     2f0808654570 Extracting  46.79MB/54.33MB
     c2417c8f4f7c Extracting  25.69MB/50.66MB
     9e9c5b842176 Extracting  21.53MB/27.5MB
     c8784d631c66 Extracting  36.21MB/90.74MB
     2f0808654570 Extracting  47.35MB/54.33MB
     c2417c8f4f7c Extracting  27.26MB/50.66MB
     9e9c5b842176 Extracting     23MB/27.5MB
     c8784d631c66 Extracting  37.32MB/90.74MB
     2f0808654570 Extracting  49.02MB/54.33MB
     c2417c8f4f7c Extracting  29.36MB/50.66MB
     9e9c5b842176 Extracting  24.48MB/27.5MB
     c8784d631c66 Extracting  37.88MB/90.74MB
     c2417c8f4f7c Extracting  31.46MB/50.66MB
     2f0808654570 Extracting  50.14MB/54.33MB
     9e9c5b842176 Extracting  25.66MB/27.5MB
     c8784d631c66 Extracting  38.99MB/90.74MB
     c2417c8f4f7c Extracting  33.55MB/50.66MB
     2f0808654570 Extracting  51.25MB/54.33MB
     9e9c5b842176 Extracting  26.84MB/27.5MB
     9e9c5b842176 Extracting   27.5MB/27.5MB
     c8784d631c66 Extracting  40.11MB/90.74MB
     9e9c5b842176 Pull complete
     c2417c8f4f7c Extracting  35.65MB/50.66MB
     01befd6b403e Extracting     338B/338B
     01befd6b403e Extracting     338B/338B
     c8784d631c66 Extracting  41.22MB/90.74MB
     01befd6b403e Pull complete
     promtail Pulled
     c2417c8f4f7c Extracting  38.27MB/50.66MB
     2f0808654570 Extracting  52.36MB/54.33MB
     c8784d631c66 Extracting  42.34MB/90.74MB
     c2417c8f4f7c Extracting  42.99MB/50.66MB
     2f0808654570 Extracting  52.92MB/54.33MB
     2f0808654570 Extracting  54.33MB/54.33MB
     c2417c8f4f7c Extracting  47.19MB/50.66MB
     c8784d631c66 Extracting  44.01MB/90.74MB
     2f0808654570 Pull complete
     c8784d631c66 Extracting  45.68MB/90.74MB
     c2417c8f4f7c Extracting  50.33MB/50.66MB
     df5835f957f7 Extracting  458.8kB/45.49MB
     c8784d631c66 Extracting  46.24MB/90.74MB
     c2417c8f4f7c Extracting  50.66MB/50.66MB
     c2417c8f4f7c Pull complete
     c8784d631c66 Extracting  47.91MB/90.74MB
     7cba3896d5e3 Extracting  491.5kB/46.64MB
     c8784d631c66 Extracting  50.14MB/90.74MB
     7cba3896d5e3 Extracting  2.458MB/46.64MB
     c8784d631c66 Extracting  51.81MB/90.74MB
     7cba3896d5e3 Extracting  3.932MB/46.64MB
     c8784d631c66 Extracting  53.48MB/90.74MB
     df5835f957f7 Extracting  917.5kB/45.49MB
     7cba3896d5e3 Extracting  4.915MB/46.64MB
     c8784d631c66 Extracting  55.71MB/90.74MB
     7cba3896d5e3 Extracting  6.881MB/46.64MB
     c8784d631c66 Extracting  57.93MB/90.74MB
     7cba3896d5e3 Extracting  8.356MB/46.64MB
     c8784d631c66 Extracting   59.6MB/90.74MB
     df5835f957f7 Extracting  1.376MB/45.49MB
     c8784d631c66 Extracting  60.16MB/90.74MB
     7cba3896d5e3 Extracting   9.83MB/46.64MB
     df5835f957f7 Extracting  1.835MB/45.49MB
     7cba3896d5e3 Extracting  10.81MB/46.64MB
     c8784d631c66 Extracting  60.72MB/90.74MB
     c8784d631c66 Extracting  61.83MB/90.74MB
     7cba3896d5e3 Extracting  12.29MB/46.64MB
     c8784d631c66 Extracting  62.95MB/90.74MB
     df5835f957f7 Extracting  3.211MB/45.49MB
     c8784d631c66 Extracting  64.62MB/90.74MB
     7cba3896d5e3 Extracting  13.27MB/46.64MB
     c8784d631c66 Extracting  66.29MB/90.74MB
     7cba3896d5e3 Extracting  14.25MB/46.64MB
     c8784d631c66 Extracting  67.96MB/90.74MB
     7cba3896d5e3 Extracting  15.24MB/46.64MB
     c8784d631c66 Extracting  69.63MB/90.74MB
     df5835f957f7 Extracting   3.67MB/45.49MB
     7cba3896d5e3 Extracting  16.22MB/46.64MB
     c8784d631c66 Extracting  70.75MB/90.74MB
     7cba3896d5e3 Extracting   17.2MB/46.64MB
     c8784d631c66 Extracting  71.86MB/90.74MB
     7cba3896d5e3 Extracting  18.68MB/46.64MB
     c8784d631c66 Extracting  73.53MB/90.74MB
     7cba3896d5e3 Extracting  20.15MB/46.64MB
     c8784d631c66 Extracting  75.76MB/90.74MB
     df5835f957f7 Extracting  5.046MB/45.49MB
     7cba3896d5e3 Extracting  22.12MB/46.64MB
     c8784d631c66 Extracting  77.43MB/90.74MB
     c8784d631c66 Extracting  77.99MB/90.74MB
     7cba3896d5e3 Extracting  22.61MB/46.64MB
     df5835f957f7 Extracting  5.505MB/45.49MB
     7cba3896d5e3 Extracting  26.05MB/46.64MB
     c8784d631c66 Extracting  80.22MB/90.74MB
     7cba3896d5e3 Extracting  29.98MB/46.64MB
     c8784d631c66 Extracting  81.89MB/90.74MB
     df5835f957f7 Extracting  5.964MB/45.49MB
     7cba3896d5e3 Extracting   34.9MB/46.64MB
     c8784d631c66 Extracting  84.67MB/90.74MB
     7cba3896d5e3 Extracting  37.85MB/46.64MB
     c8784d631c66 Extracting   86.9MB/90.74MB
     df5835f957f7 Extracting  6.423MB/45.49MB
     7cba3896d5e3 Extracting  41.78MB/46.64MB
     c8784d631c66 Extracting  88.01MB/90.74MB
     df5835f957f7 Extracting   7.34MB/45.49MB
     7cba3896d5e3 Extracting  45.22MB/46.64MB
     c8784d631c66 Extracting  89.69MB/90.74MB
     df5835f957f7 Extracting  8.258MB/45.49MB
     7cba3896d5e3 Extracting  46.64MB/46.64MB
     7cba3896d5e3 Pull complete
     1979e9ba2ee4 Extracting     605B/605B
     1979e9ba2ee4 Pull complete
     0da5791e6e74 Extracting  2.675kB/2.675kB
     0da5791e6e74 Extracting  2.675kB/2.675kB
     df5835f957f7 Extracting  8.716MB/45.49MB
     0da5791e6e74 Pull complete
     f256c16a5607 Extracting  3.051kB/3.051kB
     f256c16a5607 Extracting  3.051kB/3.051kB
     f256c16a5607 Pull complete
     0e36311405c5 Extracting  4.019kB/4.019kB
     0e36311405c5 Extracting  4.019kB/4.019kB
     c8784d631c66 Extracting  90.74MB/90.74MB
     0e36311405c5 Pull complete
     deacc6707a51 Extracting  1.441kB/1.441kB
     deacc6707a51 Extracting  1.441kB/1.441kB
     deacc6707a51 Pull complete
     62c7872eeedd Extracting  32.77kB/138.3kB
     62c7872eeedd Extracting  138.3kB/138.3kB
     df5835f957f7 Extracting  9.634MB/45.49MB
     62c7872eeedd Pull complete
     6a5286f5f0ae Extracting     100B/100B
     6a5286f5f0ae Extracting     100B/100B
     6a5286f5f0ae Pull complete
     aaf7e836db0f Extracting     718B/718B
     aaf7e836db0f Extracting     718B/718B
     aaf7e836db0f Pull complete
     c8784d631c66 Pull complete
     516e02358a0a Extracting  9.199kB/9.199kB
     516e02358a0a Extracting  9.199kB/9.199kB
     prometheus Pulled
     df5835f957f7 Extracting  11.47MB/45.49MB
     516e02358a0a Pull complete
     f8a4c09a9d57 Extracting     128B/128B
     f8a4c09a9d57 Extracting     128B/128B
     f8a4c09a9d57 Pull complete
     d65e86d73fd5 Extracting     170B/170B
     d65e86d73fd5 Extracting     170B/170B
     d65e86d73fd5 Pull complete
     dd49384f9b90 Extracting  5.414kB/5.414kB
     dd49384f9b90 Extracting  5.414kB/5.414kB
     df5835f957f7 Extracting   13.3MB/45.49MB
     dd49384f9b90 Pull complete
     98c512a85a3e Extracting     183B/183B
     98c512a85a3e Extracting     183B/183B
     98c512a85a3e Pull complete
     db Pulled
     df5835f957f7 Extracting  15.14MB/45.49MB
     df5835f957f7 Extracting  17.43MB/45.49MB
     df5835f957f7 Extracting  20.64MB/45.49MB
     df5835f957f7 Extracting   23.4MB/45.49MB
     df5835f957f7 Extracting  26.15MB/45.49MB
     df5835f957f7 Extracting  27.98MB/45.49MB
     df5835f957f7 Extracting  30.74MB/45.49MB
     df5835f957f7 Extracting  34.41MB/45.49MB
     df5835f957f7 Extracting  36.24MB/45.49MB
     df5835f957f7 Extracting  38.99MB/45.49MB
     df5835f957f7 Extracting  40.83MB/45.49MB
     df5835f957f7 Extracting  42.66MB/45.49MB
     df5835f957f7 Extracting  44.96MB/45.49MB
     df5835f957f7 Extracting  45.49MB/45.49MB
     df5835f957f7 Pull complete
     b94284e881a5 Extracting  11.92kB/11.92kB
     b94284e881a5 Extracting  11.92kB/11.92kB
     b94284e881a5 Pull complete
     3e944d3294a3 Extracting  1.223kB/1.223kB
     3e944d3294a3 Extracting  1.223kB/1.223kB
     3e944d3294a3 Pull complete
     grafana Pulled
     Network app_monitoring-net  Creating
     Network app_monitoring-net  Created
     Volume "app_loki_data"  Creating
     Volume "app_loki_data"  Created
     Volume "app_db_data"  Creating
     Volume "app_db_data"  Created
     Volume "app_alertmanager_data"  Creating
     Volume "app_alertmanager_data"  Created
     Container loki  Creating
     Container node_exporter  Creating
     Container postgres_db  Creating
     Container alertmanager  Creating
     Container cadvisor_exporter  Creating
     Container prometheus  Creating
     Container cadvisor_exporter  Created
     Container loki  Created
     Container promtail  Creating
     Container node_exporter  Created
     Container alertmanager  Created
     Container postgres_db  Created
     Container web_app  Creating
     Container postgres_exporter  Creating
     Container prometheus  Created
     Container grafana  Creating
     Container promtail  Created
     Container grafana  Created
     Container postgres_exporter  Created
     Container web_app  Created
     Container node_exporter  Starting
     Container prometheus  Starting
     Container cadvisor_exporter  Starting
     Container loki  Starting
     Container postgres_db  Starting
     Container alertmanager  Starting
     Container loki  Started
     Container promtail  Starting
     Container alertmanager  Started
     Container node_exporter  Started
     Container cadvisor_exporter  Started
     Container postgres_db  Started
     Container promtail  Started
    Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting "/home/ec2-user/app/prometheus.yml" to rootfs at "/etc/prometheus/prometheus.yml": create mountpoint for /etc/prometheus/prometheus.yml mount: cannot create subdirectories in "/var/lib/docker/overlay2/b0aee1268a3a6d516f82bd91af5671e176a1d00db4717536ce9a6b3eff270874/merged/etc/prometheus/prometheus.yml": not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type
  stderr_lines: <omitted>
  stdout: |-
    #0 building with "default" instance using docker driver
  
    #1 [web internal] load build definition from Dockerfile
    #1 transferring dockerfile: 514B done
    #1 DONE 0.1s
  
    #2 [web internal] load metadata for docker.io/library/python:3.11-slim
    #2 DONE 1.4s
  
    #3 [web internal] load .dockerignore
    #3 transferring context: 2B done
    #3 DONE 0.0s
  
    #4 [web internal] load build context
    #4 transferring context: 16.14kB done
    #4 DONE 0.0s
  
    #5 [web 1/5] FROM docker.io/library/python:3.11-slim@sha256:e4676722fba839e2e5cdb844a52262b43e90e56dbd55b7ad953ee3615ad7534f
    #5 resolve docker.io/library/python:3.11-slim@sha256:e4676722fba839e2e5cdb844a52262b43e90e56dbd55b7ad953ee3615ad7534f 0.0s done
    #5 sha256:e4676722fba839e2e5cdb844a52262b43e90e56dbd55b7ad953ee3615ad7534f 10.37kB / 10.37kB done
    #5 sha256:b596083aa14d47c78a652138aa9b98607585499d7c7ec343ae378f6c5770822d 1.75kB / 1.75kB done
    #5 sha256:870925f757415a696459255b0a20b082e914cac42efaff4424b59e21bff80d5b 5.48kB / 5.48kB done
    #5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 0B / 29.78MB 0.1s
    #5 sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0B / 1.29MB 0.1s
    #5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 0B / 14.36MB 0.1s
    #5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 1.05MB / 14.36MB 0.3s
    #5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 24.12MB / 29.78MB 0.5s
    #5 sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 1.29MB / 1.29MB 0.4s done
    #5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 9.44MB / 14.36MB 0.5s
    #5 sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc 0B / 248B 0.5s
    #5 sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 29.78MB / 29.78MB 0.6s done
    #5 sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 14.36MB / 14.36MB 0.6s done
    #5 sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc 248B / 248B 0.6s done
    #5 extracting sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc
    #5 extracting sha256:d7ecded7702a5dbf6d0f79a71edc34b534d08f3051980e2c948fba72db3197fc 1.5s done
    #5 extracting sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0.1s
    #5 extracting sha256:1ee9c106547f05aa380c4cdec2837c546439943d73d965a3fc49f228dc8be993 0.1s done
    #5 extracting sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 0.1s
    #5 extracting sha256:f002d17b63fe84a7f8a66f20cfa63aec4f6cd2a44069f05b6296b0abfcf2a8e1 0.9s done
    #5 extracting sha256:65868b001a40155a1d3f5aa7f5a10ba02a7d55697301839dc047c9d549b670bc done
    #5 DONE 3.3s
  
    #6 [web 2/5] WORKDIR /app
    #6 DONE 0.1s
  
    #7 [web 3/5] COPY requirements.txt .
    #7 DONE 0.0s
  
    #8 [web 4/5] RUN pip install --no-cache-dir -r requirements.txt
    #8 2.311 Collecting Flask (from -r requirements.txt (line 1))
    #8 2.332   Downloading flask-3.1.2-py3-none-any.whl.metadata (3.2 kB)
    #8 2.421 Collecting psycopg2-binary (from -r requirements.txt (line 2))
    #8 2.426   Downloading psycopg2_binary-2.9.11-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (4.9 kB)
    #8 2.449 Collecting prometheus_flask_exporter (from -r requirements.txt (line 3))
    #8 2.458   Downloading prometheus_flask_exporter-0.23.2-py3-none-any.whl.metadata (20 kB)
    #8 2.484 Collecting blinker>=1.9.0 (from Flask->-r requirements.txt (line 1))
    #8 2.488   Downloading blinker-1.9.0-py3-none-any.whl.metadata (1.6 kB)
    #8 2.514 Collecting click>=8.1.3 (from Flask->-r requirements.txt (line 1))
    #8 2.517   Downloading click-8.3.0-py3-none-any.whl.metadata (2.6 kB)
    #8 2.537 Collecting itsdangerous>=2.2.0 (from Flask->-r requirements.txt (line 1))
    #8 2.541   Downloading itsdangerous-2.2.0-py3-none-any.whl.metadata (1.9 kB)
    #8 2.564 Collecting jinja2>=3.1.2 (from Flask->-r requirements.txt (line 1))
    #8 2.568   Downloading jinja2-3.1.6-py3-none-any.whl.metadata (2.9 kB)
    #8 2.634 Collecting markupsafe>=2.1.1 (from Flask->-r requirements.txt (line 1))
    #8 2.639   Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl.metadata (2.7 kB)
    #8 2.674 Collecting werkzeug>=3.1.0 (from Flask->-r requirements.txt (line 1))
    #8 2.678   Downloading werkzeug-3.1.3-py3-none-any.whl.metadata (3.7 kB)
    #8 2.705 Collecting prometheus_client (from prometheus_flask_exporter->-r requirements.txt (line 3))
    #8 2.708   Downloading prometheus_client-0.23.1-py3-none-any.whl.metadata (1.9 kB)
    #8 2.728 Downloading flask-3.1.2-py3-none-any.whl (103 kB)
    #8 2.733    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 103.3/103.3 kB 78.9 MB/s eta 0:00:00
    #8 2.738 Downloading psycopg2_binary-2.9.11-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (4.2 MB)
    #8 2.783    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 4.2/4.2 MB 97.2 MB/s eta 0:00:00
    #8 2.789 Downloading prometheus_flask_exporter-0.23.2-py3-none-any.whl (19 kB)
    #8 2.792 Downloading blinker-1.9.0-py3-none-any.whl (8.5 kB)
    #8 2.796 Downloading click-8.3.0-py3-none-any.whl (107 kB)
    #8 2.799    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 107.3/107.3 kB 239.2 MB/s eta 0:00:00
    #8 2.802 Downloading itsdangerous-2.2.0-py3-none-any.whl (16 kB)
    #8 2.810 Downloading jinja2-3.1.6-py3-none-any.whl (134 kB)
    #8 2.813    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 134.9/134.9 kB 333.1 MB/s eta 0:00:00
    #8 2.816 Downloading markupsafe-3.0.3-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.manylinux_2_28_x86_64.whl (22 kB)
    #8 2.820 Downloading werkzeug-3.1.3-py3-none-any.whl (224 kB)
    #8 2.823    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 224.5/224.5 kB 335.3 MB/s eta 0:00:00
    #8 2.828 Downloading prometheus_client-0.23.1-py3-none-any.whl (61 kB)
    #8 2.830    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 61.1/61.1 kB 288.2 MB/s eta 0:00:00
    #8 2.913 Installing collected packages: psycopg2-binary, prometheus_client, markupsafe, itsdangerous, click, blinker, werkzeug, jinja2, Flask, prometheus_flask_exporter
    #8 3.546 Successfully installed Flask-3.1.2 blinker-1.9.0 click-8.3.0 itsdangerous-2.2.0 jinja2-3.1.6 markupsafe-3.0.3 prometheus_client-0.23.1 prometheus_flask_exporter-0.23.2 psycopg2-binary-2.9.11 werkzeug-3.1.3
    #8 3.547 WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
    #8 3.624
    #8 3.624 [notice] A new release of pip is available: 24.0 -> 25.3
    #8 3.624 [notice] To update, run: pip install --upgrade pip
    #8 DONE 3.9s
  
    #9 [web 5/5] COPY . /app
    #9 DONE 0.1s
  
    #10 [web] exporting to image
    #10 exporting layers
    #10 exporting layers 0.3s done
    #10 writing image sha256:c3bf500012658f89da58c46725247ebcf31f31880b35ba5def52385189d50b0f done
    #10 naming to docker.io/library/myflaskapp:1.0.0 done
    #10 DONE 0.3s
  stdout_lines: <omitted>
2025-11-12 20:59:14,786 p=11567 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 20:59:14,786 p=11567 u=zubeq n=ansible | 52.59.210.211              : ok=13   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 21:00:25,757 p=11873 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 21:00:25,764 p=11873 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 21:00:34,901 p=11873 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 21:00:34,902 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:00:34,914 p=11873 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 21:00:40,348 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:00:40,356 p=11873 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 21:00:44,296 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:00:44,303 p=11873 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 21:00:47,431 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:00:47,441 p=11873 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 21:00:58,647 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:00:58,654 p=11873 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 21:01:30,033 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:01:30,039 p=11873 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 21:01:35,680 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:01:35,688 p=11873 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 21:01:42,945 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:01:42,952 p=11873 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 21:01:47,087 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:01:47,095 p=11873 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 21:01:48,928 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:01:48,934 p=11873 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 21:01:55,221 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:01:55,228 p=11873 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 21:02:00,520 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:02:00,529 p=11873 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 21:02:07,903 p=11873 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:02:07,910 p=11873 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 21:02:12,123 p=11873 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:01.351676'
  end: '2025-11-12 19:02:11.868713'
  msg: non-zero return code
  rc: 1
  start: '2025-11-12 19:02:10.517037'
  stderr: |2-
     Container alertmanager  Running
     Container postgres_db  Running
     Container cadvisor_exporter  Running
     Container node_exporter  Running
     Container loki  Starting
     Container prometheus  Starting
     Container web_app  Starting
     Container postgres_exporter  Starting
     Container loki  Started
     Container promtail  Starting
     Container promtail  Started
     Container web_app  Started
     Container postgres_exporter  Started
    Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting "/home/ec2-user/app/prometheus.yml" to rootfs at "/etc/prometheus/prometheus.yml": create mountpoint for /etc/prometheus/prometheus.yml mount: cannot create subdirectories in "/var/lib/docker/overlay2/b0aee1268a3a6d516f82bd91af5671e176a1d00db4717536ce9a6b3eff270874/merged/etc/prometheus/prometheus.yml": not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-12 21:02:12,124 p=11873 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 21:02:12,124 p=11873 u=zubeq n=ansible | 52.59.210.211              : ok=13   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 21:03:49,821 p=12077 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 21:03:49,828 p=12077 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 21:04:00,613 p=12077 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 21:04:00,613 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:04:00,626 p=12077 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 21:04:07,678 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:04:07,685 p=12077 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 21:04:20,047 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:04:20,053 p=12077 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 21:04:24,328 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:04:24,342 p=12077 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 21:04:27,710 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:04:27,718 p=12077 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 21:05:18,005 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:05:18,013 p=12077 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 21:05:26,157 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:05:26,165 p=12077 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 21:05:44,706 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:05:44,710 p=12077 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 21:06:00,975 p=12077 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:06:00,983 p=12077 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 21:06:11,076 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:06:11,082 p=12077 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 21:06:22,001 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:06:22,008 p=12077 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 21:06:26,813 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:06:26,823 p=12077 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 21:06:36,218 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:06:36,226 p=12077 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 21:06:44,351 p=12077 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:06:44,361 p=12077 u=zubeq n=ansible | TASK [app : Show docker-compose output] *****************************************************
2025-11-12 21:06:44,372 p=12077 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 21:06:44,377 p=12077 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] **********************************************
2025-11-12 21:06:44,387 p=12077 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-12 21:06:44,387 p=12077 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 21:06:44,387 p=12077 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-12 21:06:54,394 p=12077 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:06:54,402 p=12077 u=zubeq n=ansible | TASK [app : Check running containers] *******************************************************
2025-11-12 21:06:54,412 p=12077 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => 
  msg: 'template error while templating string: unexpected ''.''. String: docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}". unexpected ''.'''
2025-11-12 21:06:54,412 p=12077 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 21:06:54,413 p=12077 u=zubeq n=ansible | 52.59.210.211              : ok=15   changed=2    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2025-11-12 21:09:54,704 p=12314 u=zubeq n=ansible | Using /media/zubeq/ext4d4/gpt5/5 eto 6/ansible/ansible.cfg as config file
2025-11-12 21:09:54,864 p=12314 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 21:09:54,870 p=12314 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 21:10:30,872 p=12314 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 21:10:30,872 p=12314 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:10:30,886 p=12314 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 21:10:45,301 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  msg: Nothing to do
  rc: 0
  results: []
2025-11-12 21:10:45,309 p=12314 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 21:11:02,972 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  enabled: true
  name: docker
  state: started
  status:
    AccessSELinuxContext: system_u:object_r:container_unit_file_t:s0
    ActiveEnterTimestamp: Wed 2025-11-12 18:28:42 UTC
    ActiveEnterTimestampMonotonic: '860768323'
    ActiveExitTimestampMonotonic: '0'
    ActiveState: active
    After: systemd-journald.socket sysinit.target time-set.target basic.target firewalld.service containerd.service network-online.target docker.socket system.slice
    AllowIsolate: 'no'
    AssertResult: 'yes'
    AssertTimestamp: Wed 2025-11-12 18:28:41 UTC
    AssertTimestampMonotonic: '860024877'
    Before: shutdown.target multi-user.target
    BlockIOAccounting: 'no'
    BlockIOWeight: '[not set]'
    CPUAccounting: 'yes'
    CPUAffinityFromNUMA: 'no'
    CPUQuotaPerSecUSec: infinity
    CPUQuotaPeriodUSec: infinity
    CPUSchedulingPolicy: '0'
    CPUSchedulingPriority: '0'
    CPUSchedulingResetOnFork: 'no'
    CPUShares: '[not set]'
    CPUUsageNSec: '41741679000'
    CPUWeight: '[not set]'
    CacheDirectoryMode: '0755'
    CanFreeze: 'yes'
    CanIsolate: 'no'
    CanReload: 'yes'
    CanStart: 'yes'
    CanStop: 'yes'
    CapabilityBoundingSet: cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore
    CleanResult: success
    CollectMode: inactive
    ConditionResult: 'yes'
    ConditionTimestamp: Wed 2025-11-12 18:28:41 UTC
    ConditionTimestampMonotonic: '860024874'
    ConfigurationDirectoryMode: '0755'
    Conflicts: shutdown.target
    ControlGroup: /system.slice/docker.service
    ControlGroupId: '5618'
    ControlPID: '0'
    CoredumpFilter: '0x33'
    DefaultDependencies: 'yes'
    DefaultMemoryLow: '0'
    DefaultMemoryMin: '0'
    Delegate: 'yes'
    DelegateControllers: cpu cpuset io memory pids
    Description: Docker Application Container Engine
    DevicePolicy: auto
    Documentation: https://docs.docker.com
    DynamicUser: 'no'
    EffectiveCPUs: 0-1
    EffectiveMemoryNodes: '0'
    EnvironmentFiles: /run/docker/runtimes.env (ignore_errors=yes)
    ExecMainCode: '0'
    ExecMainExitTimestampMonotonic: '0'
    ExecMainPID: '24160'
    ExecMainStartTimestamp: Wed 2025-11-12 18:28:41 UTC
    ExecMainStartTimestampMonotonic: '860059123'
    ExecMainStatus: '0'
    ExecReload: '{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }'
    ExecReloadEx: '{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }'
    ExecStart: '{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock $OPTIONS $DOCKER_STORAGE_OPTIONS $DOCKER_ADD_RUNTIMES ; ignore_errors=no ; start_time=[Wed 2025-11-12 18:28:41 UTC] ; stop_time=[n/a] ; pid=24160 ; code=(null) ; status=0/0 }'
    ExecStartEx: '{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock $OPTIONS $DOCKER_STORAGE_OPTIONS $DOCKER_ADD_RUNTIMES ; flags= ; start_time=[Wed 2025-11-12 18:28:41 UTC] ; stop_time=[n/a] ; pid=24160 ; code=(null) ; status=0/0 }'
    ExecStartPre: '{ path=/usr/libexec/docker/docker-setup-runtimes.sh ; argv[]=/usr/libexec/docker/docker-setup-runtimes.sh ; ignore_errors=no ; start_time=[Wed 2025-11-12 18:28:41 UTC] ; stop_time=[Wed 2025-11-12 18:28:41 UTC] ; pid=24154 ; code=exited ; status=0 }'
    ExecStartPreEx: '{ path=/usr/libexec/docker/docker-setup-runtimes.sh ; argv[]=/usr/libexec/docker/docker-setup-runtimes.sh ; flags= ; start_time=[Wed 2025-11-12 18:28:41 UTC] ; stop_time=[Wed 2025-11-12 18:28:41 UTC] ; pid=24154 ; code=exited ; status=0 }'
    ExitType: main
    FailureAction: none
    FileDescriptorStoreMax: '0'
    FinalKillSignal: '9'
    FragmentPath: /usr/lib/systemd/system/docker.service
    FreezerState: running
    GID: '[not set]'
    GuessMainPID: 'yes'
    IOAccounting: 'no'
    IOReadBytes: '18446744073709551615'
    IOReadOperations: '18446744073709551615'
    IOSchedulingClass: '2'
    IOSchedulingPriority: '4'
    IOWeight: '[not set]'
    IOWriteBytes: '18446744073709551615'
    IOWriteOperations: '18446744073709551615'
    IPAccounting: 'no'
    IPEgressBytes: '[no data]'
    IPEgressPackets: '[no data]'
    IPIngressBytes: '[no data]'
    IPIngressPackets: '[no data]'
    Id: docker.service
    IgnoreOnIsolate: 'no'
    IgnoreSIGPIPE: 'yes'
    InactiveEnterTimestampMonotonic: '0'
    InactiveExitTimestamp: Wed 2025-11-12 18:28:41 UTC
    InactiveExitTimestampMonotonic: '860050554'
    InvocationID: f24fa54921e945d4ba804acb055f992e
    JobRunningTimeoutUSec: infinity
    JobTimeoutAction: none
    JobTimeoutUSec: infinity
    KeyringMode: private
    KillMode: process
    KillSignal: '15'
    LimitAS: infinity
    LimitASSoft: infinity
    LimitCORE: infinity
    LimitCORESoft: infinity
    LimitCPU: infinity
    LimitCPUSoft: infinity
    LimitDATA: infinity
    LimitDATASoft: infinity
    LimitFSIZE: infinity
    LimitFSIZESoft: infinity
    LimitLOCKS: infinity
    LimitLOCKSSoft: infinity
    LimitMEMLOCK: infinity
    LimitMEMLOCKSoft: infinity
    LimitMSGQUEUE: '819200'
    LimitMSGQUEUESoft: '819200'
    LimitNICE: '0'
    LimitNICESoft: '0'
    LimitNOFILE: infinity
    LimitNOFILESoft: infinity
    LimitNPROC: infinity
    LimitNPROCSoft: infinity
    LimitRSS: infinity
    LimitRSSSoft: infinity
    LimitRTPRIO: '0'
    LimitRTPRIOSoft: '0'
    LimitRTTIME: infinity
    LimitRTTIMESoft: infinity
    LimitSIGPENDING: '30446'
    LimitSIGPENDINGSoft: '30446'
    LimitSTACK: '10485760'
    LimitSTACKSoft: '10485760'
    LoadState: loaded
    LockPersonality: 'no'
    LogLevelMax: '-1'
    LogRateLimitBurst: '0'
    LogRateLimitIntervalUSec: '0'
    LogsDirectoryMode: '0755'
    MainPID: '24160'
    ManagedOOMMemoryPressure: auto
    ManagedOOMMemoryPressureLimit: '0'
    ManagedOOMPreference: none
    ManagedOOMSwap: auto
    MemoryAccounting: 'yes'
    MemoryAvailable: infinity
    MemoryCurrent: '102035456'
    MemoryDenyWriteExecute: 'no'
    MemoryHigh: infinity
    MemoryLimit: infinity
    MemoryLow: '0'
    MemoryMax: infinity
    MemoryMin: '0'
    MemorySwapMax: infinity
    MountAPIVFS: 'no'
    NFileDescriptorStore: '0'
    NRestarts: '0'
    NUMAPolicy: n/a
    Names: docker.service
    NeedDaemonReload: 'no'
    Nice: '0'
    NoNewPrivileges: 'no'
    NonBlocking: 'no'
    NotifyAccess: main
    OOMPolicy: continue
    OOMScoreAdjust: '-500'
    OnFailureJobMode: replace
    OnSuccessJobMode: fail
    Perpetual: 'no'
    PrivateDevices: 'no'
    PrivateIPC: 'no'
    PrivateMounts: 'no'
    PrivateNetwork: 'no'
    PrivateTmp: 'no'
    PrivateUsers: 'no'
    ProcSubset: all
    ProtectClock: 'no'
    ProtectControlGroups: 'no'
    ProtectHome: 'no'
    ProtectHostname: 'no'
    ProtectKernelLogs: 'no'
    ProtectKernelModules: 'no'
    ProtectKernelTunables: 'no'
    ProtectProc: default
    ProtectSystem: 'no'
    RefuseManualStart: 'no'
    RefuseManualStop: 'no'
    ReloadResult: success
    RemainAfterExit: 'no'
    RemoveIPC: 'no'
    Requires: docker.socket system.slice sysinit.target
    Restart: always
    RestartKillSignal: '15'
    RestartUSec: 2s
    RestrictNamespaces: 'no'
    RestrictRealtime: 'no'
    RestrictSUIDSGID: 'no'
    Result: success
    RootDirectoryStartOnly: 'no'
    RuntimeDirectoryMode: '0755'
    RuntimeDirectoryPreserve: 'no'
    RuntimeMaxUSec: infinity
    RuntimeRandomizedExtraUSec: '0'
    SameProcessGroup: 'no'
    SecureBits: '0'
    SendSIGHUP: 'no'
    SendSIGKILL: 'yes'
    Slice: system.slice
    StandardError: inherit
    StandardInput: 'null'
    StandardOutput: journal
    StartLimitAction: none
    StartLimitBurst: '3'
    StartLimitIntervalUSec: 1min
    StartupBlockIOWeight: '[not set]'
    StartupCPUShares: '[not set]'
    StartupCPUWeight: '[not set]'
    StartupIOWeight: '[not set]'
    StateChangeTimestamp: Wed 2025-11-12 18:28:42 UTC
    StateChangeTimestampMonotonic: '860768323'
    StateDirectoryMode: '0755'
    StatusErrno: '0'
    StopWhenUnneeded: 'no'
    SubState: running
    SuccessAction: none
    SyslogFacility: '3'
    SyslogLevel: '6'
    SyslogLevelPrefix: 'yes'
    SyslogPriority: '30'
    SystemCallErrorNumber: '2147483646'
    TTYReset: 'no'
    TTYVHangup: 'no'
    TTYVTDisallocate: 'no'
    TasksAccounting: 'yes'
    TasksCurrent: '149'
    TasksMax: infinity
    TimeoutAbortUSec: 1min 30s
    TimeoutCleanUSec: infinity
    TimeoutStartFailureMode: terminate
    TimeoutStartUSec: infinity
    TimeoutStopFailureMode: terminate
    TimeoutStopUSec: 1min 30s
    TimerSlackNSec: '50000'
    Transient: 'no'
    TriggeredBy: docker.socket
    Type: notify
    UID: '[not set]'
    UMask: '0022'
    UnitFilePreset: disabled
    UnitFileState: enabled
    UtmpMode: init
    WantedBy: multi-user.target
    Wants: containerd.service network-online.target
    WatchdogSignal: '6'
    WatchdogTimestampMonotonic: '0'
    WatchdogUSec: '0'
2025-11-12 21:11:02,978 p=12314 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 21:11:13,968 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  dest: /usr/local/bin/docker-compose
  elapsed: 0
  gid: 0
  group: root
  mode: '0755'
  msg: 'HTTP Error 304: Not Modified'
  owner: root
  secontext: system_u:object_r:container_runtime_exec_t:s0
  size: 61431093
  state: file
  status_code: 304
  uid: 0
  url: https://github.com/docker/compose/releases/download/v2.24.6/docker-compose-linux-x86_64
2025-11-12 21:11:13,980 p=12314 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 21:11:30,142 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  gid: 1000
  group: ec2-user
  mode: '0755'
  owner: ec2-user
  path: /home/ec2-user/app
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 16384
  state: directory
  uid: 1000
2025-11-12 21:11:30,150 p=12314 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 21:11:57,529 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  dest: /home/ec2-user/app/
  src: /media/zubeq/ext4d4/gpt5/5 eto 6/ansible/roles/app/files/app/
2025-11-12 21:11:57,536 p=12314 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 21:12:03,364 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: 641176014082c204b56a81b580a97bb966255dfb
  dest: /home/ec2-user/app/Dockerfile
  gid: 1000
  group: ec2-user
  mode: '0644'
  owner: ec2-user
  path: /home/ec2-user/app/Dockerfile
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 416
  state: file
  uid: 1000
2025-11-12 21:12:03,373 p=12314 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 21:12:12,548 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: 8ce3135365add8abb7016c316c096b0d94b984f8
  cmd: promtool check config /home/ec2-user/.ansible/tmp/ansible-tmp-1762974723.5084414-12429-122524745431476/source
  failed_when_result: false
  msg: '[Errno 2] No such file or directory: b''promtool'''
  rc: 2
  stderr: ''
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-12 21:12:12,554 p=12314 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 21:12:19,966 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: 232f4da21ee71626de2097628131cbc3b4cf24da
  dest: /home/ec2-user/app/docker-compose.yml
  gid: 1000
  group: ec2-user
  mode: '0644'
  owner: ec2-user
  path: /home/ec2-user/app/docker-compose.yml
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 5555
  state: file
  uid: 1000
2025-11-12 21:12:19,973 p=12314 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 21:12:23,629 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  gid: 1000
  group: ec2-user
  mode: '0755'
  owner: ec2-user
  path: /home/ec2-user/app/alertmanager
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 30
  state: directory
  uid: 1000
2025-11-12 21:12:23,637 p=12314 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 21:12:28,380 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: 4f6da102a9b1a81ff5fca7a4c9f388aacbf643da
  dest: /home/ec2-user/app/alertmanager/alertmanager.yml
  gid: 1000
  group: ec2-user
  mode: '0644'
  owner: ec2-user
  path: /home/ec2-user/app/alertmanager/alertmanager.yml
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 334
  state: file
  uid: 1000
2025-11-12 21:12:28,388 p=12314 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 21:12:31,159 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  gid: 1000
  group: ec2-user
  mode: '0755'
  owner: ec2-user
  path: /home/ec2-user/app/alerts
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 29
  state: directory
  uid: 1000
2025-11-12 21:12:31,168 p=12314 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 21:12:36,310 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: fb619e6a0e6a22c883ab88e7c8675dc0ba364842
  dest: /home/ec2-user/app/alerts/alert_rules.yml
  gid: 1000
  group: ec2-user
  mode: '0644'
  owner: ec2-user
  path: /home/ec2-user/app/alerts/alert_rules.yml
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 8016
  state: file
  uid: 1000
2025-11-12 21:12:36,317 p=12314 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 21:12:39,268 p=12314 u=zubeq n=ansible | changed: [52.59.210.211] => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.502424'
  end: '2025-11-12 19:12:39.084475'
  msg: ''
  rc: 0
  start: '2025-11-12 19:12:38.582051'
  stderr: |2-
     Container cadvisor_exporter  Running
     Container node_exporter  Running
     Container postgres_db  Running
     Container alertmanager  Running
     Container prometheus  Running
     Container postgres_exporter  Running
     Container web_app  Running
     Container grafana  Running
     Container loki  Starting
     Container loki  Started
     Container promtail  Starting
     Container promtail  Started
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-12 21:12:39,276 p=12314 u=zubeq n=ansible | TASK [app : Show docker-compose output] *****************************************************
2025-11-12 21:12:39,289 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => 
  compose_result:
    changed: true
    cmd:
    - docker-compose
    - up
    - -d
    delta: '0:00:00.502424'
    end: '2025-11-12 19:12:39.084475'
    failed: false
    msg: ''
    rc: 0
    start: '2025-11-12 19:12:38.582051'
    stderr: |2-
       Container cadvisor_exporter  Running
       Container node_exporter  Running
       Container postgres_db  Running
       Container alertmanager  Running
       Container prometheus  Running
       Container postgres_exporter  Running
       Container web_app  Running
       Container grafana  Running
       Container loki  Starting
       Container loki  Started
       Container promtail  Starting
       Container promtail  Started
    stderr_lines:
    - ' Container cadvisor_exporter  Running'
    - ' Container node_exporter  Running'
    - ' Container postgres_db  Running'
    - ' Container alertmanager  Running'
    - ' Container prometheus  Running'
    - ' Container postgres_exporter  Running'
    - ' Container web_app  Running'
    - ' Container grafana  Running'
    - ' Container loki  Starting'
    - ' Container loki  Started'
    - ' Container promtail  Starting'
    - ' Container promtail  Started'
    stdout: ''
    stdout_lines: []
2025-11-12 21:12:39,295 p=12314 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] **********************************************
2025-11-12 21:12:39,304 p=12314 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-12 21:12:39,305 p=12314 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 21:12:39,305 p=12314 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-12 21:12:49,313 p=12314 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  delta: 10
  echo: true
  rc: 0
  start: '2025-11-12 21:12:39.304350'
  stderr: ''
  stdout: Paused for 10.0 seconds
  stop: '2025-11-12 21:12:49.308582'
  user_input: ''
2025-11-12 21:12:49,322 p=12314 u=zubeq n=ansible | TASK [app : Check running containers] *******************************************************
2025-11-12 21:12:49,333 p=12314 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => 
  msg: 'template error while templating string: unexpected ''.''. String: docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}". unexpected ''.'''
2025-11-12 21:12:49,334 p=12314 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 21:12:49,334 p=12314 u=zubeq n=ansible | 52.59.210.211              : ok=16   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 21:14:51,073 p=12568 u=zubeq n=ansible | Using /media/zubeq/ext4d4/gpt5/5 eto 6/ansible/ansible.cfg as config file
2025-11-12 21:14:51,233 p=12568 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 21:14:51,240 p=12568 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 21:15:32,349 p=12568 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 21:15:32,350 p=12568 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:15:32,364 p=12568 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 21:15:58,244 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  msg: Nothing to do
  rc: 0
  results: []
2025-11-12 21:15:58,250 p=12568 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 21:16:27,580 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  enabled: true
  name: docker
  state: started
  status:
    AccessSELinuxContext: system_u:object_r:container_unit_file_t:s0
    ActiveEnterTimestamp: Wed 2025-11-12 18:28:42 UTC
    ActiveEnterTimestampMonotonic: '860768323'
    ActiveExitTimestampMonotonic: '0'
    ActiveState: active
    After: systemd-journald.socket sysinit.target time-set.target basic.target firewalld.service containerd.service network-online.target docker.socket system.slice
    AllowIsolate: 'no'
    AssertResult: 'yes'
    AssertTimestamp: Wed 2025-11-12 18:28:41 UTC
    AssertTimestampMonotonic: '860024877'
    Before: shutdown.target multi-user.target
    BlockIOAccounting: 'no'
    BlockIOWeight: '[not set]'
    CPUAccounting: 'yes'
    CPUAffinityFromNUMA: 'no'
    CPUQuotaPerSecUSec: infinity
    CPUQuotaPeriodUSec: infinity
    CPUSchedulingPolicy: '0'
    CPUSchedulingPriority: '0'
    CPUSchedulingResetOnFork: 'no'
    CPUShares: '[not set]'
    CPUUsageNSec: '43673065000'
    CPUWeight: '[not set]'
    CacheDirectoryMode: '0755'
    CanFreeze: 'yes'
    CanIsolate: 'no'
    CanReload: 'yes'
    CanStart: 'yes'
    CanStop: 'yes'
    CapabilityBoundingSet: cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore
    CleanResult: success
    CollectMode: inactive
    ConditionResult: 'yes'
    ConditionTimestamp: Wed 2025-11-12 18:28:41 UTC
    ConditionTimestampMonotonic: '860024874'
    ConfigurationDirectoryMode: '0755'
    Conflicts: shutdown.target
    ControlGroup: /system.slice/docker.service
    ControlGroupId: '5618'
    ControlPID: '0'
    CoredumpFilter: '0x33'
    DefaultDependencies: 'yes'
    DefaultMemoryLow: '0'
    DefaultMemoryMin: '0'
    Delegate: 'yes'
    DelegateControllers: cpu cpuset io memory pids
    Description: Docker Application Container Engine
    DevicePolicy: auto
    Documentation: https://docs.docker.com
    DynamicUser: 'no'
    EffectiveCPUs: 0-1
    EffectiveMemoryNodes: '0'
    EnvironmentFiles: /run/docker/runtimes.env (ignore_errors=yes)
    ExecMainCode: '0'
    ExecMainExitTimestampMonotonic: '0'
    ExecMainPID: '24160'
    ExecMainStartTimestamp: Wed 2025-11-12 18:28:41 UTC
    ExecMainStartTimestampMonotonic: '860059123'
    ExecMainStatus: '0'
    ExecReload: '{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }'
    ExecReloadEx: '{ path=/bin/kill ; argv[]=/bin/kill -s HUP $MAINPID ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }'
    ExecStart: '{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock $OPTIONS $DOCKER_STORAGE_OPTIONS $DOCKER_ADD_RUNTIMES ; ignore_errors=no ; start_time=[Wed 2025-11-12 18:28:41 UTC] ; stop_time=[n/a] ; pid=24160 ; code=(null) ; status=0/0 }'
    ExecStartEx: '{ path=/usr/bin/dockerd ; argv[]=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock $OPTIONS $DOCKER_STORAGE_OPTIONS $DOCKER_ADD_RUNTIMES ; flags= ; start_time=[Wed 2025-11-12 18:28:41 UTC] ; stop_time=[n/a] ; pid=24160 ; code=(null) ; status=0/0 }'
    ExecStartPre: '{ path=/usr/libexec/docker/docker-setup-runtimes.sh ; argv[]=/usr/libexec/docker/docker-setup-runtimes.sh ; ignore_errors=no ; start_time=[Wed 2025-11-12 18:28:41 UTC] ; stop_time=[Wed 2025-11-12 18:28:41 UTC] ; pid=24154 ; code=exited ; status=0 }'
    ExecStartPreEx: '{ path=/usr/libexec/docker/docker-setup-runtimes.sh ; argv[]=/usr/libexec/docker/docker-setup-runtimes.sh ; flags= ; start_time=[Wed 2025-11-12 18:28:41 UTC] ; stop_time=[Wed 2025-11-12 18:28:41 UTC] ; pid=24154 ; code=exited ; status=0 }'
    ExitType: main
    FailureAction: none
    FileDescriptorStoreMax: '0'
    FinalKillSignal: '9'
    FragmentPath: /usr/lib/systemd/system/docker.service
    FreezerState: running
    GID: '[not set]'
    GuessMainPID: 'yes'
    IOAccounting: 'no'
    IOReadBytes: '18446744073709551615'
    IOReadOperations: '18446744073709551615'
    IOSchedulingClass: '2'
    IOSchedulingPriority: '4'
    IOWeight: '[not set]'
    IOWriteBytes: '18446744073709551615'
    IOWriteOperations: '18446744073709551615'
    IPAccounting: 'no'
    IPEgressBytes: '[no data]'
    IPEgressPackets: '[no data]'
    IPIngressBytes: '[no data]'
    IPIngressPackets: '[no data]'
    Id: docker.service
    IgnoreOnIsolate: 'no'
    IgnoreSIGPIPE: 'yes'
    InactiveEnterTimestampMonotonic: '0'
    InactiveExitTimestamp: Wed 2025-11-12 18:28:41 UTC
    InactiveExitTimestampMonotonic: '860050554'
    InvocationID: f24fa54921e945d4ba804acb055f992e
    JobRunningTimeoutUSec: infinity
    JobTimeoutAction: none
    JobTimeoutUSec: infinity
    KeyringMode: private
    KillMode: process
    KillSignal: '15'
    LimitAS: infinity
    LimitASSoft: infinity
    LimitCORE: infinity
    LimitCORESoft: infinity
    LimitCPU: infinity
    LimitCPUSoft: infinity
    LimitDATA: infinity
    LimitDATASoft: infinity
    LimitFSIZE: infinity
    LimitFSIZESoft: infinity
    LimitLOCKS: infinity
    LimitLOCKSSoft: infinity
    LimitMEMLOCK: infinity
    LimitMEMLOCKSoft: infinity
    LimitMSGQUEUE: '819200'
    LimitMSGQUEUESoft: '819200'
    LimitNICE: '0'
    LimitNICESoft: '0'
    LimitNOFILE: infinity
    LimitNOFILESoft: infinity
    LimitNPROC: infinity
    LimitNPROCSoft: infinity
    LimitRSS: infinity
    LimitRSSSoft: infinity
    LimitRTPRIO: '0'
    LimitRTPRIOSoft: '0'
    LimitRTTIME: infinity
    LimitRTTIMESoft: infinity
    LimitSIGPENDING: '30446'
    LimitSIGPENDINGSoft: '30446'
    LimitSTACK: '10485760'
    LimitSTACKSoft: '10485760'
    LoadState: loaded
    LockPersonality: 'no'
    LogLevelMax: '-1'
    LogRateLimitBurst: '0'
    LogRateLimitIntervalUSec: '0'
    LogsDirectoryMode: '0755'
    MainPID: '24160'
    ManagedOOMMemoryPressure: auto
    ManagedOOMMemoryPressureLimit: '0'
    ManagedOOMPreference: none
    ManagedOOMSwap: auto
    MemoryAccounting: 'yes'
    MemoryAvailable: infinity
    MemoryCurrent: '104579072'
    MemoryDenyWriteExecute: 'no'
    MemoryHigh: infinity
    MemoryLimit: infinity
    MemoryLow: '0'
    MemoryMax: infinity
    MemoryMin: '0'
    MemorySwapMax: infinity
    MountAPIVFS: 'no'
    NFileDescriptorStore: '0'
    NRestarts: '0'
    NUMAPolicy: n/a
    Names: docker.service
    NeedDaemonReload: 'no'
    Nice: '0'
    NoNewPrivileges: 'no'
    NonBlocking: 'no'
    NotifyAccess: main
    OOMPolicy: continue
    OOMScoreAdjust: '-500'
    OnFailureJobMode: replace
    OnSuccessJobMode: fail
    Perpetual: 'no'
    PrivateDevices: 'no'
    PrivateIPC: 'no'
    PrivateMounts: 'no'
    PrivateNetwork: 'no'
    PrivateTmp: 'no'
    PrivateUsers: 'no'
    ProcSubset: all
    ProtectClock: 'no'
    ProtectControlGroups: 'no'
    ProtectHome: 'no'
    ProtectHostname: 'no'
    ProtectKernelLogs: 'no'
    ProtectKernelModules: 'no'
    ProtectKernelTunables: 'no'
    ProtectProc: default
    ProtectSystem: 'no'
    RefuseManualStart: 'no'
    RefuseManualStop: 'no'
    ReloadResult: success
    RemainAfterExit: 'no'
    RemoveIPC: 'no'
    Requires: docker.socket system.slice sysinit.target
    Restart: always
    RestartKillSignal: '15'
    RestartUSec: 2s
    RestrictNamespaces: 'no'
    RestrictRealtime: 'no'
    RestrictSUIDSGID: 'no'
    Result: success
    RootDirectoryStartOnly: 'no'
    RuntimeDirectoryMode: '0755'
    RuntimeDirectoryPreserve: 'no'
    RuntimeMaxUSec: infinity
    RuntimeRandomizedExtraUSec: '0'
    SameProcessGroup: 'no'
    SecureBits: '0'
    SendSIGHUP: 'no'
    SendSIGKILL: 'yes'
    Slice: system.slice
    StandardError: inherit
    StandardInput: 'null'
    StandardOutput: journal
    StartLimitAction: none
    StartLimitBurst: '3'
    StartLimitIntervalUSec: 1min
    StartupBlockIOWeight: '[not set]'
    StartupCPUShares: '[not set]'
    StartupCPUWeight: '[not set]'
    StartupIOWeight: '[not set]'
    StateChangeTimestamp: Wed 2025-11-12 18:28:42 UTC
    StateChangeTimestampMonotonic: '860768323'
    StateDirectoryMode: '0755'
    StatusErrno: '0'
    StopWhenUnneeded: 'no'
    SubState: running
    SuccessAction: none
    SyslogFacility: '3'
    SyslogLevel: '6'
    SyslogLevelPrefix: 'yes'
    SyslogPriority: '30'
    SystemCallErrorNumber: '2147483646'
    TTYReset: 'no'
    TTYVHangup: 'no'
    TTYVTDisallocate: 'no'
    TasksAccounting: 'yes'
    TasksCurrent: '157'
    TasksMax: infinity
    TimeoutAbortUSec: 1min 30s
    TimeoutCleanUSec: infinity
    TimeoutStartFailureMode: terminate
    TimeoutStartUSec: infinity
    TimeoutStopFailureMode: terminate
    TimeoutStopUSec: 1min 30s
    TimerSlackNSec: '50000'
    Transient: 'no'
    TriggeredBy: docker.socket
    Type: notify
    UID: '[not set]'
    UMask: '0022'
    UnitFilePreset: disabled
    UnitFileState: enabled
    UtmpMode: init
    WantedBy: multi-user.target
    Wants: containerd.service network-online.target
    WatchdogSignal: '6'
    WatchdogTimestampMonotonic: '0'
    WatchdogUSec: '0'
2025-11-12 21:16:27,586 p=12568 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 21:16:41,680 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  dest: /usr/local/bin/docker-compose
  elapsed: 0
  gid: 0
  group: root
  mode: '0755'
  msg: 'HTTP Error 304: Not Modified'
  owner: root
  secontext: system_u:object_r:container_runtime_exec_t:s0
  size: 61431093
  state: file
  status_code: 304
  uid: 0
  url: https://github.com/docker/compose/releases/download/v2.24.6/docker-compose-linux-x86_64
2025-11-12 21:16:41,692 p=12568 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 21:16:53,003 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  gid: 1000
  group: ec2-user
  mode: '0755'
  owner: ec2-user
  path: /home/ec2-user/app
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 16384
  state: directory
  uid: 1000
2025-11-12 21:16:53,012 p=12568 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 21:17:58,086 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  dest: /home/ec2-user/app/
  src: /media/zubeq/ext4d4/gpt5/5 eto 6/ansible/roles/app/files/app/
2025-11-12 21:17:58,094 p=12568 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 21:18:10,551 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: 641176014082c204b56a81b580a97bb966255dfb
  dest: /home/ec2-user/app/Dockerfile
  gid: 1000
  group: ec2-user
  mode: '0644'
  owner: ec2-user
  path: /home/ec2-user/app/Dockerfile
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 416
  state: file
  uid: 1000
2025-11-12 21:18:10,557 p=12568 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 21:18:49,530 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: 8ce3135365add8abb7016c316c096b0d94b984f8
  cmd: promtool check config /home/ec2-user/.ansible/tmp/ansible-tmp-1762975091.1413262-13151-177086805698054/source
  failed_when_result: false
  msg: '[Errno 2] No such file or directory: b''promtool'''
  rc: 2
  stderr: ''
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-12 21:18:49,537 p=12568 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 21:19:21,557 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: 232f4da21ee71626de2097628131cbc3b4cf24da
  dest: /home/ec2-user/app/docker-compose.yml
  gid: 1000
  group: ec2-user
  mode: '0644'
  owner: ec2-user
  path: /home/ec2-user/app/docker-compose.yml
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 5555
  state: file
  uid: 1000
2025-11-12 21:19:21,567 p=12568 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 21:19:34,008 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  gid: 1000
  group: ec2-user
  mode: '0755'
  owner: ec2-user
  path: /home/ec2-user/app/alertmanager
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 30
  state: directory
  uid: 1000
2025-11-12 21:19:34,016 p=12568 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 21:20:04,548 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: 4f6da102a9b1a81ff5fca7a4c9f388aacbf643da
  dest: /home/ec2-user/app/alertmanager/alertmanager.yml
  gid: 1000
  group: ec2-user
  mode: '0644'
  owner: ec2-user
  path: /home/ec2-user/app/alertmanager/alertmanager.yml
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 334
  state: file
  uid: 1000
2025-11-12 21:20:04,559 p=12568 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 21:20:13,421 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  gid: 1000
  group: ec2-user
  mode: '0755'
  owner: ec2-user
  path: /home/ec2-user/app/alerts
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 29
  state: directory
  uid: 1000
2025-11-12 21:20:13,429 p=12568 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 21:20:31,624 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  checksum: fb619e6a0e6a22c883ab88e7c8675dc0ba364842
  dest: /home/ec2-user/app/alerts/alert_rules.yml
  gid: 1000
  group: ec2-user
  mode: '0644'
  owner: ec2-user
  path: /home/ec2-user/app/alerts/alert_rules.yml
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 8016
  state: file
  uid: 1000
2025-11-12 21:20:31,631 p=12568 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 21:20:41,589 p=12568 u=zubeq n=ansible | changed: [52.59.210.211] => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.531266'
  end: '2025-11-12 19:20:40.735784'
  msg: ''
  rc: 0
  start: '2025-11-12 19:20:40.204518'
  stderr: |2-
     Container prometheus  Running
     Container node_exporter  Running
     Container alertmanager  Running
     Container postgres_db  Running
     Container postgres_exporter  Running
     Container grafana  Running
     Container web_app  Running
     Container cadvisor_exporter  Running
     Container loki  Starting
     Container loki  Started
     Container promtail  Starting
     Container promtail  Started
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-12 21:20:41,597 p=12568 u=zubeq n=ansible | TASK [app : Show docker-compose output] *****************************************************
2025-11-12 21:20:41,610 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => 
  compose_result:
    changed: true
    cmd:
    - docker-compose
    - up
    - -d
    delta: '0:00:00.531266'
    end: '2025-11-12 19:20:40.735784'
    failed: false
    msg: ''
    rc: 0
    start: '2025-11-12 19:20:40.204518'
    stderr: |2-
       Container prometheus  Running
       Container node_exporter  Running
       Container alertmanager  Running
       Container postgres_db  Running
       Container postgres_exporter  Running
       Container grafana  Running
       Container web_app  Running
       Container cadvisor_exporter  Running
       Container loki  Starting
       Container loki  Started
       Container promtail  Starting
       Container promtail  Started
    stderr_lines:
    - ' Container prometheus  Running'
    - ' Container node_exporter  Running'
    - ' Container alertmanager  Running'
    - ' Container postgres_db  Running'
    - ' Container postgres_exporter  Running'
    - ' Container grafana  Running'
    - ' Container web_app  Running'
    - ' Container cadvisor_exporter  Running'
    - ' Container loki  Starting'
    - ' Container loki  Started'
    - ' Container promtail  Starting'
    - ' Container promtail  Started'
    stdout: ''
    stdout_lines: []
2025-11-12 21:20:41,616 p=12568 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] **********************************************
2025-11-12 21:20:41,626 p=12568 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-12 21:20:41,626 p=12568 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 21:20:41,626 p=12568 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-12 21:20:51,634 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  delta: 10
  echo: true
  rc: 0
  start: '2025-11-12 21:20:41.625797'
  stderr: ''
  stdout: Paused for 10.0 seconds
  stop: '2025-11-12 21:20:51.629892'
  user_input: ''
2025-11-12 21:20:51,642 p=12568 u=zubeq n=ansible | TASK [app : Check running containers] *******************************************************
2025-11-12 21:21:09,815 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  cmd: docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
  delta: '0:00:00.216193'
  end: '2025-11-12 19:21:09.056357'
  msg: ''
  rc: 0
  start: '2025-11-12 19:21:08.840164'
  stderr: ''
  stderr_lines: <omitted>
  stdout: |-
    NAMES               STATUS                          PORTS
    grafana             Up 14 minutes (healthy)         0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
    prometheus          Up 14 minutes (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
    web_app             Up 18 minutes (healthy)         0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
    postgres_exporter   Up 18 minutes (healthy)         0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
    promtail            Restarting (1) 34 seconds ago
    postgres_db         Up 21 minutes (healthy)         0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
    node_exporter       Up 21 minutes (healthy)         0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
    alertmanager        Up 21 minutes (healthy)         0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
    loki                Restarting (1) 34 seconds ago
    cadvisor_exporter   Up 21 minutes (healthy)         0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
  stdout_lines: <omitted>
2025-11-12 21:21:09,825 p=12568 u=zubeq n=ansible | TASK [app : Show container status] **********************************************************
2025-11-12 21:21:09,838 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - NAMES               STATUS                          PORTS
  - grafana             Up 14 minutes (healthy)         0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - prometheus          Up 14 minutes (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - web_app             Up 18 minutes (healthy)         0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_exporter   Up 18 minutes (healthy)         0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 34 seconds ago   '
  - postgres_db         Up 21 minutes (healthy)         0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - node_exporter       Up 21 minutes (healthy)         0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - alertmanager        Up 21 minutes (healthy)         0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - 'loki                Restarting (1) 34 seconds ago   '
  - cadvisor_exporter   Up 21 minutes (healthy)         0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-12 21:21:09,846 p=12568 u=zubeq n=ansible | TASK [app : Check Flask application health] *************************************************
2025-11-12 21:21:26,453 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => changed=false 
  attempts: 1
  connection: close
  content_length: '75'
  content_type: text/html; charset=utf-8
  cookies: {}
  cookies_string: ''
  date: Wed, 12 Nov 2025 19:21:23 GMT
  elapsed: 0
  msg: OK (75 bytes)
  redirected: false
  server: Werkzeug/3.1.3 Python/3.11.14
  status: 200
  url: http://localhost:5000/
2025-11-12 21:21:26,458 p=12568 u=zubeq n=ansible | TASK [app : Show Flask health check result] *************************************************
2025-11-12 21:21:26,473 p=12568 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg: Flask application is UP ✅
2025-11-12 21:21:26,481 p=12568 u=zubeq n=ansible | TASK [backup : Create backup directory] *****************************************************
2025-11-12 21:21:40,962 p=12568 u=zubeq n=ansible | changed: [52.59.210.211] => changed=true 
  gid: 1000
  group: ec2-user
  mode: '0750'
  owner: ec2-user
  path: /home/ec2-user/backups
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 6
  state: directory
  uid: 1000
2025-11-12 21:21:40,971 p=12568 u=zubeq n=ansible | TASK [backup : Template backup script] ******************************************************
2025-11-12 21:22:04,799 p=12568 u=zubeq n=ansible | changed: [52.59.210.211] => changed=true 
  checksum: b93351687f88996b9474baad86d26f696511086e
  dest: /home/ec2-user/backup-postgres.sh
  gid: 1000
  group: ec2-user
  md5sum: db957c37cf067b6edfd704f04819fd98
  mode: '0750'
  owner: ec2-user
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 2258
  src: /home/ec2-user/.ansible/tmp/ansible-tmp-1762975302.6174176-13960-214721324814981/source
  state: file
  uid: 1000
2025-11-12 21:22:04,808 p=12568 u=zubeq n=ansible | TASK [backup : Template restore script] *****************************************************
2025-11-12 21:22:13,694 p=12568 u=zubeq n=ansible | changed: [52.59.210.211] => changed=true 
  checksum: 0d4d5ea11dcfd52dfa628723233591cd8b897935
  dest: /home/ec2-user/restore-postgres.sh
  gid: 1000
  group: ec2-user
  md5sum: ba80fbbdf4546e929996772e010fa783
  mode: '0750'
  owner: ec2-user
  secontext: unconfined_u:object_r:user_home_t:s0
  size: 2932
  src: /home/ec2-user/.ansible/tmp/ansible-tmp-1762975326.0097938-13997-189208695968783/source
  state: file
  uid: 1000
2025-11-12 21:22:13,702 p=12568 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *************************************************
2025-11-12 21:22:16,512 p=12568 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => changed=false 
  msg: 'Failed to find required executable "crontab" in paths: /usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/var/lib/snapd/snap/bin'
2025-11-12 21:22:16,513 p=12568 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 21:22:16,513 p=12568 u=zubeq n=ansible | 52.59.210.211              : ok=23   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 21:28:41,531 p=14150 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 21:28:41,538 p=14150 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 21:28:49,236 p=14150 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 21:28:49,236 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:28:49,251 p=14150 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 21:28:53,973 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:28:53,979 p=14150 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 21:28:57,706 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:28:57,714 p=14150 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 21:29:00,785 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:29:00,797 p=14150 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 21:29:03,308 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:29:03,316 p=14150 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 21:29:15,640 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:29:15,645 p=14150 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 21:29:19,453 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:29:19,461 p=14150 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 21:29:26,314 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:29:26,322 p=14150 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 21:29:31,274 p=14150 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:29:31,280 p=14150 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 21:29:33,690 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:29:33,701 p=14150 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 21:29:38,219 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:29:38,226 p=14150 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 21:29:40,817 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:29:40,824 p=14150 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 21:29:45,857 p=14150 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:29:45,864 p=14150 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 21:29:50,910 p=14150 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:02.646243'
  end: '2025-11-12 19:29:50.596972'
  msg: non-zero return code
  rc: 1
  start: '2025-11-12 19:29:47.950729'
  stderr: |2-
     Container postgres_db  Running
     Container prometheus  Recreate
     Container postgres_exporter  Running
     Container cadvisor_exporter  Running
     Container node_exporter  Running
     Container alertmanager  Running
     Container web_app  Running
     Container prometheus  Recreated
     Container grafana  Recreate
     Container grafana  Recreated
     Container prometheus  Starting
     Container loki  Starting
     Container loki  Started
     Container promtail  Starting
     Container promtail  Started
    Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting "/home/ec2-user/app/prometheus.yml" to rootfs at "/etc/prometheus/prometheus.yml": create mountpoint for /etc/prometheus/prometheus.yml mount: cannot create subdirectories in "/var/lib/docker/overlay2/f302de34b3116fa13aacf4428d409ca2d8d5ed01a9236eaae0b15aa857b414fc/merged/etc/prometheus/prometheus.yml": not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-12 21:29:50,912 p=14150 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 21:29:50,912 p=14150 u=zubeq n=ansible | 52.59.210.211              : ok=13   changed=1    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 21:42:28,363 p=14550 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 21:42:28,370 p=14550 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 21:42:37,648 p=14550 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 21:42:37,648 p=14550 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:42:37,661 p=14550 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 21:42:49,765 p=14550 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:42:49,773 p=14550 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 21:42:57,517 p=14550 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:42:57,524 p=14550 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 21:43:01,711 p=14550 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:43:01,722 p=14550 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 21:43:03,873 p=14550 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:43:03,881 p=14550 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 21:43:21,500 p=14550 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:43:21,506 p=14550 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 21:43:28,111 p=14550 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:43:28,119 p=14550 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 21:43:36,830 p=14550 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:43:36,837 p=14550 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 21:43:45,824 p=14550 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:43:45,831 p=14550 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 21:43:49,910 p=14550 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:43:49,916 p=14550 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 21:44:01,217 p=14550 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:44:01,224 p=14550 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 21:44:12,446 p=14550 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:44:12,455 p=14550 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 21:44:20,372 p=14550 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:44:20,380 p=14550 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 21:44:24,395 p=14550 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:00.979791'
  end: '2025-11-12 19:44:24.134503'
  msg: non-zero return code
  rc: 1
  start: '2025-11-12 19:44:23.154712'
  stderr: |2-
     Container postgres_db  Running
     Container postgres_exporter  Running
     Container node_exporter  Running
     Container web_app  Running
     Container cadvisor_exporter  Running
     Container alertmanager  Running
     Container loki  Starting
     Container prometheus  Starting
     Container loki  Started
     Container promtail  Starting
     Container promtail  Started
    Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting "/home/ec2-user/app/prometheus.yml" to rootfs at "/etc/prometheus/prometheus.yml": create mountpoint for /etc/prometheus/prometheus.yml mount: cannot create subdirectories in "/var/lib/docker/overlay2/f302de34b3116fa13aacf4428d409ca2d8d5ed01a9236eaae0b15aa857b414fc/merged/etc/prometheus/prometheus.yml": not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-12 21:44:24,396 p=14550 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 21:44:24,396 p=14550 u=zubeq n=ansible | 52.59.210.211              : ok=13   changed=7    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 21:53:29,443 p=14832 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 21:53:29,450 p=14832 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 21:53:36,006 p=14832 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 21:53:36,006 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:53:36,014 p=14832 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 21:53:40,857 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:53:40,865 p=14832 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 21:53:47,508 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:53:47,515 p=14832 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 21:53:53,261 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:53:53,273 p=14832 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 21:53:55,909 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:53:55,917 p=14832 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 21:54:31,179 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:54:31,185 p=14832 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 21:54:42,538 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:54:42,545 p=14832 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 21:55:08,947 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:55:08,951 p=14832 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 21:55:13,818 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:55:13,825 p=14832 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 21:55:16,850 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:55:16,857 p=14832 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 21:55:22,901 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:55:22,908 p=14832 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 21:55:26,313 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:55:26,321 p=14832 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 21:55:29,591 p=14832 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:55:29,598 p=14832 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 21:55:32,685 p=14832 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:01.006831'
  end: '2025-11-12 19:55:32.516885'
  msg: non-zero return code
  rc: 1
  start: '2025-11-12 19:55:31.510054'
  stderr: |2-
     Container postgres_db  Running
     Container postgres_exporter  Running
     Container node_exporter  Running
     Container cadvisor_exporter  Running
     Container web_app  Running
     Container alertmanager  Running
     Container prometheus  Starting
     Container loki  Starting
     Container loki  Started
     Container promtail  Starting
     Container promtail  Started
    Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting "/home/ec2-user/app/prometheus.yml" to rootfs at "/etc/prometheus/prometheus.yml": create mountpoint for /etc/prometheus/prometheus.yml mount: cannot create subdirectories in "/var/lib/docker/overlay2/f302de34b3116fa13aacf4428d409ca2d8d5ed01a9236eaae0b15aa857b414fc/merged/etc/prometheus/prometheus.yml": not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-12 21:55:32,686 p=14832 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 21:55:32,686 p=14832 u=zubeq n=ansible | 52.59.210.211              : ok=13   changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-12 21:58:06,022 p=15095 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 21:58:06,029 p=15095 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 21:58:11,911 p=15095 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 21:58:11,911 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:58:11,924 p=15095 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 21:58:17,519 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:58:17,526 p=15095 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 21:58:24,999 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:58:25,006 p=15095 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 21:58:28,107 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:58:28,116 p=15095 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 21:58:32,112 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:58:32,120 p=15095 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 21:58:58,200 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:58:58,208 p=15095 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 21:59:04,196 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:59:04,204 p=15095 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 21:59:09,533 p=15095 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:59:09,540 p=15095 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 21:59:14,791 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:59:14,797 p=15095 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 21:59:17,927 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:59:17,934 p=15095 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 21:59:23,227 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:59:23,233 p=15095 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 21:59:26,121 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:59:26,131 p=15095 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 21:59:31,428 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:59:31,435 p=15095 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 21:59:35,646 p=15095 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 21:59:35,653 p=15095 u=zubeq n=ansible | TASK [app : Show docker-compose output] *****************************************************
2025-11-12 21:59:35,664 p=15095 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 21:59:35,669 p=15095 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] **********************************************
2025-11-12 21:59:35,679 p=15095 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-12 21:59:35,679 p=15095 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 21:59:35,679 p=15095 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-12 21:59:45,686 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:59:45,692 p=15095 u=zubeq n=ansible | TASK [app : Check running containers] *******************************************************
2025-11-12 21:59:51,700 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:59:51,706 p=15095 u=zubeq n=ansible | TASK [app : Show container status] **********************************************************
2025-11-12 21:59:51,721 p=15095 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - NAMES               STATUS                             PORTS
  - 'grafana             Up 16 seconds (health: starting)   0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'prometheus          Up 16 seconds (health: starting)   0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - web_app             Up 57 minutes (healthy)            0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_exporter   Up 57 minutes (healthy)            0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 35 seconds ago      '
  - postgres_db         Up About an hour (healthy)         0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - node_exporter       Up About an hour (healthy)         0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - alertmanager        Up About an hour (healthy)         0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - 'loki                Restarting (1) 35 seconds ago      '
  - cadvisor_exporter   Up About an hour (healthy)         0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-12 21:59:51,725 p=15095 u=zubeq n=ansible | TASK [app : Check Flask application health] *************************************************
2025-11-12 21:59:56,318 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 21:59:56,322 p=15095 u=zubeq n=ansible | TASK [app : Show Flask health check result] *************************************************
2025-11-12 21:59:56,337 p=15095 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg: Flask application is UP ✅
2025-11-12 21:59:56,352 p=15095 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] *********************************
2025-11-12 22:00:07,331 p=15095 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:00:07,338 p=15095 u=zubeq n=ansible | TASK [backup : Create backup directory] *****************************************************
2025-11-12 22:00:09,894 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:00:09,902 p=15095 u=zubeq n=ansible | TASK [backup : Template backup script] ******************************************************
2025-11-12 22:00:14,550 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:00:14,557 p=15095 u=zubeq n=ansible | TASK [backup : Template restore script] *****************************************************
2025-11-12 22:00:22,211 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:00:22,218 p=15095 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *************************************************
2025-11-12 22:00:28,054 p=15095 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:00:28,061 p=15095 u=zubeq n=ansible | TASK [backup : Install AWS CLI for S3 backup (if enabled)] **********************************
2025-11-12 22:00:28,087 p=15095 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 22:00:28,092 p=15095 u=zubeq n=ansible | TASK [backup : Create initial test backup] **************************************************
2025-11-12 22:00:33,618 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:00:33,623 p=15095 u=zubeq n=ansible | TASK [backup : Show backup result] **********************************************************
2025-11-12 22:00:33,661 p=15095 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - '[2025-11-12 20:00:33] ========================================='
  - '[2025-11-12 20:00:33] Starting PostgreSQL backup'
  - '[2025-11-12 20:00:33] ========================================='
  - '[2025-11-12 20:00:33] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-12 22:00:33,664 p=15095 u=zubeq n=ansible | TASK [backup : List created backups] ********************************************************
2025-11-12 22:00:39,315 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:00:39,322 p=15095 u=zubeq n=ansible | TASK [backup : Show backup files info] ******************************************************
2025-11-12 22:00:39,353 p=15095 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 2:00'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-12 22:00:39,370 p=15095 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] ****************************************
2025-11-12 22:00:45,492 p=15095 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:00:45,500 p=15095 u=zubeq n=ansible | TASK [Wait for services to start] ***********************************************************
2025-11-12 22:00:45,510 p=15095 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-12 22:00:45,510 p=15095 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 22:00:45,510 p=15095 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-12 22:01:15,516 p=15095 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:01:15,525 p=15095 u=zubeq n=ansible | TASK [Check running containers] *************************************************************
2025-11-12 22:01:15,535 p=15095 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => 
  msg: 'template error while templating string: unexpected ''.''. String: docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}". unexpected ''.'''
2025-11-12 22:01:15,536 p=15095 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 22:01:15,536 p=15095 u=zubeq n=ansible | 52.59.210.211              : ok=30   changed=5    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2025-11-12 22:03:33,801 p=15436 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 22:03:33,808 p=15436 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 22:03:39,903 p=15436 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 22:03:39,903 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:03:39,917 p=15436 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 22:03:44,874 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:03:44,882 p=15436 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 22:03:50,262 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:03:50,269 p=15436 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 22:03:52,604 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:03:52,616 p=15436 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 22:03:54,987 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:03:54,994 p=15436 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 22:04:37,894 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:04:37,901 p=15436 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 22:04:44,094 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:04:44,102 p=15436 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 22:04:48,174 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:04:48,181 p=15436 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 22:04:52,468 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:04:52,475 p=15436 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 22:04:55,097 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:04:55,105 p=15436 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 22:04:59,799 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:04:59,808 p=15436 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 22:05:03,077 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:05:03,086 p=15436 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 22:05:11,314 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:05:11,321 p=15436 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 22:05:18,350 p=15436 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:05:18,357 p=15436 u=zubeq n=ansible | TASK [app : Show docker-compose output] *****************************************************
2025-11-12 22:05:18,368 p=15436 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 22:05:18,372 p=15436 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] **********************************************
2025-11-12 22:05:18,382 p=15436 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-12 22:05:18,382 p=15436 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 22:05:18,382 p=15436 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-12 22:05:28,388 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:05:28,397 p=15436 u=zubeq n=ansible | TASK [app : Check running containers] *******************************************************
2025-11-12 22:05:32,757 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:05:32,764 p=15436 u=zubeq n=ansible | TASK [app : Show container status] **********************************************************
2025-11-12 22:05:32,778 p=15436 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - NAMES               STATUS                         PORTS
  - grafana             Up 5 minutes (healthy)         0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - prometheus          Up 4 minutes (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - web_app             Up About an hour (healthy)     0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_exporter   Up About an hour (healthy)     0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 3 seconds ago   '
  - postgres_db         Up About an hour (healthy)     0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - node_exporter       Up About an hour (healthy)     0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - alertmanager        Up About an hour (healthy)     0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - 'loki                Restarting (1) 3 seconds ago   '
  - cadvisor_exporter   Up About an hour (healthy)     0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-12 22:05:32,784 p=15436 u=zubeq n=ansible | TASK [app : Check Flask application health] *************************************************
2025-11-12 22:05:40,599 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:05:40,603 p=15436 u=zubeq n=ansible | TASK [app : Show Flask health check result] *************************************************
2025-11-12 22:05:40,617 p=15436 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg: Flask application is UP ✅
2025-11-12 22:05:40,626 p=15436 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] *********************************
2025-11-12 22:05:47,564 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:05:47,573 p=15436 u=zubeq n=ansible | TASK [backup : Create backup directory] *****************************************************
2025-11-12 22:05:52,367 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:05:52,378 p=15436 u=zubeq n=ansible | TASK [backup : Template backup script] ******************************************************
2025-11-12 22:06:00,212 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:06:00,220 p=15436 u=zubeq n=ansible | TASK [backup : Template restore script] *****************************************************
2025-11-12 22:06:14,692 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:06:14,701 p=15436 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *************************************************
2025-11-12 22:06:21,439 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:06:21,447 p=15436 u=zubeq n=ansible | TASK [backup : Install AWS CLI for S3 backup (if enabled)] **********************************
2025-11-12 22:06:21,473 p=15436 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 22:06:21,479 p=15436 u=zubeq n=ansible | TASK [backup : Create initial test backup] **************************************************
2025-11-12 22:06:29,172 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:06:29,179 p=15436 u=zubeq n=ansible | TASK [backup : Show backup result] **********************************************************
2025-11-12 22:06:29,211 p=15436 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - '[2025-11-12 20:06:28] ========================================='
  - '[2025-11-12 20:06:28] Starting PostgreSQL backup'
  - '[2025-11-12 20:06:28] ========================================='
  - '[2025-11-12 20:06:28] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-12 22:06:29,217 p=15436 u=zubeq n=ansible | TASK [backup : List created backups] ********************************************************
2025-11-12 22:06:34,401 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:06:34,408 p=15436 u=zubeq n=ansible | TASK [backup : Show backup files info] ******************************************************
2025-11-12 22:06:34,439 p=15436 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 2:00'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-12 22:06:34,459 p=15436 u=zubeq n=ansible | TASK [Wait for services to start] ***********************************************************
2025-11-12 22:06:34,470 p=15436 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-12 22:06:34,470 p=15436 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 22:06:34,470 p=15436 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-12 22:07:04,476 p=15436 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:07:04,483 p=15436 u=zubeq n=ansible | TASK [Check running containers] *************************************************************
2025-11-12 22:07:04,494 p=15436 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => 
  msg: 'template error while templating string: unexpected ''.''. String: docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}". unexpected ''.'''
2025-11-12 22:07:04,494 p=15436 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 22:07:04,494 p=15436 u=zubeq n=ansible | 52.59.210.211              : ok=29   changed=1    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2025-11-12 22:11:07,054 p=15939 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 22:11:07,061 p=15939 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 22:11:14,503 p=15939 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 22:11:14,503 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:11:14,517 p=15939 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 22:11:19,854 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:11:19,859 p=15939 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 22:11:26,714 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:11:26,721 p=15939 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 22:11:30,420 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:11:30,431 p=15939 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 22:11:33,115 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:11:33,122 p=15939 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 22:11:47,788 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:11:47,796 p=15939 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 22:11:52,387 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:11:52,394 p=15939 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 22:11:56,939 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:11:56,946 p=15939 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 22:12:00,656 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:00,663 p=15939 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 22:12:03,530 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:03,539 p=15939 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 22:12:07,298 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:07,307 p=15939 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 22:12:09,384 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:09,394 p=15939 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 22:12:14,698 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:14,707 p=15939 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 22:12:17,748 p=15939 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:12:17,755 p=15939 u=zubeq n=ansible | TASK [app : Show docker-compose output] *****************************************************
2025-11-12 22:12:17,766 p=15939 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 22:12:17,772 p=15939 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] **********************************************
2025-11-12 22:12:17,782 p=15939 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-12 22:12:17,782 p=15939 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 22:12:17,783 p=15939 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-12 22:12:27,791 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:27,798 p=15939 u=zubeq n=ansible | TASK [app : Check running containers] *******************************************************
2025-11-12 22:12:30,638 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:30,648 p=15939 u=zubeq n=ansible | TASK [app : Show container status] **********************************************************
2025-11-12 22:12:30,663 p=15939 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - NAMES               STATUS                          PORTS
  - grafana             Up 12 minutes (healthy)         0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - prometheus          Up 11 minutes (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - web_app             Up About an hour (healthy)      0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_exporter   Up About an hour (healthy)      0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 48 seconds ago   '
  - postgres_db         Up About an hour (healthy)      0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - node_exporter       Up About an hour (healthy)      0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - alertmanager        Up About an hour (healthy)      0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - 'loki                Restarting (1) 48 seconds ago   '
  - cadvisor_exporter   Up About an hour (healthy)      0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-12 22:12:30,669 p=15939 u=zubeq n=ansible | TASK [app : Check Flask application health] *************************************************
2025-11-12 22:12:33,601 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:33,606 p=15939 u=zubeq n=ansible | TASK [app : Show Flask health check result] *************************************************
2025-11-12 22:12:33,623 p=15939 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg: Flask application is UP ✅
2025-11-12 22:12:33,633 p=15939 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] *********************************
2025-11-12 22:12:37,778 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:37,789 p=15939 u=zubeq n=ansible | TASK [backup : Create backup directory] *****************************************************
2025-11-12 22:12:41,256 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:41,264 p=15939 u=zubeq n=ansible | TASK [backup : Template backup script] ******************************************************
2025-11-12 22:12:47,416 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:47,424 p=15939 u=zubeq n=ansible | TASK [backup : Template restore script] *****************************************************
2025-11-12 22:12:52,244 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:52,251 p=15939 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *************************************************
2025-11-12 22:12:55,085 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:55,095 p=15939 u=zubeq n=ansible | TASK [backup : Install AWS CLI for S3 backup (if enabled)] **********************************
2025-11-12 22:12:55,123 p=15939 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 22:12:55,129 p=15939 u=zubeq n=ansible | TASK [backup : Create initial test backup] **************************************************
2025-11-12 22:12:57,907 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:12:57,914 p=15939 u=zubeq n=ansible | TASK [backup : Show backup result] **********************************************************
2025-11-12 22:12:57,947 p=15939 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - '[2025-11-12 20:12:57] ========================================='
  - '[2025-11-12 20:12:57] Starting PostgreSQL backup'
  - '[2025-11-12 20:12:57] ========================================='
  - '[2025-11-12 20:12:57] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-12 22:12:57,952 p=15939 u=zubeq n=ansible | TASK [backup : List created backups] ********************************************************
2025-11-12 22:13:00,714 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:13:00,722 p=15939 u=zubeq n=ansible | TASK [backup : Show backup files info] ******************************************************
2025-11-12 22:13:00,754 p=15939 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 2:00'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-12 22:13:00,773 p=15939 u=zubeq n=ansible | TASK [Wait for services to start] ***********************************************************
2025-11-12 22:13:00,783 p=15939 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-12 22:13:00,784 p=15939 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 22:13:00,784 p=15939 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-12 22:13:30,791 p=15939 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:13:30,800 p=15939 u=zubeq n=ansible | TASK [Check running containers] *************************************************************
2025-11-12 22:13:30,810 p=15939 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => 
  msg: 'template error while templating string: unexpected ''.''. String: docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}". unexpected ''.'''
2025-11-12 22:13:30,810 p=15939 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 22:13:30,810 p=15939 u=zubeq n=ansible | 52.59.210.211              : ok=29   changed=1    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2025-11-12 22:20:40,297 p=16365 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 22:20:40,304 p=16365 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 22:20:47,790 p=16365 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 22:20:47,791 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:20:47,805 p=16365 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 22:20:56,143 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:20:56,151 p=16365 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 22:21:03,371 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:03,377 p=16365 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 22:21:10,557 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:10,569 p=16365 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 22:21:13,671 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:13,679 p=16365 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 22:21:30,334 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:30,341 p=16365 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 22:21:35,923 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:35,932 p=16365 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 22:21:41,832 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:41,841 p=16365 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 22:21:46,204 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:46,213 p=16365 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 22:21:48,713 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:48,722 p=16365 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 22:21:53,288 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:53,297 p=16365 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 22:21:56,015 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:21:56,022 p=16365 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 22:22:02,749 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:22:02,755 p=16365 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 22:22:08,239 p=16365 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:22:08,247 p=16365 u=zubeq n=ansible | TASK [app : Show docker-compose output] *****************************************************
2025-11-12 22:22:08,258 p=16365 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 22:22:08,264 p=16365 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] **********************************************
2025-11-12 22:22:08,274 p=16365 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-12 22:22:08,274 p=16365 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 22:22:08,274 p=16365 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-12 22:22:18,281 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:22:18,291 p=16365 u=zubeq n=ansible | TASK [app : Check running containers] *******************************************************
2025-11-12 22:22:22,983 p=16365 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:22:22,991 p=16365 u=zubeq n=ansible | TASK [app : Show container status] **********************************************************
2025-11-12 22:22:23,004 p=16365 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - NAMES               STATUS                          PORTS
  - grafana             Up 22 minutes (healthy)         0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - prometheus          Up 21 minutes (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - web_app             Up About an hour (healthy)      0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_exporter   Up About an hour (healthy)      0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 19 seconds ago   '
  - postgres_db         Up About an hour (healthy)      0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - node_exporter       Up About an hour (healthy)      0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - alertmanager        Up About an hour (healthy)      0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - 'loki                Restarting (1) 19 seconds ago   '
  - cadvisor_exporter   Up About an hour (healthy)      0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-12 22:22:23,010 p=16365 u=zubeq n=ansible | TASK [app : Check Flask application health] *************************************************
2025-11-12 22:22:26,551 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:22:26,559 p=16365 u=zubeq n=ansible | TASK [app : Show Flask health check result] *************************************************
2025-11-12 22:22:26,572 p=16365 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg: Flask application is UP ✅
2025-11-12 22:22:26,586 p=16365 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] *********************************
2025-11-12 22:22:35,490 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:22:35,499 p=16365 u=zubeq n=ansible | TASK [backup : Create backup directory] *****************************************************
2025-11-12 22:22:43,424 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:22:43,431 p=16365 u=zubeq n=ansible | TASK [backup : Template backup script] ******************************************************
2025-11-12 22:22:53,846 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:22:53,852 p=16365 u=zubeq n=ansible | TASK [backup : Template restore script] *****************************************************
2025-11-12 22:23:00,029 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:23:00,038 p=16365 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *************************************************
2025-11-12 22:23:04,173 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:23:04,181 p=16365 u=zubeq n=ansible | TASK [backup : Install AWS CLI for S3 backup (if enabled)] **********************************
2025-11-12 22:23:04,207 p=16365 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 22:23:04,212 p=16365 u=zubeq n=ansible | TASK [backup : Create initial test backup] **************************************************
2025-11-12 22:23:08,073 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:23:08,081 p=16365 u=zubeq n=ansible | TASK [backup : Show backup result] **********************************************************
2025-11-12 22:23:08,113 p=16365 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - '[2025-11-12 20:23:07] ========================================='
  - '[2025-11-12 20:23:07] Starting PostgreSQL backup'
  - '[2025-11-12 20:23:07] ========================================='
  - '[2025-11-12 20:23:07] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-12 22:23:08,118 p=16365 u=zubeq n=ansible | TASK [backup : List created backups] ********************************************************
2025-11-12 22:23:11,741 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:23:11,748 p=16365 u=zubeq n=ansible | TASK [backup : Show backup files info] ******************************************************
2025-11-12 22:23:11,780 p=16365 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 2:00'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-12 22:23:11,800 p=16365 u=zubeq n=ansible | TASK [Wait for services to start] ***********************************************************
2025-11-12 22:23:11,809 p=16365 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-12 22:23:11,810 p=16365 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 22:23:11,810 p=16365 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-12 22:23:41,816 p=16365 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:23:41,823 p=16365 u=zubeq n=ansible | TASK [Check running containers] *************************************************************
2025-11-12 22:23:41,834 p=16365 u=zubeq n=ansible | fatal: [52.59.210.211]: FAILED! => 
  msg: 'template error while templating string: unexpected ''.''. String: docker ps --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}". unexpected ''.'''
2025-11-12 22:23:41,835 p=16365 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 22:23:41,835 p=16365 u=zubeq n=ansible | 52.59.210.211              : ok=29   changed=2    unreachable=0    failed=1    skipped=2    rescued=0    ignored=0   
2025-11-12 22:31:31,569 p=16743 u=zubeq n=ansible | ERROR! We were unable to read either as JSON nor YAML, these are the errors we got from each:
JSON: Expecting value: line 1 column 1 (char 0)

Syntax Error while loading YAML.
  mapping values are not allowed in this context

The error appears to be in '/media/zubeq/ext4d4/gpt5/5 eto 6/ansible/playbooks/deploy_app.yml': line 22, column 31, but may
be elsewhere in the file depending on the exact syntax problem.

The offending line appears to be:

    - name: Check running containers
       ansible.builtin.command: >
                              ^ here

2025-11-12 22:32:08,762 p=16756 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ****************************
2025-11-12 22:32:08,769 p=16756 u=zubeq n=ansible | TASK [Gathering Facts] **********************************************************************
2025-11-12 22:32:14,032 p=16756 u=zubeq n=ansible | [WARNING]: Platform linux on host 52.59.210.211 is using the discovered Python interpreter
at /usr/bin/python3.9, but future installation of another Python interpreter could change
the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-12 22:32:14,032 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:14,046 p=16756 u=zubeq n=ansible | TASK [docker : Install Docker engine] *******************************************************
2025-11-12 22:32:17,958 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:17,965 p=16756 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] *********************************************
2025-11-12 22:32:21,424 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:21,431 p=16756 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] **********************************
2025-11-12 22:32:25,229 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:25,241 p=16756 u=zubeq n=ansible | TASK [app : Create application directory] ***************************************************
2025-11-12 22:32:27,967 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:27,974 p=16756 u=zubeq n=ansible | TASK [app : Copy Flask app files] ***********************************************************
2025-11-12 22:32:43,139 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:43,145 p=16756 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ****************************************************************
2025-11-12 22:32:48,660 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:48,669 p=16756 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ********************************************************
2025-11-12 22:32:53,460 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:53,466 p=16756 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ****************************************************
2025-11-12 22:32:57,610 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:57,618 p=16756 u=zubeq n=ansible | TASK [app : Create alertmanager directory] **************************************************
2025-11-12 22:32:59,968 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:32:59,974 p=16756 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ******************************************************
2025-11-12 22:33:04,935 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:04,943 p=16756 u=zubeq n=ansible | TASK [app : Create alerts directory] ********************************************************
2025-11-12 22:33:07,454 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:07,460 p=16756 u=zubeq n=ansible | TASK [app : Template alert rules] ***********************************************************
2025-11-12 22:33:12,106 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:12,114 p=16756 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *****************************************************
2025-11-12 22:33:16,364 p=16756 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:33:16,371 p=16756 u=zubeq n=ansible | TASK [app : Show docker-compose output] *****************************************************
2025-11-12 22:33:16,382 p=16756 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 22:33:16,388 p=16756 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] **********************************************
2025-11-12 22:33:16,397 p=16756 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-12 22:33:16,398 p=16756 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 22:33:16,398 p=16756 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-12 22:33:26,405 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:26,412 p=16756 u=zubeq n=ansible | TASK [app : Check running containers] *******************************************************
2025-11-12 22:33:29,268 p=16756 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:33:29,275 p=16756 u=zubeq n=ansible | TASK [app : Show container status] **********************************************************
2025-11-12 22:33:29,289 p=16756 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - NAMES               STATUS                         PORTS
  - grafana             Up 33 minutes (healthy)        0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - prometheus          Up 32 minutes (healthy)        0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - web_app             Up 2 hours (healthy)           0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_exporter   Up 2 hours (healthy)           0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 2 seconds ago   '
  - postgres_db         Up 2 hours (healthy)           0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - node_exporter       Up 2 hours (healthy)           0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - alertmanager        Up 2 hours (healthy)           0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - 'loki                Restarting (1) 1 second ago    '
  - cadvisor_exporter   Up 2 hours (healthy)           0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-12 22:33:29,294 p=16756 u=zubeq n=ansible | TASK [app : Check Flask application health] *************************************************
2025-11-12 22:33:32,800 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:32,809 p=16756 u=zubeq n=ansible | TASK [app : Show Flask health check result] *************************************************
2025-11-12 22:33:32,822 p=16756 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg: Flask application is UP ✅
2025-11-12 22:33:32,836 p=16756 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] *********************************
2025-11-12 22:33:37,837 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:37,846 p=16756 u=zubeq n=ansible | TASK [backup : Create backup directory] *****************************************************
2025-11-12 22:33:40,484 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:40,492 p=16756 u=zubeq n=ansible | TASK [backup : Template backup script] ******************************************************
2025-11-12 22:33:45,257 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:45,266 p=16756 u=zubeq n=ansible | TASK [backup : Template restore script] *****************************************************
2025-11-12 22:33:50,256 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:50,261 p=16756 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *************************************************
2025-11-12 22:33:52,659 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:52,666 p=16756 u=zubeq n=ansible | TASK [backup : Install AWS CLI for S3 backup (if enabled)] **********************************
2025-11-12 22:33:52,693 p=16756 u=zubeq n=ansible | skipping: [52.59.210.211]
2025-11-12 22:33:52,698 p=16756 u=zubeq n=ansible | TASK [backup : Create initial test backup] **************************************************
2025-11-12 22:33:55,106 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:55,114 p=16756 u=zubeq n=ansible | TASK [backup : Show backup result] **********************************************************
2025-11-12 22:33:55,145 p=16756 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - '[2025-11-12 20:33:54] ========================================='
  - '[2025-11-12 20:33:54] Starting PostgreSQL backup'
  - '[2025-11-12 20:33:54] ========================================='
  - '[2025-11-12 20:33:54] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-12 22:33:55,151 p=16756 u=zubeq n=ansible | TASK [backup : List created backups] ********************************************************
2025-11-12 22:33:57,929 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:33:57,936 p=16756 u=zubeq n=ansible | TASK [backup : Show backup files info] ******************************************************
2025-11-12 22:33:57,967 p=16756 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 2:00'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-12 22:33:57,987 p=16756 u=zubeq n=ansible | TASK [Wait for services to start] ***********************************************************
2025-11-12 22:33:57,997 p=16756 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-12 22:33:57,997 p=16756 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-12 22:33:57,997 p=16756 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-12 22:34:28,004 p=16756 u=zubeq n=ansible | ok: [52.59.210.211]
2025-11-12 22:34:28,011 p=16756 u=zubeq n=ansible | TASK [Check running containers] *************************************************************
2025-11-12 22:34:31,004 p=16756 u=zubeq n=ansible | changed: [52.59.210.211]
2025-11-12 22:34:31,010 p=16756 u=zubeq n=ansible | TASK [Show container status] ****************************************************************
2025-11-12 22:34:31,022 p=16756 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - NAMES               STATUS                        PORTS
  - grafana             Up 34 minutes (healthy)       0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - prometheus          Up 33 minutes (healthy)       0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - web_app             Up 2 hours (healthy)          0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_exporter   Up 2 hours (healthy)          0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 1 second ago   '
  - postgres_db         Up 2 hours (healthy)          0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - node_exporter       Up 2 hours (healthy)          0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - alertmanager        Up 2 hours (healthy)          0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - 'loki                Restarting (1) 1 second ago   '
  - cadvisor_exporter   Up 2 hours (healthy)          0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-12 22:34:31,028 p=16756 u=zubeq n=ansible | TASK [Show service URLs] ********************************************************************
2025-11-12 22:34:31,043 p=16756 u=zubeq n=ansible | ok: [52.59.210.211] => 
  msg:
  - =========================================
  - ✅ Deployment completed successfully!
  - =========================================
  - 'Flask App:      http://52.59.210.211:5000'
  - 'Prometheus:     http://52.59.210.211:9090'
  - 'Grafana:        http://52.59.210.211:3000 (admin/admin)'
  - 'Alertmanager:   http://52.59.210.211:9093'
  - 'Loki:           http://52.59.210.211:3100'
  - =========================================
  - "\U0001F4CA Grafana Dashboards to import:"
  - '  - 11098 (Prometheus Alertmanager)'
  - '  - 13639 (Loki Dashboard)'
  - '  - 1860  (Node Exporter Full)'
  - =========================================
2025-11-12 22:34:31,053 p=16756 u=zubeq n=ansible | PLAY RECAP **********************************************************************************
2025-11-12 22:34:31,053 p=16756 u=zubeq n=ansible | 52.59.210.211              : ok=32   changed=3    unreachable=0    failed=0    skipped=2    rescued=0    ignored=0   
2025-11-13 18:26:52,314 p=6577 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] ******************************
2025-11-13 18:26:52,327 p=6577 u=zubeq n=ansible | TASK [Gathering Facts] ************************************************************************
2025-11-13 18:26:57,456 p=6577 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.177.85.165 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-13 18:26:57,456 p=6577 u=zubeq n=ansible | ok: [63.177.85.165]
2025-11-13 18:26:57,466 p=6577 u=zubeq n=ansible | TASK [docker : Install Docker engine] *********************************************************
2025-11-13 18:27:46,845 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:27:46,851 p=6577 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***********************************************
2025-11-13 18:27:52,270 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:27:52,275 p=6577 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ************************************
2025-11-13 18:27:55,784 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:27:55,795 p=6577 u=zubeq n=ansible | TASK [app : Create application directory] *****************************************************
2025-11-13 18:27:57,549 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:27:57,556 p=6577 u=zubeq n=ansible | TASK [app : Copy Flask app files] *************************************************************
2025-11-13 18:28:10,369 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:28:10,375 p=6577 u=zubeq n=ansible | TASK [app : Copy Dockerfile] ******************************************************************
2025-11-13 18:28:13,546 p=6577 u=zubeq n=ansible | ok: [63.177.85.165]
2025-11-13 18:28:13,560 p=6577 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **********************************************************
2025-11-13 18:28:18,155 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:28:18,160 p=6577 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] ******************************************************
2025-11-13 18:28:23,875 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:28:23,882 p=6577 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ****************************************************
2025-11-13 18:28:25,498 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:28:25,502 p=6577 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ********************************************************
2025-11-13 18:28:29,886 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:28:29,892 p=6577 u=zubeq n=ansible | TASK [app : Create alerts directory] **********************************************************
2025-11-13 18:28:31,959 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:28:31,964 p=6577 u=zubeq n=ansible | TASK [app : Template alert rules] *************************************************************
2025-11-13 18:28:36,893 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:28:36,900 p=6577 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] *******************************************************
2025-11-13 18:29:16,755 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:29:16,765 p=6577 u=zubeq n=ansible | TASK [app : Show docker-compose output] *******************************************************
2025-11-13 18:29:16,776 p=6577 u=zubeq n=ansible | skipping: [63.177.85.165]
2025-11-13 18:29:16,781 p=6577 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] ************************************************
2025-11-13 18:29:16,790 p=6577 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-13 18:29:16,791 p=6577 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 18:29:16,791 p=6577 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-13 18:29:26,798 p=6577 u=zubeq n=ansible | ok: [63.177.85.165]
2025-11-13 18:29:26,804 p=6577 u=zubeq n=ansible | TASK [app : Check running containers] *********************************************************
2025-11-13 18:29:30,029 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:29:30,035 p=6577 u=zubeq n=ansible | TASK [app : Show container status] ************************************************************
2025-11-13 18:29:30,049 p=6577 u=zubeq n=ansible | ok: [63.177.85.165] => 
  msg:
  - NAMES               STATUS                                  PORTS
  - promtail            Up Less than a second                   0.0.0.0:9080->9080/tcp, :::9080->9080/tcp
  - 'postgres_exporter   Up 13 seconds (health: starting)        0.0.0.0:9187->9187/tcp, :::9187->9187/tcp'
  - 'web_app             Up 13 seconds (health: starting)        0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'grafana             Up 13 seconds (health: starting)        0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'alertmanager        Up 14 seconds (health: starting)        0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - postgres_db         Up 15 seconds (healthy)                 0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - 'loki                Restarting (1) Less than a second ago   '
  - 'cadvisor_exporter   Up 15 seconds (health: starting)        0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
  - 'prometheus          Up 15 seconds (health: starting)        0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - 'node_exporter       Up 15 seconds (health: starting)        0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
2025-11-13 18:29:30,059 p=6577 u=zubeq n=ansible | TASK [app : Check Flask application health] ***************************************************
2025-11-13 18:29:32,730 p=6577 u=zubeq n=ansible | ok: [63.177.85.165]
2025-11-13 18:29:32,736 p=6577 u=zubeq n=ansible | TASK [app : Show Flask health check result] ***************************************************
2025-11-13 18:29:32,749 p=6577 u=zubeq n=ansible | ok: [63.177.85.165] => 
  msg: Flask application is UP ✅
2025-11-13 18:29:32,756 p=6577 u=zubeq n=ansible | TASK [loki : Create loki directory] ***********************************************************
2025-11-13 18:29:35,050 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:29:35,055 p=6577 u=zubeq n=ansible | TASK [loki : Template loki config] ************************************************************
2025-11-13 18:29:41,978 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:29:41,983 p=6577 u=zubeq n=ansible | TASK [loki : Create promtail directory] *******************************************************
2025-11-13 18:29:44,000 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:29:44,007 p=6577 u=zubeq n=ansible | TASK [loki : Template promtail config] ********************************************************
2025-11-13 18:29:49,947 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:29:49,953 p=6577 u=zubeq n=ansible | TASK [loki : Show Loki info] ******************************************************************
2025-11-13 18:29:49,984 p=6577 u=zubeq n=ansible | ok: [63.177.85.165] => 
  msg:
  - ✅ Loki logging stack configured
  - Loki will store logs for 7 days
  - Access Loki via Grafana Explore
2025-11-13 18:29:49,994 p=6577 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] ***********************************
2025-11-13 18:29:56,236 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:29:56,241 p=6577 u=zubeq n=ansible | TASK [backup : Create backup directory] *******************************************************
2025-11-13 18:29:58,676 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:29:58,682 p=6577 u=zubeq n=ansible | TASK [backup : Template backup script] ********************************************************
2025-11-13 18:30:04,488 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:30:04,495 p=6577 u=zubeq n=ansible | TASK [backup : Template restore script] *******************************************************
2025-11-13 18:30:08,672 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:30:08,678 p=6577 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] ***************************************************
2025-11-13 18:30:10,641 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:30:10,647 p=6577 u=zubeq n=ansible | TASK [backup : Create initial test backup] ****************************************************
2025-11-13 18:30:12,535 p=6577 u=zubeq n=ansible | ok: [63.177.85.165]
2025-11-13 18:30:12,540 p=6577 u=zubeq n=ansible | TASK [backup : Show backup result] ************************************************************
2025-11-13 18:30:12,576 p=6577 u=zubeq n=ansible | ok: [63.177.85.165] => 
  msg:
  - '[2025-11-13 16:30:12] ========================================='
  - '[2025-11-13 16:30:12] Starting PostgreSQL backup'
  - '[2025-11-13 16:30:12] ========================================='
  - '[2025-11-13 16:30:12] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-13 18:30:12,580 p=6577 u=zubeq n=ansible | TASK [backup : List created backups] **********************************************************
2025-11-13 18:30:14,398 p=6577 u=zubeq n=ansible | ok: [63.177.85.165]
2025-11-13 18:30:14,404 p=6577 u=zubeq n=ansible | TASK [backup : Show backup files info] ********************************************************
2025-11-13 18:30:14,437 p=6577 u=zubeq n=ansible | ok: [63.177.85.165] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 16:50'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-13 18:30:14,450 p=6577 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] ******************************************
2025-11-13 18:30:18,802 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:30:18,806 p=6577 u=zubeq n=ansible | RUNNING HANDLER [app : Restart compose stack] *************************************************
2025-11-13 18:30:34,078 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:30:34,084 p=6577 u=zubeq n=ansible | TASK [Wait for services to start] *************************************************************
2025-11-13 18:30:34,094 p=6577 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-13 18:30:34,094 p=6577 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 18:30:34,094 p=6577 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-13 18:31:04,101 p=6577 u=zubeq n=ansible | ok: [63.177.85.165]
2025-11-13 18:31:04,107 p=6577 u=zubeq n=ansible | TASK [Check running containers] ***************************************************************
2025-11-13 18:31:06,402 p=6577 u=zubeq n=ansible | changed: [63.177.85.165]
2025-11-13 18:31:06,408 p=6577 u=zubeq n=ansible | TASK [Show container status] ******************************************************************
2025-11-13 18:31:06,423 p=6577 u=zubeq n=ansible | ok: [63.177.85.165] => 
  msg:
  - NAMES               STATUS                          PORTS
  - web_app             Up 32 seconds (healthy)         0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - 'promtail            Restarting (1) 40 seconds ago   '
  - postgres_exporter   Up About a minute (healthy)     0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - grafana             Up About a minute (healthy)     0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - alertmanager        Up About a minute (healthy)     0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - postgres_db         Up About a minute (healthy)     0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - 'loki                Restarting (1) 41 seconds ago   '
  - cadvisor_exporter   Up About a minute (healthy)     0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
  - prometheus          Up 47 seconds (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - node_exporter       Up About a minute (healthy)     0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
2025-11-13 18:31:06,427 p=6577 u=zubeq n=ansible | TASK [Show service URLs] **********************************************************************
2025-11-13 18:31:06,443 p=6577 u=zubeq n=ansible | ok: [63.177.85.165] => 
  msg:
  - =========================================
  - ✅ Deployment completed successfully!
  - =========================================
  - 'Flask App:      http://63.177.85.165:5000'
  - 'Prometheus:     http://63.177.85.165:9090'
  - 'Grafana:        http://63.177.85.165:3000 (admin/admin)'
  - 'Alertmanager:   http://63.177.85.165:9093'
  - 'Loki:           http://63.177.85.165:3100'
  - =========================================
  - "\U0001F4CA Grafana Dashboards to import:"
  - '  - 11098 (Prometheus Alertmanager)'
  - '  - 13639 (Loki Dashboard)'
  - '  - 1860  (Node Exporter Full)'
  - '  - 14282 (CAdvisor Exporter)'
  - '  - 12485 PostgreSQL exporter'
  - =========================================
2025-11-13 18:31:06,449 p=6577 u=zubeq n=ansible | PLAY RECAP ************************************************************************************
2025-11-13 18:31:06,449 p=6577 u=zubeq n=ansible | 63.177.85.165              : ok=39   changed=25   unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2025-11-13 19:10:43,031 p=7709 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] *********************************************************************************
2025-11-13 19:10:43,038 p=7709 u=zubeq n=ansible | TASK [Gathering Facts] ***************************************************************************************************************************
2025-11-13 19:10:46,990 p=7709 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.177.89.164 is using the discovered Python interpreter at /usr/bin/python3.9, but future installation of
another Python interpreter could change the meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-13 19:10:46,990 p=7709 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:10:46,999 p=7709 u=zubeq n=ansible | TASK [docker : Install Docker engine] ************************************************************************************************************
2025-11-13 19:11:46,856 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:11:46,860 p=7709 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] **************************************************************************************************
2025-11-13 19:11:51,890 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:11:51,896 p=7709 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ***************************************************************************************
2025-11-13 19:11:55,885 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:11:55,895 p=7709 u=zubeq n=ansible | TASK [app : Create application directory] ********************************************************************************************************
2025-11-13 19:11:58,285 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:11:58,291 p=7709 u=zubeq n=ansible | TASK [app : Copy Flask app files] ****************************************************************************************************************
2025-11-13 19:12:12,136 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:12:12,142 p=7709 u=zubeq n=ansible | TASK [app : Copy Dockerfile] *********************************************************************************************************************
2025-11-13 19:12:15,352 p=7709 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:12:15,358 p=7709 u=zubeq n=ansible | TASK [app : Template prometheus.yml] *************************************************************************************************************
2025-11-13 19:12:19,393 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:12:19,398 p=7709 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] *********************************************************************************************************
2025-11-13 19:12:22,947 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:12:22,953 p=7709 u=zubeq n=ansible | TASK [app : Create alertmanager directory] *******************************************************************************************************
2025-11-13 19:12:25,040 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:12:25,045 p=7709 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ***********************************************************************************************************
2025-11-13 19:12:28,843 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:12:28,850 p=7709 u=zubeq n=ansible | TASK [app : Create alerts directory] *************************************************************************************************************
2025-11-13 19:12:30,563 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:12:30,570 p=7709 u=zubeq n=ansible | TASK [app : Template alert rules] ****************************************************************************************************************
2025-11-13 19:12:34,834 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:12:34,839 p=7709 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] **********************************************************************************************************
2025-11-13 19:13:14,458 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:13:14,464 p=7709 u=zubeq n=ansible | TASK [app : Show docker-compose output] **********************************************************************************************************
2025-11-13 19:13:14,478 p=7709 u=zubeq n=ansible | skipping: [63.177.89.164]
2025-11-13 19:13:14,483 p=7709 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] ***************************************************************************************************
2025-11-13 19:13:14,494 p=7709 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-13 19:13:14,494 p=7709 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 19:13:14,494 p=7709 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-13 19:13:24,501 p=7709 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:13:24,508 p=7709 u=zubeq n=ansible | TASK [app : Check running containers] ************************************************************************************************************
2025-11-13 19:13:27,342 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:13:27,349 p=7709 u=zubeq n=ansible | TASK [app : Show container status] ***************************************************************************************************************
2025-11-13 19:13:27,364 p=7709 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - NAMES               STATUS                                  PORTS
  - 'postgres_exporter   Up 13 seconds (health: starting)        0.0.0.0:9187->9187/tcp, :::9187->9187/tcp'
  - 'web_app             Up 13 seconds (health: starting)        0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'promtail            Restarting (1) Less than a second ago   '
  - 'grafana             Up 13 seconds (health: starting)        0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - postgres_db         Up 15 seconds (healthy)                 0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - 'loki                Restarting (1) Less than a second ago   '
  - 'cadvisor_exporter   Up 14 seconds (health: starting)        0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
  - 'prometheus          Up 15 seconds (health: starting)        0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - 'alertmanager        Up 15 seconds (health: starting)        0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - 'node_exporter       Up 15 seconds (health: starting)        0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
2025-11-13 19:13:27,368 p=7709 u=zubeq n=ansible | TASK [app : Check Flask application health] ******************************************************************************************************
2025-11-13 19:13:29,900 p=7709 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:13:29,906 p=7709 u=zubeq n=ansible | TASK [app : Show Flask health check result] ******************************************************************************************************
2025-11-13 19:13:29,920 p=7709 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg: Flask application is UP ✅
2025-11-13 19:13:29,926 p=7709 u=zubeq n=ansible | TASK [loki : Create loki directory] **************************************************************************************************************
2025-11-13 19:13:32,476 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:13:32,483 p=7709 u=zubeq n=ansible | TASK [loki : Template loki config] ***************************************************************************************************************
2025-11-13 19:13:37,582 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:13:37,588 p=7709 u=zubeq n=ansible | TASK [loki : Create promtail directory] **********************************************************************************************************
2025-11-13 19:13:39,858 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:13:39,865 p=7709 u=zubeq n=ansible | TASK [loki : Template promtail config] ***********************************************************************************************************
2025-11-13 19:13:45,124 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:13:45,130 p=7709 u=zubeq n=ansible | TASK [loki : Show Loki info] *********************************************************************************************************************
2025-11-13 19:13:45,143 p=7709 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - ✅ Loki logging stack configured
  - Loki will store logs for 7 days
  - Access Loki via Grafana Explore
2025-11-13 19:13:45,151 p=7709 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] **************************************************************************************
2025-11-13 19:13:49,741 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:13:49,747 p=7709 u=zubeq n=ansible | TASK [backup : Create backup directory] **********************************************************************************************************
2025-11-13 19:13:51,352 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:13:51,357 p=7709 u=zubeq n=ansible | TASK [backup : Template backup script] ***********************************************************************************************************
2025-11-13 19:13:56,516 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:13:56,523 p=7709 u=zubeq n=ansible | TASK [backup : Template restore script] **********************************************************************************************************
2025-11-13 19:14:00,460 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:14:00,465 p=7709 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] ******************************************************************************************************
2025-11-13 19:14:03,049 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:14:03,054 p=7709 u=zubeq n=ansible | TASK [backup : Create initial test backup] *******************************************************************************************************
2025-11-13 19:14:05,634 p=7709 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:14:05,639 p=7709 u=zubeq n=ansible | TASK [backup : Show backup result] ***************************************************************************************************************
2025-11-13 19:14:05,673 p=7709 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - '[2025-11-13 17:14:05] ========================================='
  - '[2025-11-13 17:14:05] Starting PostgreSQL backup'
  - '[2025-11-13 17:14:05] ========================================='
  - '[2025-11-13 17:14:05] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-13 19:14:05,677 p=7709 u=zubeq n=ansible | TASK [backup : List created backups] *************************************************************************************************************
2025-11-13 19:14:07,508 p=7709 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:14:07,513 p=7709 u=zubeq n=ansible | TASK [backup : Show backup files info] ***********************************************************************************************************
2025-11-13 19:14:07,546 p=7709 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 16:50'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-13 19:14:07,559 p=7709 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] *********************************************************************************************
2025-11-13 19:14:11,705 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:14:11,710 p=7709 u=zubeq n=ansible | RUNNING HANDLER [app : Restart compose stack] ****************************************************************************************************
2025-11-13 19:14:26,650 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:14:26,657 p=7709 u=zubeq n=ansible | TASK [Wait for services to start] ****************************************************************************************************************
2025-11-13 19:14:26,667 p=7709 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-13 19:14:26,667 p=7709 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 19:14:26,667 p=7709 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-13 19:14:56,674 p=7709 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:14:56,678 p=7709 u=zubeq n=ansible | TASK [Check running containers] ******************************************************************************************************************
2025-11-13 19:14:58,849 p=7709 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:14:58,856 p=7709 u=zubeq n=ansible | TASK [Show container status] *********************************************************************************************************************
2025-11-13 19:14:58,870 p=7709 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - NAMES               STATUS                          PORTS
  - web_app             Up 32 seconds (healthy)         0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_exporter   Up About a minute (healthy)     0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 35 seconds ago   '
  - grafana             Up About a minute (healthy)     0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - postgres_db         Up About a minute (healthy)     0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - 'loki                Restarting (1) 35 seconds ago   '
  - cadvisor_exporter   Up About a minute (healthy)     0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
  - prometheus          Up 47 seconds (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - alertmanager        Up About a minute (healthy)     0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - node_exporter       Up About a minute (healthy)     0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
2025-11-13 19:14:58,874 p=7709 u=zubeq n=ansible | TASK [Show service URLs] *************************************************************************************************************************
2025-11-13 19:14:58,890 p=7709 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - =========================================
  - ✅ Deployment completed successfully!
  - =========================================
  - 'Flask App:      http://63.177.89.164:5000'
  - 'Prometheus:     http://63.177.89.164:9090'
  - 'Grafana:        http://63.177.89.164:3000 (admin/admin)'
  - 'Alertmanager:   http://63.177.89.164:9093'
  - 'Loki:           http://63.177.89.164:3100'
  - =========================================
  - "\U0001F4CA Grafana Dashboards to import:"
  - '  - 11098 (Prometheus Alertmanager)'
  - '  - 13639 (Loki Dashboard)'
  - '  - 1860  (Node Exporter Full)'
  - '  - 14282 (CAdvisor Exporter)'
  - '  - 12485 PostgreSQL exporter'
  - =========================================
2025-11-13 19:14:58,896 p=7709 u=zubeq n=ansible | PLAY RECAP ***************************************************************************************************************************************
2025-11-13 19:14:58,896 p=7709 u=zubeq n=ansible | 63.177.89.164              : ok=39   changed=25   unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2025-11-13 19:38:53,304 p=8470 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] *******************************
2025-11-13 19:38:53,311 p=8470 u=zubeq n=ansible | TASK [Gathering Facts] *************************************************************************
2025-11-13 19:38:57,942 p=8470 u=zubeq n=ansible | [WARNING]: Platform linux on host 63.177.89.164 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the
meaning of that path. See https://docs.ansible.com/ansible-
core/2.16/reference_appendices/interpreter_discovery.html for more information.

2025-11-13 19:38:57,942 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:38:57,952 p=8470 u=zubeq n=ansible | TASK [docker : Install Docker engine] **********************************************************
2025-11-13 19:39:02,235 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:39:02,241 p=8470 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ************************************************
2025-11-13 19:39:05,580 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:39:05,586 p=8470 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] *************************************
2025-11-13 19:39:07,945 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:39:07,954 p=8470 u=zubeq n=ansible | TASK [app : Create application directory] ******************************************************
2025-11-13 19:39:09,803 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:39:09,810 p=8470 u=zubeq n=ansible | TASK [app : Copy Flask app files] **************************************************************
2025-11-13 19:39:20,567 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:39:20,573 p=8470 u=zubeq n=ansible | TASK [app : Copy Dockerfile] *******************************************************************
2025-11-13 19:39:24,053 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:39:24,058 p=8470 u=zubeq n=ansible | TASK [app : Template prometheus.yml] ***********************************************************
2025-11-13 19:39:27,811 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:39:27,817 p=8470 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] *******************************************************
2025-11-13 19:39:31,923 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:39:31,930 p=8470 u=zubeq n=ansible | TASK [app : Create alertmanager directory] *****************************************************
2025-11-13 19:39:33,800 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:39:33,806 p=8470 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] *********************************************************
2025-11-13 19:39:38,418 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:39:38,422 p=8470 u=zubeq n=ansible | TASK [app : Create alerts directory] ***********************************************************
2025-11-13 19:39:40,574 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:39:40,580 p=8470 u=zubeq n=ansible | TASK [app : Template alert rules] **************************************************************
2025-11-13 19:39:45,145 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:39:45,153 p=8470 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] ********************************************************
2025-11-13 19:39:51,209 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:39:51,216 p=8470 u=zubeq n=ansible | TASK [app : Show docker-compose output] ********************************************************
2025-11-13 19:39:51,227 p=8470 u=zubeq n=ansible | skipping: [63.177.89.164]
2025-11-13 19:39:51,233 p=8470 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] *************************************************
2025-11-13 19:39:51,243 p=8470 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-13 19:39:51,243 p=8470 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 19:39:51,243 p=8470 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-13 19:40:01,251 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:40:01,255 p=8470 u=zubeq n=ansible | TASK [app : Check running containers] **********************************************************
2025-11-13 19:40:04,906 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:40:04,912 p=8470 u=zubeq n=ansible | TASK [app : Show container status] *************************************************************
2025-11-13 19:40:04,926 p=8470 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - NAMES               STATUS                                     PORTS
  - 'grafana             Up 13 seconds (health: starting)           0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'web_app             Up 13 seconds (health: starting)           0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'postgres_exporter   Up 13 seconds (health: starting)           0.0.0.0:9187->9187/tcp, :::9187->9187/tcp'
  - 'promtail            Restarting (1) 1 second ago                '
  - 'alertmanager        Up 15 seconds (health: starting)           0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - postgres_db         Up 15 seconds (healthy)                    0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - 'prometheus          Up 15 seconds (health: starting)           0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - 'cadvisor_exporter   Up 15 seconds (health: starting)           0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
  - 'node_exporter       Up 15 seconds (health: starting)           0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
  - 'loki                Up Less than a second (health: starting)   0.0.0.0:3100->3100/tcp, :::3100->3100/tcp'
2025-11-13 19:40:04,930 p=8470 u=zubeq n=ansible | TASK [app : Check Flask application health] ****************************************************
2025-11-13 19:40:07,429 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:40:07,435 p=8470 u=zubeq n=ansible | TASK [app : Show Flask health check result] ****************************************************
2025-11-13 19:40:07,450 p=8470 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg: Flask application is UP ✅
2025-11-13 19:40:07,457 p=8470 u=zubeq n=ansible | TASK [loki : Create loki directory] ************************************************************
2025-11-13 19:40:09,329 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:40:09,336 p=8470 u=zubeq n=ansible | TASK [loki : Template loki config] *************************************************************
2025-11-13 19:40:15,935 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:40:15,941 p=8470 u=zubeq n=ansible | TASK [loki : Create promtail directory] ********************************************************
2025-11-13 19:40:17,831 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:40:17,838 p=8470 u=zubeq n=ansible | TASK [loki : Template promtail config] *********************************************************
2025-11-13 19:40:23,341 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:40:23,346 p=8470 u=zubeq n=ansible | TASK [loki : Show Loki info] *******************************************************************
2025-11-13 19:40:23,360 p=8470 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - ✅ Loki logging stack configured
  - Loki will store logs for 7 days
  - Access Loki via Grafana Explore
2025-11-13 19:40:23,369 p=8470 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] ************************************
2025-11-13 19:40:27,304 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:40:27,311 p=8470 u=zubeq n=ansible | TASK [backup : Create backup directory] ********************************************************
2025-11-13 19:40:29,271 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:40:29,278 p=8470 u=zubeq n=ansible | TASK [backup : Template backup script] *********************************************************
2025-11-13 19:40:32,717 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:40:32,723 p=8470 u=zubeq n=ansible | TASK [backup : Template restore script] ********************************************************
2025-11-13 19:40:36,103 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:40:36,109 p=8470 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] ****************************************************
2025-11-13 19:40:38,561 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:40:38,567 p=8470 u=zubeq n=ansible | TASK [backup : Create initial test backup] *****************************************************
2025-11-13 19:40:40,729 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:40:40,734 p=8470 u=zubeq n=ansible | TASK [backup : Show backup result] *************************************************************
2025-11-13 19:40:40,769 p=8470 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - '[2025-11-13 17:40:40] ========================================='
  - '[2025-11-13 17:40:40] Starting PostgreSQL backup'
  - '[2025-11-13 17:40:40] ========================================='
  - '[2025-11-13 17:40:40] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-13 19:40:40,773 p=8470 u=zubeq n=ansible | TASK [backup : List created backups] ***********************************************************
2025-11-13 19:40:43,272 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:40:43,277 p=8470 u=zubeq n=ansible | TASK [backup : Show backup files info] *********************************************************
2025-11-13 19:40:43,310 p=8470 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 16:50'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-13 19:40:43,324 p=8470 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] *******************************************
2025-11-13 19:40:48,355 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:40:48,361 p=8470 u=zubeq n=ansible | RUNNING HANDLER [app : Restart compose stack] **************************************************
2025-11-13 19:41:05,014 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:41:05,021 p=8470 u=zubeq n=ansible | TASK [Wait for services to start] **************************************************************
2025-11-13 19:41:05,032 p=8470 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-13 19:41:05,032 p=8470 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 19:41:05,032 p=8470 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-13 19:41:35,040 p=8470 u=zubeq n=ansible | ok: [63.177.89.164]
2025-11-13 19:41:35,046 p=8470 u=zubeq n=ansible | TASK [Check running containers] ****************************************************************
2025-11-13 19:41:39,563 p=8470 u=zubeq n=ansible | changed: [63.177.89.164]
2025-11-13 19:41:39,570 p=8470 u=zubeq n=ansible | TASK [Show container status] *******************************************************************
2025-11-13 19:41:39,584 p=8470 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - NAMES               STATUS                          PORTS
  - web_app             Up 34 seconds (healthy)         0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - grafana             Up About a minute (healthy)     0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - postgres_exporter   Up About a minute (healthy)     0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 42 seconds ago   '
  - alertmanager        Up About a minute (healthy)     0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - postgres_db         Up About a minute (healthy)     0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - prometheus          Up 51 seconds (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - cadvisor_exporter   Up About a minute (healthy)     0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
  - node_exporter       Up About a minute (healthy)     0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - 'loki                Restarting (1) 44 seconds ago   '
2025-11-13 19:41:39,589 p=8470 u=zubeq n=ansible | TASK [Show service URLs] ***********************************************************************
2025-11-13 19:41:39,606 p=8470 u=zubeq n=ansible | ok: [63.177.89.164] => 
  msg:
  - =========================================
  - ✅ Deployment completed successfully!
  - =========================================
  - 'Flask App:      http://63.177.89.164:5000'
  - 'Prometheus:     http://63.177.89.164:9090'
  - 'Grafana:        http://63.177.89.164:3000 (admin/admin)'
  - 'Alertmanager:   http://63.177.89.164:9093'
  - 'Loki:           http://63.177.89.164:3100'
  - =========================================
  - "\U0001F4CA Grafana Dashboards to import:"
  - '  - 11098 (Prometheus Alertmanager)'
  - '  - 13639 (Loki Dashboard)'
  - '  - 1860  (Node Exporter Full)'
  - '  - 14282 (CAdvisor Exporter)'
  - '  - 12485 PostgreSQL exporter'
  - =========================================
2025-11-13 19:41:39,613 p=8470 u=zubeq n=ansible | PLAY RECAP *************************************************************************************
2025-11-13 19:41:39,613 p=8470 u=zubeq n=ansible | 63.177.89.164              : ok=39   changed=16   unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2025-11-13 20:02:11,653 p=9802 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] **********************************************
2025-11-13 20:02:11,660 p=9802 u=zubeq n=ansible | TASK [Gathering Facts] ****************************************************************************************
2025-11-13 20:02:21,927 p=9802 u=zubeq n=ansible | [WARNING]: Platform linux on host 18.185.108.245 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the meaning of that
path. See https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more
information.

2025-11-13 20:02:21,927 p=9802 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:02:21,937 p=9802 u=zubeq n=ansible | TASK [docker : Install Docker engine] *************************************************************************
2025-11-13 20:03:09,328 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:09,332 p=9802 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***************************************************************
2025-11-13 20:03:13,635 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:13,640 p=9802 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ****************************************************
2025-11-13 20:03:17,299 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:17,308 p=9802 u=zubeq n=ansible | TASK [app : Create application directory] *********************************************************************
2025-11-13 20:03:19,719 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:19,725 p=9802 u=zubeq n=ansible | TASK [app : Copy Flask app files] *****************************************************************************
2025-11-13 20:03:30,829 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:30,835 p=9802 u=zubeq n=ansible | TASK [app : Copy Dockerfile] **********************************************************************************
2025-11-13 20:03:34,875 p=9802 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:03:34,879 p=9802 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **************************************************************************
2025-11-13 20:03:38,596 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:38,601 p=9802 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] **********************************************************************
2025-11-13 20:03:43,085 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:43,091 p=9802 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ********************************************************************
2025-11-13 20:03:44,992 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:44,997 p=9802 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ************************************************************************
2025-11-13 20:03:49,572 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:49,578 p=9802 u=zubeq n=ansible | TASK [app : Create alerts directory] **************************************************************************
2025-11-13 20:03:51,977 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:51,982 p=9802 u=zubeq n=ansible | TASK [app : Template alert rules] *****************************************************************************
2025-11-13 20:03:56,226 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:56,231 p=9802 u=zubeq n=ansible | TASK [app : Create loki directory] ****************************************************************************
2025-11-13 20:03:58,204 p=9802 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:03:58,209 p=9802 u=zubeq n=ansible | TASK [app : Template loki config] *****************************************************************************
2025-11-13 20:03:58,611 p=9802 u=zubeq n=ansible | An exception occurred during task execution. To see the full traceback, use -vvv. The error was: If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-11-13 20:03:58,613 p=9802 u=zubeq n=ansible | fatal: [18.185.108.245]: FAILED! => changed=false 
  msg: |-
    Could not find or access 'loki-config.yml.j2'
    Searched in:
            /media/zubeq/ext4d4/gpt5/6/ansible/roles/app/templates/loki-config.yml.j2
            /media/zubeq/ext4d4/gpt5/6/ansible/roles/app/loki-config.yml.j2
            /media/zubeq/ext4d4/gpt5/6/ansible/roles/app/tasks/templates/loki-config.yml.j2
            /media/zubeq/ext4d4/gpt5/6/ansible/roles/app/tasks/loki-config.yml.j2
            /media/zubeq/ext4d4/gpt5/6/ansible/playbooks/templates/loki-config.yml.j2
            /media/zubeq/ext4d4/gpt5/6/ansible/playbooks/loki-config.yml.j2 on the Ansible Controller.
    If you are using a module and expect the file to exist on the remote, see the remote_src option
2025-11-13 20:03:58,613 p=9802 u=zubeq n=ansible | PLAY RECAP ****************************************************************************************************
2025-11-13 20:03:58,613 p=9802 u=zubeq n=ansible | 18.185.108.245             : ok=14   changed=12   unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-13 20:05:02,370 p=10024 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] **********************************************
2025-11-13 20:05:02,377 p=10024 u=zubeq n=ansible | TASK [Gathering Facts] ****************************************************************************************
2025-11-13 20:05:06,404 p=10024 u=zubeq n=ansible | [WARNING]: Platform linux on host 18.185.108.245 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the meaning of that
path. See https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more
information.

2025-11-13 20:05:06,404 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:06,411 p=10024 u=zubeq n=ansible | TASK [docker : Install Docker engine] *************************************************************************
2025-11-13 20:05:10,024 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:10,030 p=10024 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***************************************************************
2025-11-13 20:05:12,402 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:12,407 p=10024 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ****************************************************
2025-11-13 20:05:14,526 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:14,535 p=10024 u=zubeq n=ansible | TASK [app : Create application directory] *********************************************************************
2025-11-13 20:05:16,486 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:16,492 p=10024 u=zubeq n=ansible | TASK [app : Copy Flask app files] *****************************************************************************
2025-11-13 20:05:25,065 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:25,068 p=10024 u=zubeq n=ansible | TASK [app : Copy Dockerfile] **********************************************************************************
2025-11-13 20:05:27,973 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:27,977 p=10024 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **************************************************************************
2025-11-13 20:05:31,074 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:31,082 p=10024 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] **********************************************************************
2025-11-13 20:05:34,423 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:34,429 p=10024 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ********************************************************************
2025-11-13 20:05:36,447 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:36,453 p=10024 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ************************************************************************
2025-11-13 20:05:40,005 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:40,012 p=10024 u=zubeq n=ansible | TASK [app : Create alerts directory] **************************************************************************
2025-11-13 20:05:42,069 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:42,074 p=10024 u=zubeq n=ansible | TASK [app : Template alert rules] *****************************************************************************
2025-11-13 20:05:45,321 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:45,327 p=10024 u=zubeq n=ansible | TASK [app : Create loki directory] ****************************************************************************
2025-11-13 20:05:47,757 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:05:47,762 p=10024 u=zubeq n=ansible | TASK [app : Template loki config] *****************************************************************************
2025-11-13 20:05:52,783 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:05:52,792 p=10024 u=zubeq n=ansible | TASK [app : Create promtail directory] ************************************************************************
2025-11-13 20:05:54,606 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:05:54,611 p=10024 u=zubeq n=ansible | TASK [app : Template promtail config] *************************************************************************
2025-11-13 20:05:58,614 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:05:58,620 p=10024 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] ***********************************************************************
2025-11-13 20:06:36,204 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:06:36,210 p=10024 u=zubeq n=ansible | TASK [app : Show docker-compose output] ***********************************************************************
2025-11-13 20:06:36,221 p=10024 u=zubeq n=ansible | skipping: [18.185.108.245]
2025-11-13 20:06:36,226 p=10024 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] ****************************************************************
2025-11-13 20:06:36,236 p=10024 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-13 20:06:36,236 p=10024 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 20:06:36,236 p=10024 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-13 20:06:46,243 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:06:46,249 p=10024 u=zubeq n=ansible | TASK [app : Check running containers] *************************************************************************
2025-11-13 20:06:49,797 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:06:49,803 p=10024 u=zubeq n=ansible | TASK [app : Show container status] ****************************************************************************
2025-11-13 20:06:49,817 p=10024 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - NAMES               STATUS                                  PORTS
  - 'grafana             Up 13 seconds (health: starting)        0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'web_app             Up 14 seconds (health: starting)        0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'postgres_exporter   Up 14 seconds (health: starting)        0.0.0.0:9187->9187/tcp, :::9187->9187/tcp'
  - 'promtail            Restarting (1) Less than a second ago   '
  - 'node_exporter       Up 15 seconds (health: starting)        0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
  - 'alertmanager        Up 15 seconds (health: starting)        0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - 'loki                Restarting (1) 2 seconds ago            '
  - postgres_db         Up 16 seconds (healthy)                 0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - 'prometheus          Up 15 seconds (health: starting)        0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - 'cadvisor_exporter   Up 15 seconds (health: starting)        0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
2025-11-13 20:06:49,821 p=10024 u=zubeq n=ansible | TASK [app : Check Flask application health] *******************************************************************
2025-11-13 20:06:52,671 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:06:52,677 p=10024 u=zubeq n=ansible | TASK [app : Show Flask health check result] *******************************************************************
2025-11-13 20:06:52,690 p=10024 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg: Flask application is UP ✅
2025-11-13 20:06:52,698 p=10024 u=zubeq n=ansible | TASK [loki : Show Loki info] **********************************************************************************
2025-11-13 20:06:52,710 p=10024 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - ✅ Loki logging stack configured
  - Loki will store logs for 7 days
  - Access Loki via Grafana Explore
2025-11-13 20:06:52,720 p=10024 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] ***************************************************
2025-11-13 20:06:57,651 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:06:57,657 p=10024 u=zubeq n=ansible | TASK [backup : Create backup directory] ***********************************************************************
2025-11-13 20:06:59,824 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:06:59,830 p=10024 u=zubeq n=ansible | TASK [backup : Template backup script] ************************************************************************
2025-11-13 20:07:04,364 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:07:04,369 p=10024 u=zubeq n=ansible | TASK [backup : Template restore script] ***********************************************************************
2025-11-13 20:07:08,325 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:07:08,332 p=10024 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *******************************************************************
2025-11-13 20:07:10,035 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:07:10,041 p=10024 u=zubeq n=ansible | TASK [backup : Create initial test backup] ********************************************************************
2025-11-13 20:07:12,020 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:07:12,026 p=10024 u=zubeq n=ansible | TASK [backup : Show backup result] ****************************************************************************
2025-11-13 20:07:12,058 p=10024 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - '[2025-11-13 18:07:11] ========================================='
  - '[2025-11-13 18:07:11] Starting PostgreSQL backup'
  - '[2025-11-13 18:07:11] ========================================='
  - '[2025-11-13 18:07:11] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-13 20:07:12,063 p=10024 u=zubeq n=ansible | TASK [backup : List created backups] **************************************************************************
2025-11-13 20:07:14,055 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:07:14,060 p=10024 u=zubeq n=ansible | TASK [backup : Show backup files info] ************************************************************************
2025-11-13 20:07:14,093 p=10024 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 16:50'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-13 20:07:14,107 p=10024 u=zubeq n=ansible | TASK [Wait for services to start] *****************************************************************************
2025-11-13 20:07:14,117 p=10024 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-13 20:07:14,118 p=10024 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 20:07:14,118 p=10024 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-13 20:07:44,124 p=10024 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:07:44,131 p=10024 u=zubeq n=ansible | TASK [Check running containers] *******************************************************************************
2025-11-13 20:07:46,808 p=10024 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:07:46,814 p=10024 u=zubeq n=ansible | TASK [Show container status] **********************************************************************************
2025-11-13 20:07:46,828 p=10024 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - NAMES               STATUS                         PORTS
  - grafana             Up About a minute (healthy)    0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - web_app             Up About a minute (healthy)    0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - postgres_exporter   Up About a minute (healthy)    0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 3 seconds ago   '
  - node_exporter       Up About a minute (healthy)    0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - alertmanager        Up About a minute (healthy)    0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - 'loki                Restarting (1) 4 seconds ago   '
  - postgres_db         Up About a minute (healthy)    0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - prometheus          Up About a minute (healthy)    0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - cadvisor_exporter   Up About a minute (healthy)    0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-13 20:07:46,832 p=10024 u=zubeq n=ansible | TASK [Show service URLs] **************************************************************************************
2025-11-13 20:07:46,849 p=10024 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - =========================================
  - ✅ Deployment completed successfully!
  - =========================================
  - 'Flask App:      http://18.185.108.245:5000'
  - 'Prometheus:     http://18.185.108.245:9090'
  - 'Grafana:        http://18.185.108.245:3000 (admin/admin)'
  - 'Alertmanager:   http://18.185.108.245:9093'
  - 'Loki:           http://18.185.108.245:3100'
  - =========================================
  - "\U0001F4CA Grafana Dashboards to import:"
  - '  - 11098 (Prometheus Alertmanager)'
  - '  - 13639 (Loki Dashboard)'
  - '  - 1860  (Node Exporter Full)'
  - '  - 14282 (CAdvisor Exporter)'
  - '  - 12485 PostgreSQL exporter'
  - =========================================
2025-11-13 20:07:46,855 p=10024 u=zubeq n=ansible | PLAY RECAP ****************************************************************************************************
2025-11-13 20:07:46,856 p=10024 u=zubeq n=ansible | 18.185.108.245             : ok=37   changed=11   unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2025-11-13 20:16:48,890 p=10452 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] **********************************************
2025-11-13 20:16:48,898 p=10452 u=zubeq n=ansible | TASK [Gathering Facts] ****************************************************************************************
2025-11-13 20:16:57,637 p=10452 u=zubeq n=ansible | [WARNING]: Platform linux on host 18.185.108.245 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the meaning of that
path. See https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more
information.

2025-11-13 20:16:57,637 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:16:57,647 p=10452 u=zubeq n=ansible | TASK [docker : Install Docker engine] *************************************************************************
2025-11-13 20:17:02,472 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:02,477 p=10452 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***************************************************************
2025-11-13 20:17:06,290 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:06,296 p=10452 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ****************************************************
2025-11-13 20:17:09,424 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:09,435 p=10452 u=zubeq n=ansible | TASK [app : Create application directory] *********************************************************************
2025-11-13 20:17:12,101 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:12,108 p=10452 u=zubeq n=ansible | TASK [app : Copy Flask app files] *****************************************************************************
2025-11-13 20:17:22,087 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:22,093 p=10452 u=zubeq n=ansible | TASK [app : Copy Dockerfile] **********************************************************************************
2025-11-13 20:17:25,656 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:25,661 p=10452 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **************************************************************************
2025-11-13 20:17:32,607 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:32,616 p=10452 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] **********************************************************************
2025-11-13 20:17:37,960 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:37,965 p=10452 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ********************************************************************
2025-11-13 20:17:39,946 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:39,952 p=10452 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ************************************************************************
2025-11-13 20:17:43,201 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:43,208 p=10452 u=zubeq n=ansible | TASK [app : Create alerts directory] **************************************************************************
2025-11-13 20:17:45,049 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:45,056 p=10452 u=zubeq n=ansible | TASK [app : Template alert rules] *****************************************************************************
2025-11-13 20:17:48,761 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:17:48,768 p=10452 u=zubeq n=ansible | TASK [app : Create loki directory] ****************************************************************************
2025-11-13 20:17:51,092 p=10452 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:17:51,098 p=10452 u=zubeq n=ansible | TASK [app : Template loki config] *****************************************************************************
2025-11-13 20:17:55,392 p=10452 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:17:55,399 p=10452 u=zubeq n=ansible | TASK [app : Create promtail directory] ************************************************************************
2025-11-13 20:17:57,939 p=10452 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:17:57,944 p=10452 u=zubeq n=ansible | TASK [app : Template promtail config] *************************************************************************
2025-11-13 20:18:02,949 p=10452 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:18:02,955 p=10452 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] ***********************************************************************
2025-11-13 20:18:09,049 p=10452 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:18:09,055 p=10452 u=zubeq n=ansible | TASK [app : Show docker-compose output] ***********************************************************************
2025-11-13 20:18:09,067 p=10452 u=zubeq n=ansible | skipping: [18.185.108.245]
2025-11-13 20:18:09,071 p=10452 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] ****************************************************************
2025-11-13 20:18:09,081 p=10452 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-13 20:18:09,081 p=10452 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 20:18:09,081 p=10452 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-13 20:18:19,087 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:18:19,095 p=10452 u=zubeq n=ansible | TASK [app : Check running containers] *************************************************************************
2025-11-13 20:18:21,822 p=10452 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:18:21,827 p=10452 u=zubeq n=ansible | TASK [app : Show container status] ****************************************************************************
2025-11-13 20:18:21,842 p=10452 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - NAMES               STATUS                             PORTS
  - 'grafana             Up 13 seconds (health: starting)   0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'postgres_exporter   Up 13 seconds (health: starting)   0.0.0.0:9187->9187/tcp, :::9187->9187/tcp'
  - 'web_app             Up 13 seconds (health: starting)   0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - 'promtail            Restarting (1) 1 second ago        '
  - 'node_exporter       Up 14 seconds (health: starting)   0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
  - 'loki                Restarting (1) 2 seconds ago       '
  - postgres_db         Up 14 seconds (healthy)            0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - 'prometheus          Up 14 seconds (health: starting)   0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - 'alertmanager        Up 14 seconds (health: starting)   0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - 'cadvisor_exporter   Up 14 seconds (health: starting)   0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
2025-11-13 20:18:21,845 p=10452 u=zubeq n=ansible | TASK [app : Check Flask application health] *******************************************************************
2025-11-13 20:18:25,090 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:18:25,093 p=10452 u=zubeq n=ansible | TASK [app : Show Flask health check result] *******************************************************************
2025-11-13 20:18:25,108 p=10452 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg: Flask application is UP ✅
2025-11-13 20:18:25,113 p=10452 u=zubeq n=ansible | TASK [loki : Show Loki info] **********************************************************************************
2025-11-13 20:18:25,125 p=10452 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - ✅ Loki logging stack configured
  - Loki will store logs for 7 days
  - Access Loki via Grafana Explore
2025-11-13 20:18:25,130 p=10452 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] ***************************************************
2025-11-13 20:18:29,331 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:18:29,336 p=10452 u=zubeq n=ansible | TASK [backup : Create backup directory] ***********************************************************************
2025-11-13 20:18:31,834 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:18:31,839 p=10452 u=zubeq n=ansible | TASK [backup : Template backup script] ************************************************************************
2025-11-13 20:18:35,608 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:18:35,615 p=10452 u=zubeq n=ansible | TASK [backup : Template restore script] ***********************************************************************
2025-11-13 20:18:39,349 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:18:39,355 p=10452 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *******************************************************************
2025-11-13 20:18:41,014 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:18:41,018 p=10452 u=zubeq n=ansible | TASK [backup : Create initial test backup] ********************************************************************
2025-11-13 20:18:42,965 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:18:42,970 p=10452 u=zubeq n=ansible | TASK [backup : Show backup result] ****************************************************************************
2025-11-13 20:18:43,003 p=10452 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - '[2025-11-13 18:18:42] ========================================='
  - '[2025-11-13 18:18:42] Starting PostgreSQL backup'
  - '[2025-11-13 18:18:42] ========================================='
  - '[2025-11-13 18:18:42] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-13 20:18:43,006 p=10452 u=zubeq n=ansible | TASK [backup : List created backups] **************************************************************************
2025-11-13 20:18:46,483 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:18:46,487 p=10452 u=zubeq n=ansible | TASK [backup : Show backup files info] ************************************************************************
2025-11-13 20:18:46,520 p=10452 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 16:50'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-13 20:18:46,529 p=10452 u=zubeq n=ansible | TASK [Wait for services to start] *****************************************************************************
2025-11-13 20:18:46,539 p=10452 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-13 20:18:46,539 p=10452 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 20:18:46,539 p=10452 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-13 20:19:16,546 p=10452 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:19:16,553 p=10452 u=zubeq n=ansible | TASK [Check running containers] *******************************************************************************
2025-11-13 20:19:20,477 p=10452 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:19:20,484 p=10452 u=zubeq n=ansible | TASK [Show container status] **********************************************************************************
2025-11-13 20:19:20,499 p=10452 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - NAMES               STATUS                         PORTS
  - grafana             Up About a minute (healthy)    0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - postgres_exporter   Up About a minute (healthy)    0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - web_app             Up About a minute (healthy)    0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - 'promtail            Restarting (1) 6 seconds ago   '
  - node_exporter       Up About a minute (healthy)    0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - 'loki                Restarting (1) 6 seconds ago   '
  - postgres_db         Up About a minute (healthy)    0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - prometheus          Up About a minute (healthy)    0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - alertmanager        Up About a minute (healthy)    0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - cadvisor_exporter   Up About a minute (healthy)    0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-13 20:19:20,503 p=10452 u=zubeq n=ansible | TASK [Show service URLs] **************************************************************************************
2025-11-13 20:19:20,517 p=10452 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - =========================================
  - ✅ Deployment completed successfully!
  - =========================================
  - 'Flask App:      http://18.185.108.245:5000'
  - 'Prometheus:     http://18.185.108.245:9090'
  - 'Grafana:        http://18.185.108.245:3000 (admin/admin)'
  - 'Alertmanager:   http://18.185.108.245:9093'
  - 'Loki:           http://18.185.108.245:3100'
  - =========================================
  - "\U0001F4CA Grafana Dashboards to import:"
  - '  - 11098 (Prometheus Alertmanager)'
  - '  - 13639 (Loki Dashboard)'
  - '  - 1860  (Node Exporter Full)'
  - '  - 14282 (CAdvisor Exporter)'
  - '  - 12485 PostgreSQL exporter'
  - =========================================
2025-11-13 20:19:20,524 p=10452 u=zubeq n=ansible | PLAY RECAP ****************************************************************************************************
2025-11-13 20:19:20,524 p=10452 u=zubeq n=ansible | 18.185.108.245             : ok=37   changed=7    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2025-11-13 20:24:49,288 p=10868 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] **********************************************
2025-11-13 20:24:49,295 p=10868 u=zubeq n=ansible | TASK [Gathering Facts] ****************************************************************************************
2025-11-13 20:24:58,271 p=10868 u=zubeq n=ansible | [WARNING]: Platform linux on host 18.185.108.245 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the meaning of that
path. See https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more
information.

2025-11-13 20:24:58,271 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:24:58,285 p=10868 u=zubeq n=ansible | TASK [docker : Install Docker engine] *************************************************************************
2025-11-13 20:25:04,415 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:25:04,423 p=10868 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***************************************************************
2025-11-13 20:25:09,446 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:25:09,454 p=10868 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ****************************************************
2025-11-13 20:25:13,327 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:25:13,338 p=10868 u=zubeq n=ansible | TASK [app : Create application directory] *********************************************************************
2025-11-13 20:25:17,828 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:25:17,835 p=10868 u=zubeq n=ansible | TASK [app : Copy Flask app files] *****************************************************************************
2025-11-13 20:25:38,736 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:25:38,744 p=10868 u=zubeq n=ansible | TASK [app : Copy Dockerfile] **********************************************************************************
2025-11-13 20:25:53,563 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:25:53,571 p=10868 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **************************************************************************
2025-11-13 20:25:58,568 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:25:58,575 p=10868 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] **********************************************************************
2025-11-13 20:26:03,152 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:26:03,160 p=10868 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ********************************************************************
2025-11-13 20:26:05,861 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:26:05,870 p=10868 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ************************************************************************
2025-11-13 20:26:10,660 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:26:10,668 p=10868 u=zubeq n=ansible | TASK [app : Create alerts directory] **************************************************************************
2025-11-13 20:26:13,065 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:26:13,074 p=10868 u=zubeq n=ansible | TASK [app : Template alert rules] *****************************************************************************
2025-11-13 20:26:17,610 p=10868 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:26:17,618 p=10868 u=zubeq n=ansible | TASK [app : Create loki directory] ****************************************************************************
2025-11-13 20:26:19,453 p=10868 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:26:19,461 p=10868 u=zubeq n=ansible | TASK [app : Template loki config] *****************************************************************************
2025-11-13 20:26:27,395 p=10868 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:26:27,403 p=10868 u=zubeq n=ansible | TASK [app : Create promtail directory] ************************************************************************
2025-11-13 20:26:29,831 p=10868 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:26:29,839 p=10868 u=zubeq n=ansible | TASK [app : Template promtail config] *************************************************************************
2025-11-13 20:26:38,047 p=10868 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:26:38,055 p=10868 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] ***********************************************************************
2025-11-13 20:26:42,370 p=10868 u=zubeq n=ansible | fatal: [18.185.108.245]: FAILED! => changed=true 
  cmd:
  - docker-compose
  - up
  - -d
  delta: '0:00:01.340005'
  end: '2025-11-13 18:26:42.094100'
  msg: non-zero return code
  rc: 1
  start: '2025-11-13 18:26:40.754095'
  stderr: |2-
     Container cadvisor_exporter  Running
     Container alertmanager  Running
     Container loki  Created
     Container promtail  Created
     Container prometheus  Running
     Container grafana  Running
     Container node_exporter  Running
     Container postgres_db  Running
     Container postgres_exporter  Running
     Container web_app  Running
     Container loki  Starting
    Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: error mounting "/home/ec2-user/app/loki/loki-config.yml" to rootfs at "/etc/loki/loki-config.yml": create mountpoint for /etc/loki/loki-config.yml mount: cannot create subdirectories in "/var/lib/docker/overlay2/997bd13d2de5f94758d0dea5b88626954920941e470e9cf3258e5ee2f194202b/merged/etc/loki/loki-config.yml": not a directory: unknown: Are you trying to mount a directory onto a file (or vice-versa)? Check if the specified host path exists and is the expected type
  stderr_lines: <omitted>
  stdout: ''
  stdout_lines: <omitted>
2025-11-13 20:26:42,371 p=10868 u=zubeq n=ansible | PLAY RECAP ****************************************************************************************************
2025-11-13 20:26:42,372 p=10868 u=zubeq n=ansible | 18.185.108.245             : ok=17   changed=4    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0   
2025-11-13 20:28:50,417 p=11109 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] **********************************************
2025-11-13 20:28:50,424 p=11109 u=zubeq n=ansible | TASK [Gathering Facts] ****************************************************************************************
2025-11-13 20:28:55,154 p=11109 u=zubeq n=ansible | [WARNING]: Platform linux on host 18.185.108.245 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the meaning of that
path. See https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more
information.

2025-11-13 20:28:55,154 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:28:55,169 p=11109 u=zubeq n=ansible | TASK [docker : Install Docker engine] *************************************************************************
2025-11-13 20:28:58,893 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:28:58,899 p=11109 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***************************************************************
2025-11-13 20:29:01,833 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:29:01,840 p=11109 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ****************************************************
2025-11-13 20:29:04,244 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:29:04,253 p=11109 u=zubeq n=ansible | TASK [app : Create application directory] *********************************************************************
2025-11-13 20:29:05,967 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:29:05,975 p=11109 u=zubeq n=ansible | TASK [app : Copy Flask app files] *****************************************************************************
2025-11-13 20:29:16,742 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:16,747 p=11109 u=zubeq n=ansible | TASK [app : Copy Dockerfile] **********************************************************************************
2025-11-13 20:29:22,204 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:29:22,210 p=11109 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **************************************************************************
2025-11-13 20:29:26,120 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:26,127 p=11109 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] **********************************************************************
2025-11-13 20:29:30,074 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:30,081 p=11109 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ********************************************************************
2025-11-13 20:29:32,098 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:32,106 p=11109 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ************************************************************************
2025-11-13 20:29:36,200 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:36,213 p=11109 u=zubeq n=ansible | TASK [app : Create alerts directory] **************************************************************************
2025-11-13 20:29:38,479 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:38,486 p=11109 u=zubeq n=ansible | TASK [app : Template alert rules] *****************************************************************************
2025-11-13 20:29:42,904 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:42,911 p=11109 u=zubeq n=ansible | TASK [app : Create loki directory] ****************************************************************************
2025-11-13 20:29:44,579 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:44,587 p=11109 u=zubeq n=ansible | TASK [app : Template loki config] *****************************************************************************
2025-11-13 20:29:48,000 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:48,007 p=11109 u=zubeq n=ansible | TASK [app : Create promtail directory] ************************************************************************
2025-11-13 20:29:49,837 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:49,846 p=11109 u=zubeq n=ansible | TASK [app : Template promtail config] *************************************************************************
2025-11-13 20:29:56,431 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:29:56,437 p=11109 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] ***********************************************************************
2025-11-13 20:30:03,685 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:30:03,693 p=11109 u=zubeq n=ansible | TASK [app : Show docker-compose output] ***********************************************************************
2025-11-13 20:30:03,704 p=11109 u=zubeq n=ansible | skipping: [18.185.108.245]
2025-11-13 20:30:03,710 p=11109 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] ****************************************************************
2025-11-13 20:30:03,719 p=11109 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-13 20:30:03,719 p=11109 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 20:30:03,720 p=11109 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-13 20:30:13,726 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:30:13,734 p=11109 u=zubeq n=ansible | TASK [app : Check running containers] *************************************************************************
2025-11-13 20:30:16,413 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:30:16,421 p=11109 u=zubeq n=ansible | TASK [app : Show container status] ****************************************************************************
2025-11-13 20:30:16,434 p=11109 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - NAMES               STATUS                             PORTS
  - grafana             Up 12 minutes (healthy)            0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - postgres_exporter   Up 12 minutes (healthy)            0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - web_app             Up 12 minutes (healthy)            0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - 'promtail            Restarting (1) 2 seconds ago       '
  - node_exporter       Up 12 minutes (healthy)            0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - 'loki                Up 16 seconds (health: starting)   0.0.0.0:3100->3100/tcp, :::3100->3100/tcp'
  - postgres_db         Up 12 minutes (healthy)            0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - prometheus          Up 12 minutes (healthy)            0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - alertmanager        Up 12 minutes (healthy)            0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - cadvisor_exporter   Up 12 minutes (healthy)            0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-13 20:30:16,440 p=11109 u=zubeq n=ansible | TASK [app : Check Flask application health] *******************************************************************
2025-11-13 20:30:19,022 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:30:19,032 p=11109 u=zubeq n=ansible | TASK [app : Show Flask health check result] *******************************************************************
2025-11-13 20:30:19,045 p=11109 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg: Flask application is UP ✅
2025-11-13 20:30:19,056 p=11109 u=zubeq n=ansible | TASK [loki : Show Loki info] **********************************************************************************
2025-11-13 20:30:19,070 p=11109 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - ✅ Loki logging stack configured
  - Loki will store logs for 7 days
  - Access Loki via Grafana Explore
2025-11-13 20:30:19,079 p=11109 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] ***************************************************
2025-11-13 20:30:23,225 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:30:23,233 p=11109 u=zubeq n=ansible | TASK [backup : Create backup directory] ***********************************************************************
2025-11-13 20:30:25,177 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:30:25,187 p=11109 u=zubeq n=ansible | TASK [backup : Template backup script] ************************************************************************
2025-11-13 20:30:28,407 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:30:28,414 p=11109 u=zubeq n=ansible | TASK [backup : Template restore script] ***********************************************************************
2025-11-13 20:30:32,270 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:30:32,278 p=11109 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *******************************************************************
2025-11-13 20:30:34,362 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:30:34,370 p=11109 u=zubeq n=ansible | TASK [backup : Create initial test backup] ********************************************************************
2025-11-13 20:30:36,186 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:30:36,193 p=11109 u=zubeq n=ansible | TASK [backup : Show backup result] ****************************************************************************
2025-11-13 20:30:36,227 p=11109 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - '[2025-11-13 18:30:35] ========================================='
  - '[2025-11-13 18:30:35] Starting PostgreSQL backup'
  - '[2025-11-13 18:30:35] ========================================='
  - '[2025-11-13 18:30:36] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-13 20:30:36,233 p=11109 u=zubeq n=ansible | TASK [backup : List created backups] **************************************************************************
2025-11-13 20:30:37,969 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:30:37,978 p=11109 u=zubeq n=ansible | TASK [backup : Show backup files info] ************************************************************************
2025-11-13 20:30:38,010 p=11109 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 16:50'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-13 20:30:38,027 p=11109 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] **********************************************************
2025-11-13 20:30:42,514 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:30:42,520 p=11109 u=zubeq n=ansible | RUNNING HANDLER [app : Restart compose stack] *****************************************************************
2025-11-13 20:30:58,612 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:30:58,619 p=11109 u=zubeq n=ansible | TASK [Wait for services to start] *****************************************************************************
2025-11-13 20:30:58,629 p=11109 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-13 20:30:58,629 p=11109 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 20:30:58,629 p=11109 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-13 20:31:28,637 p=11109 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:31:28,644 p=11109 u=zubeq n=ansible | TASK [Check running containers] *******************************************************************************
2025-11-13 20:31:31,470 p=11109 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:31:31,477 p=11109 u=zubeq n=ansible | TASK [Show container status] **********************************************************************************
2025-11-13 20:31:31,491 p=11109 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - NAMES               STATUS                          PORTS
  - web_app             Up 32 seconds (healthy)         0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - grafana             Up 13 minutes (healthy)         0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - postgres_exporter   Up 13 minutes (healthy)         0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - 'promtail            Restarting (1) 16 seconds ago   '
  - node_exporter       Up 13 minutes (healthy)         0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - loki                Up About a minute (healthy)     0.0.0.0:3100->3100/tcp, :::3100->3100/tcp
  - postgres_db         Up 13 minutes (healthy)         0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - prometheus          Up 49 seconds (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - alertmanager        Up 13 minutes (healthy)         0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - cadvisor_exporter   Up 13 minutes (healthy)         0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
2025-11-13 20:31:31,496 p=11109 u=zubeq n=ansible | TASK [Show service URLs] **************************************************************************************
2025-11-13 20:31:31,513 p=11109 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - =========================================
  - ✅ Deployment completed successfully!
  - =========================================
  - 'Flask App:      http://18.185.108.245:5000'
  - 'Prometheus:     http://18.185.108.245:9090'
  - 'Grafana:        http://18.185.108.245:3000 (admin/admin)'
  - 'Alertmanager:   http://18.185.108.245:9093'
  - 'Loki:           http://18.185.108.245:3100'
  - =========================================
  - "\U0001F4CA Grafana Dashboards to import:"
  - '  - 11098 (Prometheus Alertmanager)'
  - '  - 13639 (Loki Dashboard)'
  - '  - 1860  (Node Exporter Full)'
  - '  - 14282 (CAdvisor Exporter)'
  - '  - 12485 PostgreSQL exporter'
  - =========================================
2025-11-13 20:31:31,525 p=11109 u=zubeq n=ansible | PLAY RECAP ****************************************************************************************************
2025-11-13 20:31:31,525 p=11109 u=zubeq n=ansible | 18.185.108.245             : ok=39   changed=16   unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
2025-11-13 20:39:06,167 p=11563 u=zubeq n=ansible | PLAY [Deploy Flask + PostgreSQL + Monitoring + Logging + Backup] **********************************************
2025-11-13 20:39:06,174 p=11563 u=zubeq n=ansible | TASK [Gathering Facts] ****************************************************************************************
2025-11-13 20:39:10,410 p=11563 u=zubeq n=ansible | [WARNING]: Platform linux on host 18.185.108.245 is using the discovered Python interpreter at
/usr/bin/python3.9, but future installation of another Python interpreter could change the meaning of that
path. See https://docs.ansible.com/ansible-core/2.16/reference_appendices/interpreter_discovery.html for more
information.

2025-11-13 20:39:10,410 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:39:10,420 p=11563 u=zubeq n=ansible | TASK [docker : Install Docker engine] *************************************************************************
2025-11-13 20:39:14,148 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:39:14,154 p=11563 u=zubeq n=ansible | TASK [docker : Enable and start Docker service] ***************************************************************
2025-11-13 20:39:16,631 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:39:16,636 p=11563 u=zubeq n=ansible | TASK [docker : Install docker-compose (standalone binary)] ****************************************************
2025-11-13 20:39:19,476 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:39:19,486 p=11563 u=zubeq n=ansible | TASK [app : Create application directory] *********************************************************************
2025-11-13 20:39:21,492 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:39:21,499 p=11563 u=zubeq n=ansible | TASK [app : Copy Flask app files] *****************************************************************************
2025-11-13 20:39:33,806 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:39:33,810 p=11563 u=zubeq n=ansible | TASK [app : Copy Dockerfile] **********************************************************************************
2025-11-13 20:39:38,016 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:39:38,025 p=11563 u=zubeq n=ansible | TASK [app : Template prometheus.yml] **************************************************************************
2025-11-13 20:39:42,317 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:39:42,326 p=11563 u=zubeq n=ansible | TASK [app : Template docker-compose.yml] **********************************************************************
2025-11-13 20:39:46,394 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:39:46,400 p=11563 u=zubeq n=ansible | TASK [app : Create alertmanager directory] ********************************************************************
2025-11-13 20:39:48,403 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:39:48,408 p=11563 u=zubeq n=ansible | TASK [app : Template alertmanager.yml] ************************************************************************
2025-11-13 20:39:52,429 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:39:52,436 p=11563 u=zubeq n=ansible | TASK [app : Create alerts directory] **************************************************************************
2025-11-13 20:39:54,509 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:39:54,515 p=11563 u=zubeq n=ansible | TASK [app : Template alert rules] *****************************************************************************
2025-11-13 20:39:58,481 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:39:58,488 p=11563 u=zubeq n=ansible | TASK [app : Create loki directory] ****************************************************************************
2025-11-13 20:40:00,609 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:40:00,614 p=11563 u=zubeq n=ansible | TASK [app : Template loki config] *****************************************************************************
2025-11-13 20:40:06,104 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:40:06,112 p=11563 u=zubeq n=ansible | TASK [app : Create promtail directory] ************************************************************************
2025-11-13 20:40:08,714 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:40:08,718 p=11563 u=zubeq n=ansible | TASK [app : Template promtail config] *************************************************************************
2025-11-13 20:40:13,039 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:40:13,045 p=11563 u=zubeq n=ansible | TASK [app : Start Docker Compose stack] ***********************************************************************
2025-11-13 20:40:18,647 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:40:18,654 p=11563 u=zubeq n=ansible | TASK [app : Show docker-compose output] ***********************************************************************
2025-11-13 20:40:18,665 p=11563 u=zubeq n=ansible | skipping: [18.185.108.245]
2025-11-13 20:40:18,670 p=11563 u=zubeq n=ansible | TASK [app : Wait for containers to be healthy] ****************************************************************
2025-11-13 20:40:18,679 p=11563 u=zubeq n=ansible | Pausing for 10 seconds
2025-11-13 20:40:18,679 p=11563 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 20:40:18,680 p=11563 u=zubeq n=ansible | [app : Wait for containers to be healthy]
Waiting for containers to start...:
2025-11-13 20:40:28,687 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:40:28,692 p=11563 u=zubeq n=ansible | TASK [app : Check running containers] *************************************************************************
2025-11-13 20:40:32,419 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:40:32,424 p=11563 u=zubeq n=ansible | TASK [app : Show container status] ****************************************************************************
2025-11-13 20:40:32,440 p=11563 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - NAMES               STATUS                                     PORTS
  - 'grafana             Up 13 seconds (health: starting)           0.0.0.0:3000->3000/tcp, :::3000->3000/tcp'
  - 'postgres_exporter   Up 13 seconds (health: starting)           0.0.0.0:9187->9187/tcp, :::9187->9187/tcp'
  - 'web_app             Up 14 seconds (health: starting)           0.0.0.0:5000->5000/tcp, :::5000->5000/tcp'
  - promtail            Up 13 seconds                              0.0.0.0:9080->9080/tcp, :::9080->9080/tcp
  - 'alertmanager        Up 15 seconds (health: starting)           0.0.0.0:9093->9093/tcp, :::9093->9093/tcp'
  - 'prometheus          Up 15 seconds (health: starting)           0.0.0.0:9090->9090/tcp, :::9090->9090/tcp'
  - postgres_db         Up 15 seconds (healthy)                    0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - 'cadvisor_exporter   Up 15 seconds (health: starting)           0.0.0.0:8080->8080/tcp, :::8080->8080/tcp'
  - 'node_exporter       Up 15 seconds (health: starting)           0.0.0.0:9100->9100/tcp, :::9100->9100/tcp'
  - 'loki                Up Less than a second (health: starting)   0.0.0.0:3100->3100/tcp, :::3100->3100/tcp'
2025-11-13 20:40:32,443 p=11563 u=zubeq n=ansible | TASK [app : Check Flask application health] *******************************************************************
2025-11-13 20:40:35,991 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:40:35,996 p=11563 u=zubeq n=ansible | TASK [app : Show Flask health check result] *******************************************************************
2025-11-13 20:40:36,010 p=11563 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg: Flask application is UP ✅
2025-11-13 20:40:36,018 p=11563 u=zubeq n=ansible | TASK [loki : Show Loki info] **********************************************************************************
2025-11-13 20:40:36,031 p=11563 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - ✅ Loki logging stack configured
  - Loki will store logs for 7 days
  - Access Loki via Grafana Explore
2025-11-13 20:40:36,040 p=11563 u=zubeq n=ansible | TASK [backup : Install cronie package on Amazon Linux 2023] ***************************************************
2025-11-13 20:40:39,748 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:40:39,754 p=11563 u=zubeq n=ansible | TASK [backup : Create backup directory] ***********************************************************************
2025-11-13 20:40:42,715 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:40:42,722 p=11563 u=zubeq n=ansible | TASK [backup : Template backup script] ************************************************************************
2025-11-13 20:40:46,487 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:40:46,492 p=11563 u=zubeq n=ansible | TASK [backup : Template restore script] ***********************************************************************
2025-11-13 20:40:50,802 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:40:50,808 p=11563 u=zubeq n=ansible | TASK [backup : Setup daily backup cron job] *******************************************************************
2025-11-13 20:40:53,453 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:40:53,457 p=11563 u=zubeq n=ansible | TASK [backup : Create initial test backup] ********************************************************************
2025-11-13 20:40:55,879 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:40:55,885 p=11563 u=zubeq n=ansible | TASK [backup : Show backup result] ****************************************************************************
2025-11-13 20:40:55,918 p=11563 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - '[2025-11-13 18:40:55] ========================================='
  - '[2025-11-13 18:40:55] Starting PostgreSQL backup'
  - '[2025-11-13 18:40:55] ========================================='
  - '[2025-11-13 18:40:55] ❌ ERROR: PostgreSQL container ''postgres_db'' is not running!'
2025-11-13 20:40:55,922 p=11563 u=zubeq n=ansible | TASK [backup : List created backups] **************************************************************************
2025-11-13 20:40:58,131 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:40:58,136 p=11563 u=zubeq n=ansible | TASK [backup : Show backup files info] ************************************************************************
2025-11-13 20:40:58,168 p=11563 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - ✅ Backup system configured
  - 'Backup directory: /home/ec2-user/backups'
  - 'Schedule: Daily at 16:50'
  - 'Retention: 7 days'
  - Found 0 backup file(s)
  - 'Manual backup: /home/ec2-user/backup-postgres.sh'
  - 'Restore: /home/ec2-user/restore-postgres.sh <backup_file>'
2025-11-13 20:40:58,182 p=11563 u=zubeq n=ansible | RUNNING HANDLER [app : Restart prometheus container] **********************************************************
2025-11-13 20:41:03,691 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:41:03,696 p=11563 u=zubeq n=ansible | RUNNING HANDLER [app : Restart compose stack] *****************************************************************
2025-11-13 20:41:19,416 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:41:19,422 p=11563 u=zubeq n=ansible | TASK [Wait for services to start] *****************************************************************************
2025-11-13 20:41:19,433 p=11563 u=zubeq n=ansible | Pausing for 30 seconds
2025-11-13 20:41:19,433 p=11563 u=zubeq n=ansible | (ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
2025-11-13 20:41:19,433 p=11563 u=zubeq n=ansible | [Wait for services to start]
Waiting for all services to initialize...:
2025-11-13 20:41:49,440 p=11563 u=zubeq n=ansible | ok: [18.185.108.245]
2025-11-13 20:41:49,447 p=11563 u=zubeq n=ansible | TASK [Check running containers] *******************************************************************************
2025-11-13 20:41:51,867 p=11563 u=zubeq n=ansible | changed: [18.185.108.245]
2025-11-13 20:41:51,873 p=11563 u=zubeq n=ansible | TASK [Show container status] **********************************************************************************
2025-11-13 20:41:51,887 p=11563 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - NAMES               STATUS                          PORTS
  - web_app             Up 32 seconds (healthy)         0.0.0.0:5000->5000/tcp, :::5000->5000/tcp
  - grafana             Up About a minute (healthy)     0.0.0.0:3000->3000/tcp, :::3000->3000/tcp
  - postgres_exporter   Up About a minute (healthy)     0.0.0.0:9187->9187/tcp, :::9187->9187/tcp
  - promtail            Up About a minute               0.0.0.0:9080->9080/tcp, :::9080->9080/tcp
  - alertmanager        Up About a minute (healthy)     0.0.0.0:9093->9093/tcp, :::9093->9093/tcp
  - prometheus          Up 48 seconds (healthy)         0.0.0.0:9090->9090/tcp, :::9090->9090/tcp
  - postgres_db         Up About a minute (healthy)     0.0.0.0:5432->5432/tcp, :::5432->5432/tcp
  - cadvisor_exporter   Up About a minute (healthy)     0.0.0.0:8080->8080/tcp, :::8080->8080/tcp
  - node_exporter       Up About a minute (healthy)     0.0.0.0:9100->9100/tcp, :::9100->9100/tcp
  - 'loki                Restarting (1) 28 seconds ago   '
2025-11-13 20:41:51,891 p=11563 u=zubeq n=ansible | TASK [Show service URLs] **************************************************************************************
2025-11-13 20:41:51,907 p=11563 u=zubeq n=ansible | ok: [18.185.108.245] => 
  msg:
  - =========================================
  - ✅ Deployment completed successfully!
  - =========================================
  - 'Flask App:      http://18.185.108.245:5000'
  - 'Prometheus:     http://18.185.108.245:9090'
  - 'Grafana:        http://18.185.108.245:3000 (admin/admin)'
  - 'Alertmanager:   http://18.185.108.245:9093'
  - 'Loki:           http://18.185.108.245:3100'
  - =========================================
  - "\U0001F4CA Grafana Dashboards to import:"
  - '  - 11098 (Prometheus Alertmanager)'
  - '  - 13639 (Loki Dashboard)'
  - '  - 1860  (Node Exporter Full)'
  - '  - 14282 (CAdvisor Exporter)'
  - '  - 12485 PostgreSQL exporter'
  - =========================================
2025-11-13 20:41:51,914 p=11563 u=zubeq n=ansible | PLAY RECAP ****************************************************************************************************
2025-11-13 20:41:51,914 p=11563 u=zubeq n=ansible | 18.185.108.245             : ok=39   changed=16   unreachable=0    failed=0    skipped=1    rescued=0    ignored=0   
